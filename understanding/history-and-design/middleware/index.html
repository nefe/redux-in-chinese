<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.0">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Redux ä¸­æ–‡å®˜ç½‘ Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Redux ä¸­æ–‡å®˜ç½‘ Blog Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-66122997-1","auto"),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="search" type="application/opensearchdescription+xml" title="Redux ä¸­æ–‡å®˜ç½‘" href="/opensearch.xml"><title data-react-helmet="true">Middleware ä¸­é—´ä»¶ | Redux ä¸­æ–‡å®˜ç½‘</title><meta data-react-helmet="true" property="og:url" content="http://cn.redux.js.org/understanding/history-and-design/middleware"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Middleware ä¸­é—´ä»¶ | Redux ä¸­æ–‡å®˜ç½‘"><meta data-react-helmet="true" name="description" content="åŸç†  &gt; Middleware ä¸­é—´ä»¶ï¼šå¦‚ä½•ä½¿ç”¨ä¸­é—´ä»¶æ¥æ‰©å±• Redux store çš„èƒ½åŠ›"><meta data-react-helmet="true" property="og:description" content="åŸç†  &gt; Middleware ä¸­é—´ä»¶ï¼šå¦‚ä½•ä½¿ç”¨ä¸­é—´ä»¶æ¥æ‰©å±• Redux store çš„èƒ½åŠ›"><meta data-react-helmet="true" property="og:image" content="http://cn.redux.js.org/img/redux-logo-landscape.png"><meta data-react-helmet="true" name="twitter:image" content="http://cn.redux.js.org/img/redux-logo-landscape.png"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon/favicon.ico"><link data-react-helmet="true" rel="canonical" href="http://cn.redux.js.org/understanding/history-and-design/middleware"><link data-react-helmet="true" rel="alternate" href="http://cn.redux.js.org/understanding/history-and-design/middleware" hreflang="en"><link data-react-helmet="true" rel="alternate" href="http://cn.redux.js.org/understanding/history-and-design/middleware" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.01e0d58b.css">
<link rel="preload" href="/assets/js/runtime~main.3485d6c8.js" as="script">
<link rel="preload" href="/assets/js/main.3f741185.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/redux.svg" alt="Redux Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/redux.svg" alt="Redux Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Redux ä¸­æ–‡å®˜ç½‘</strong></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/introduction/getting-started">å…¥é—¨</a><a class="navbar__item navbar__link" href="/tutorials/essentials/part-1-overview-concepts">æ•™ç¨‹</a><a class="navbar__item navbar__link" href="/api/api-reference">API</a><a class="navbar__item navbar__link" href="/faq">å¸¸è§é—®é¢˜</a><a class="navbar__item navbar__link" href="/style-guide/style-guide">æœ€ä½³å®è·µ</a><a href="https://www.github.com/camsong/redux-in-chinese" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">æºç </a><a href="https://github.com/camsong/redux-in-chinese/issues" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">çº é”™</a><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--disabled" role="button" tabindex="-1"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT">ğŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ğŸŒ</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/redux.svg" alt="Redux Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/redux.svg" alt="Redux Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Redux ä¸­æ–‡å®˜ç½‘</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/introduction/getting-started">å…¥é—¨</a></li><li class="menu__list-item"><a class="menu__link" href="/tutorials/essentials/part-1-overview-concepts">æ•™ç¨‹</a></li><li class="menu__list-item"><a class="menu__link" href="/api/api-reference">API</a></li><li class="menu__list-item"><a class="menu__link" href="/faq">å¸¸è§é—®é¢˜</a></li><li class="menu__list-item"><a class="menu__link" href="/style-guide/style-guide">æœ€ä½³å®è·µ</a></li><li class="menu__list-item"><a href="https://www.github.com/camsong/redux-in-chinese" target="_blank" rel="noopener noreferrer" class="menu__link">æºç </a></li><li class="menu__list-item"><a href="https://github.com/camsong/redux-in-chinese/issues" target="_blank" rel="noopener noreferrer" class="menu__link">çº é”™</a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><div class="docSidebarContainer_3Kbt" role="complementary"><div class="sidebar_15mo"><div class="menu menu--responsive thin-scrollbar menu_Bmed"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">ç®€ä»‹</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/introduction/getting-started">å…¥é—¨ Redux</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/introduction/installation">å®‰è£…</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/introduction/core-concepts">æ ¸å¿ƒæ¦‚å¿µ</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/introduction/learning-resources">å­¦ä¹ èµ„æº</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/introduction/ecosystem">ç”Ÿæ€</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/introduction/examples">ç¤ºä¾‹</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">æ•™ç¨‹</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/tutorials/index">æ•™ç¨‹ç›®å½•</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Redux å¾ªåºæ¸è¿›</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/tutorials/essentials/part-1-overview-concepts">åŸºç¡€æ¦‚å¿µ</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/tutorials/essentials/part-2-app-structure">åº”ç”¨ç»“æ„</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/tutorials/essentials/part-3-data-flow">æ•°æ®æµåŸºç¡€</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/tutorials/essentials/part-4-using-data">ä½¿ç”¨æ•°æ®</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/tutorials/essentials/part-5-async-logic">å¼‚æ­¥é€»è¾‘ä¸æ•°æ®è¯·æ±‚</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/tutorials/essentials/part-6-performance-normalization">æ€§èƒ½ä¸æ•°æ®èŒƒå¼åŒ–</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Redux æ·±å…¥æµ…å‡º</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/tutorials/fundamentals/part-1-overview">Redux Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/tutorials/fundamentals/part-2-concepts-data-flow">Redux Concepts and Data Flow</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/tutorials/fundamentals/part-3-state-actions-reducers">State, Actions, and Reducers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/tutorials/fundamentals/part-4-store">Store</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/tutorials/fundamentals/part-5-ui-react">UI and React</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/tutorials/fundamentals/part-6-async-logic">Async Logic and Data Fetching</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/tutorials/fundamentals/part-7-standard-patterns">Standard Redux Patterns</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/tutorials/fundamentals/part-8-modern-redux">Modern Redux with Redux Toolkit</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">æŠ€å·§</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/recipe-index">æŠ€å·§</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/configuring-your-store">é…ç½® Store</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/usage-with-typescript">Usage with TypeScript</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/migrating-to-redux">è¿ç§»åˆ° Redux</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/using-object-spread-operator">ä½¿ç”¨å¯¹è±¡å±•å¼€è¿ç®—ç¬¦</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/reducing-boilerplate">å‡å°‘æ ·æ¿ä»£ç </a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/server-rendering">æœåŠ¡ç«¯æ¸²æŸ“</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/writing-tests">ç¼–å†™æµ‹è¯•</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/computing-derived-data">è®¡ç®—è¡ç”Ÿæ•°æ®</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/implementing-undo-history">å®ç°æ’¤é”€é‡åš</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/isolating-redux-sub-apps">å­åº”ç”¨éš”ç¦»</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/code-splitting">ä»£ç åˆ†å‰²</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/troubleshooting">Troubleshooting</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">ç»„ç»‡ Reducers</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/structuring-reducers/structuring-reducers">ç»„ç»‡ Reducer</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/structuring-reducers/prerequisite-concepts">Reducer å¿…å¤‡æ¦‚å¿µ</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/structuring-reducers/basic-reducer-structure">Reducer å’Œ State çš„åŸºæœ¬ç»“æ„</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/structuring-reducers/splitting-reducer-logic">æ‹†åˆ† Reducer é€»è¾‘</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/structuring-reducers/refactoring-reducer-example">é‡æ„ Reducerï¼šåŸºäºå‡½æ•°åˆ†è§£ï¼ˆFunctional Decompositionï¼‰å’Œ Reducer ç»„åˆ</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/structuring-reducers/using-combinereducers">`combineReducers` ç”¨æ³•</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/structuring-reducers/beyond-combinereducers">`combineReducers` è¿›é˜¶</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/structuring-reducers/normalizing-state-shape">State èŒƒå¼åŒ–</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/structuring-reducers/updating-normalized-data">ç®¡ç†èŒƒå¼åŒ–æ•°æ®</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/structuring-reducers/reusing-reducer-logic">Reducer é€»è¾‘å¤ç”¨</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/structuring-reducers/immutable-update-patterns">Immutable ä¸å¯å˜æ›´æ–°æ¨¡å¼</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/structuring-reducers/initializing-state">åˆå§‹åŒ– State</a></li></ul></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">æ·±å…¥ç†è§£ Redux</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">åƒ Redux ä¸€æ ·æ€è€ƒ</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/understanding/thinking-in-redux/motivation">åŠ¨æœº</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/understanding/thinking-in-redux/three-principles">ä¸‰å¤§åŸåˆ™</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/understanding/thinking-in-redux/glossary">è¯æ±‡è¡¨</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">å†å²ä¸è®¾è®¡åŸåˆ™</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/understanding/history-and-design/prior-art">å…ˆå‰æŠ€æœ¯</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/understanding/history-and-design/middleware">Middleware ä¸­é—´ä»¶</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">å¸¸è§é—®é¢˜</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/faq">Redux FAQ</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/faq/general">Redux FAQ: General</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/faq/reducers">Redux FAQ: Reducers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/faq/organizing-state">Redux FAQ: Organizing State</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/faq/store-setup">Redux FAQ: Store Setup</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/faq/actions">Redux FAQ: Actions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/faq/immutable-data">Redux FAQ: Immutable Data</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/faq/code-structure">Redux FAQ: Code Structure</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/faq/performance">Redux FAQ: Performance</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/faq/design-decisions">Redux FAQ: Design Decisions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/faq/react-redux">Redux FAQ: React Redux</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/faq/miscellaneous">Redux FAQ: Miscellaneous</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">ç¼–ç è§„èŒƒ</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/style-guide/style-guide">Style Guide: Best Practices</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">API æ–‡æ¡£</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/api/api-reference">API Reference</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/api/createstore">createStore</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/api/store">Store</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/api/combinereducers">combineReducers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/api/applymiddleware">applyMiddleware</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/api/bindactioncreators">bindActionCreators</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/api/compose">compose</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Redux Toolkit</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/redux-toolkit/overview">Redux Toolkit: æ¦‚è§ˆ</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3ufF"><div class="container padding-vert--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><header><h1 class="docTitle_3a4h">Middleware ä¸­é—´ä»¶</h1></header><div class="markdown"><p>åœ¨ <a href="/tutorials/fundamentals/part-4-store#middleware">&quot;Redux æ·±å…¥æµ…å‡º&quot; æ•™ç¨‹ä¸­</a> ä½ å·²ç»å­¦ä¹ è¿‡ä¸­é—´ä»¶çš„å®è·µæ¡ˆä¾‹ã€‚å¦‚æœä½ ä½¿ç”¨è¿‡æœåŠ¡ç«¯æ¡†æ¶åƒ <a href="https://expressjs.com/" target="_blank" rel="noopener noreferrer">Express</a> æˆ– <a href="https://koajs.com/" target="_blank" rel="noopener noreferrer">Koa</a>ï¼Œä½ æˆ–è®¸å·²ç»ç†Ÿæ‚‰ <em>middleware</em> çš„æ¦‚å¿µã€‚åœ¨è¿™äº›æ¡†æ¶ä¸­ï¼Œä¸­é—´ä»¶å¯ä»¥è®©ä½ åœ¨æ¥æ”¶è¯·æ±‚å’Œç”Ÿæˆå“åº”ä¹‹é—´æ”¾ç½®çš„ä¸€äº›ä»£ç ã€‚ä¾‹å¦‚ï¼ŒExpress æˆ– Koa ä¸­é—´ä»¶å¯èƒ½ä¼šæ·»åŠ  CORS æ ‡å¤´ã€è®°å½•æ—¥å¿—ã€å‹ç¼©ç­‰ã€‚ä¸­é—´ä»¶çš„æœ€å¤§ç‰¹ç‚¹æ˜¯å®ƒå¯ä»¥ç»„åˆæˆä¸€ä¸ªé“¾ã€‚æ‚¨å¯ä»¥åœ¨ä¸€ä¸ªé¡¹ç›®ä¸­ä½¿ç”¨å¤šä¸ªä¸åŒçš„ä¸­é—´ä»¶ã€‚</p><p>Redux ä¸­é—´ä»¶è§£å†³çš„é—®é¢˜ä¸ Express æˆ– Koa ä¸­é—´ä»¶ä¸åŒï¼Œä½†åœ¨æ¦‚å¿µä¸Šæ˜¯ç›¸ä¼¼çš„ã€‚<strong>å®ƒåœ¨ dispatch action å’Œåˆ°è¾¾ reducer çš„é‚£ä¸€åˆ»ä¹‹é—´æä¾›äº†é€»è¾‘æ’å…¥ç‚¹</strong>ã€‚å¯ä»¥ä½¿ç”¨ Redux ä¸­é—´ä»¶è¿›è¡Œæ—¥å¿—è®°å½•ã€å¼‚å¸¸ç›‘æ§ã€ä¸å¼‚æ­¥ API å¯¹è¯ã€è·¯ç”±ç­‰ã€‚</p><p>æœ¬æ–‡åˆ†æˆå‡ éƒ¨åˆ†æ¥è®©ä½ æ·±å…¥äº†è§£å®ƒçš„æ¦‚å¿µï¼Œä»¥åŠ<a href="#seven-examples">å‡ ä¸ªå®é™…ä¾‹å­</a>åœ¨æœ€åå±•ç¤ºä¸­é—´ä»¶çš„å¨åŠ›ã€‚è¿™äº›ä¾‹å­å¯èƒ½éœ€è¦æ¥å›çœ‹ï¼Œè¿™æ ·ä½ ä¼šåœ¨æ— èŠå’Œçµæ„Ÿé—´åˆ‡æ¢ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="ç†è§£-middleware"></a>ç†è§£ Middleware<a class="hash-link" href="#ç†è§£-middleware" title="Direct link to heading">#</a></h2><p>è™½ç„¶ä¸­é—´ä»¶å¯ç”¨äºå¤šç§ç”¨é€”ï¼ŒåŒ…æ‹¬å¼‚æ­¥ API è°ƒç”¨ï¼Œä½†äº†è§£å®ƒçš„æ¥æºçš„åŸå› éå¸¸é‡è¦ã€‚æˆ‘ä»¬å°†é€šè¿‡â€œæ—¥å¿—è®°å½•â€å’Œâ€œå¼‚å¸¸ç›‘æ§â€ä½œä¸ºç¤ºä¾‹ï¼Œæ¥ä¸€æ­¥æ­¥å¼•å¯¼ä½ çŸ¥é“ä¸­é—´ä»¶äº§ç”ŸèƒŒåçš„è¿‡ç¨‹ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="é—®é¢˜ï¼šæ—¥å¿—"></a>é—®é¢˜ï¼šæ—¥å¿—<a class="hash-link" href="#é—®é¢˜ï¼šæ—¥å¿—" title="Direct link to heading">#</a></h3><p>Redux çš„å¥½å¤„ä¹‹ä¸€æ˜¯å®ƒä½¿çŠ¶æ€çš„å˜æ›´å˜å¾—å¯é¢„æµ‹ä¸”é€æ˜ã€‚æ¯æ¬¡ dispatch action æ—¶ï¼Œéƒ½ä¼šè®¡ç®—å¹¶ä¿å­˜æ–°çŠ¶æ€ã€‚çŠ¶æ€ä¸èƒ½è‡ªè¡Œæ”¹å˜ï¼Œå®ƒåªèƒ½ä½œä¸ºç‰¹å®š action çš„ç»“æœè€Œæ”¹å˜ã€‚</p><p>å¦‚æœæˆ‘ä»¬è®°å½•åº”ç”¨ç¨‹åºä¸­å‘ç”Ÿçš„æ¯ä¸ª action è°ƒç”¨å‰åçš„çŠ¶æ€ï¼Œä¸æ˜¯å¾ˆå¥½å—ï¼Ÿå½“å‡ºç°é—®é¢˜æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å›æº¯æ—¥å¿—ï¼Œå¹¶æ‰¾å‡ºå“ªä¸ª action å¯¼è‡´äº†é—®é¢˜ã€‚</p><img src="https://i.imgur.com/BjGBlES.png" width="70%"><p>æˆ‘ä»¬å¦‚ä½•ç”¨ Redux è§£å†³è¿™ä¸ªé—®é¢˜ï¼Ÿ</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="å°è¯•-1ï¼šæ‰‹åŠ¨æ‰“æ—¥å¿—"></a>å°è¯• #1ï¼šæ‰‹åŠ¨æ‰“æ—¥å¿—<a class="hash-link" href="#å°è¯•-1ï¼šæ‰‹åŠ¨æ‰“æ—¥å¿—" title="Direct link to heading">#</a></h3><p>æœ€ç®€å•çš„è§£å†³æ–¹æ¡ˆæ˜¯æ¯æ¬¡è°ƒç”¨ <a href="/api/store#dispatchaction"><code>store.dispatch(action)</code></a> æ—¶æ‰‹åŠ¨è®°å½• action å’Œä¸‹ä¸€ä¸ªçŠ¶æ€ã€‚è¿™å¹¶ä¸æ˜¯çœŸæ­£çš„è§£å†³æ–¹æ¡ˆï¼Œè€Œåªæ˜¯äº†è§£é—®é¢˜çš„ç¬¬ä¸€æ­¥ã€‚</p><blockquote><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="æ³¨æ„"></a>æ³¨æ„<a class="hash-link" href="#æ³¨æ„" title="Direct link to heading">#</a></h5><p>ä½¿ç”¨ <a href="https://github.com/reduxjs/react-redux" target="_blank" rel="noopener noreferrer">react-redux</a> æˆ–ç±»ä¼¼çš„ç»‘å®šï¼Œå¯èƒ½æ— æ³•ç›´æ¥è®¿é—®ç»„ä»¶ä¸­çš„ store å®ä¾‹ã€‚åœ¨æ¥ä¸‹æ¥çš„å‡ æ®µä¸­ï¼Œå‡è®¾æ‚¨æ˜ç¡®åœ°ä¼ é€’äº† storeã€‚</p></blockquote><p>æ¯”å¦‚è¯´ï¼Œè¿™æ ·æ¥åˆ›å»º todoï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token plain">store</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">dispatch</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token function" style="color:#E6D874">addTodo</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;Use Redux&#x27;</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>è¦è®°å½• action å’ŒçŠ¶æ€ï¼Œæ‚¨å¯ä»¥å°†ä»£ç æ”¹æˆè¿™æ ·ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> action </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">addTodo</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;Use Redux&#x27;</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token console class-name">console</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">log</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;dispatching&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">store</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">dispatch</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token console class-name">console</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">log</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;next state&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> store</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">getState</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>è¿™ä¼šäº§ç”Ÿæ‰€éœ€çš„æ•ˆæœï¼Œä½†æ‚¨ä¸æƒ³æ¯æ¬¡éƒ½è¿™æ ·åšã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="å°è¯•-2-åŒ…è£¹-dispatch"></a>å°è¯• #2: åŒ…è£¹ dispatch<a class="hash-link" href="#å°è¯•-2-åŒ…è£¹-dispatch" title="Direct link to heading">#</a></h3><p>æ‚¨å¯ä»¥å†™ä¸ªå‡½æ•°æ¥è®°å½•æ—¥å¿—ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#F92672">function</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">dispatchAndLog</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">store</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">log</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;dispatching&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  store</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">dispatch</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">log</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;next state&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> store</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">getState</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>ç„¶åä½ å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹ä½¿ç”¨å®ƒè€Œä¸æ˜¯<code>store.dispatch()</code>ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token function" style="color:#E6D874">dispatchAndLog</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">store</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">addTodo</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;Use Redux&#x27;</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>æˆ‘ä»¬å¯ä»¥åˆ°æ­¤ç»“æŸï¼Œä½†æ˜¯æ¯æ¬¡éƒ½å¯¼å…¥ä¸€ä¸ªç‰¹æ®Šå‡½æ•°ä¸æ˜¯å¾ˆæ–¹ä¾¿ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="å°è¯•-3-ç»™-dispatch-åšçŒ´å­è¡¥ä¸ï¼ˆmonkeypatchï¼‰"></a>å°è¯• #3: ç»™ dispatch åšçŒ´å­è¡¥ä¸ï¼ˆMonkeypatchï¼‰<a class="hash-link" href="#å°è¯•-3-ç»™-dispatch-åšçŒ´å­è¡¥ä¸ï¼ˆmonkeypatchï¼‰" title="Direct link to heading">#</a></h3><p>å¦‚æœæˆ‘ä»¬ç›´æ¥é‡å†™ store å®ä¾‹ä¸Šçš„ <code>dispatch</code> å‡½æ•°æ€ä¹ˆæ ·ï¼Ÿstore æœ¬èº«æ˜¯å¸¦æœ‰ <a href="/api/store">ä¸€äº›æ–¹æ³•</a> çš„æ™®é€šå¯¹è±¡ï¼Œå› ä¸ºæ˜¯ JavaScriptï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥å¯¹ <code>dispatch</code> å‡½æ•°è¿›è¡ŒçŒ´å­è¡¥ä¸ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> next </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> store</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">dispatch</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">store</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method-variable function-variable method function property-access" style="color:#E6D874">dispatch</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">function</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">dispatchAndLog</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">log</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;dispatching&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">let</span><span class="token plain"> result </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">next</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">log</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;next state&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> store</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">getState</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#F92672">return</span><span class="token plain"> result</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>è¿™å·²ç»éå¸¸æ¥è¿‘æˆ‘ä»¬æƒ³è¦çš„äº†ï¼æ— è®ºæˆ‘ä»¬åœ¨ä½•å¤„ dispatch actionï¼Œå®ƒéƒ½ä¿è¯è¢«è®°å½•ã€‚Monkeypatching ä»æ¥éƒ½ä¸æ˜¯æ­£ç¡®çš„ï¼Œä½†æˆ‘ä»¬ç°åœ¨å¯ä»¥å¿å—å®ƒã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="é—®é¢˜-å¼‚å¸¸ç›‘æ§"></a>é—®é¢˜: å¼‚å¸¸ç›‘æ§<a class="hash-link" href="#é—®é¢˜-å¼‚å¸¸ç›‘æ§" title="Direct link to heading">#</a></h3><p>å¦‚æœéœ€è¦å¯¹ <code>dispatch</code> åš<strong>å¤šä¸ª</strong>è¿™æ ·çš„è½¬æ¢æ€ä¹ˆåŠï¼Ÿ</p><p>æˆ‘æƒ³åˆ°çš„å¦ä¸€ä¸ªæœ‰ç”¨çš„è½¬æ¢åœºæ™¯æ˜¯è®°å½•ç”Ÿäº§ç¯å¢ƒä¸­çš„ JavaScript é”™è¯¯ã€‚å…¨å±€ <code>window.onerror</code> äº‹ä»¶ä¸å¯é ï¼Œå› ä¸ºå®ƒåœ¨ä¸€äº›æ—§æµè§ˆå™¨ä¸­ä¸æä¾›å †æ ˆä¿¡æ¯ï¼Œè¿™å¯¹äºç†è§£é”™è¯¯å‘ç”Ÿçš„åŸå› è‡³å…³é‡è¦ã€‚</p><p>æƒ³ä¸€ä¸‹è¿™æ ·ä¼šæ›´å¥½ï¼Œæ¯å½“ dispatch action æŠ›å‡ºé”™è¯¯æ—¶ï¼Œæˆ‘ä»¬éƒ½å°†é”™è¯¯å‘é€ç»™å¼‚å¸¸ç›‘æ§æœåŠ¡å™¨ï¼Œä¾‹å¦‚ <a href="https://getsentry.com/welcome/" target="_blank" rel="noopener noreferrer">Sentry</a> å’Œå †æ ˆï¼Œè¿™ä¸æ˜¯å¾ˆæœ‰ç”¨å—ï¼Ÿè®°å½•å¯¼è‡´é”™è¯¯çš„ action ä»¥åŠå½“å‰çŠ¶æ€ï¼Ÿè¿™æ ·ï¼Œåœ¨å¼€å‘ç¯å¢ƒä¸­é‡ç°é”™è¯¯è¦å®¹æ˜“å¾—å¤šã€‚</p><p>ä½†æ˜¯ï¼Œå°†æ—¥å¿—è®°å½•å’Œå¼‚å¸¸ç›‘æ§åˆ†å¼€æ˜¯å¾ˆé‡è¦çš„ã€‚ç†æƒ³æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›å®ƒä»¬å±äºä¸åŒçš„æ¨¡å—ï¼Œå¯èƒ½åœ¨ä¸åŒçš„åŒ…ä¸­ã€‚å¦åˆ™ï¼Œæˆ‘ä»¬å°±æ— æ³•åœ¨ä¸åŒçš„åº”ç”¨ä¸­å¤ç”¨ã€‚ï¼ˆæç¤ºï¼šæˆ‘ä»¬æ­£åœ¨æ…¢æ…¢äº†è§£ä»€ä¹ˆæ˜¯ä¸­é—´ä»¶ï¼ï¼‰</p><p>å¦‚æœæ—¥å¿—è®°å½•å’Œå¼‚å¸¸ç›‘æ§æ˜¯åˆ†å¼€çš„å·¥å…·å‡½æ•°ï¼Œå®ƒä»¬å¯èƒ½é•¿è¿™æ ·ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#F92672">function</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">patchStoreToAddLogging</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">store</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> next </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> store</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">dispatch</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  store</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method-variable function-variable method function property-access" style="color:#E6D874">dispatch</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">function</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">dispatchAndLog</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">log</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;dispatching&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword" style="color:#F92672">let</span><span class="token plain"> result </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">next</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">log</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;next state&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> store</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">getState</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#F92672">return</span><span class="token plain"> result</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">function</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">patchStoreToAddCrashReporting</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">store</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> next </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> store</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">dispatch</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  store</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method-variable function-variable method function property-access" style="color:#E6D874">dispatch</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">function</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">dispatchAndReportErrors</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#F92672">try</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#F92672">return</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">next</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#F92672">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">error</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;Caught an exception!&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> err</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token maybe-class-name">Raven</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">captureException</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        extra</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">          action</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">          state</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> store</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">getState</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#F92672">throw</span><span class="token plain"> err</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>å¦‚æœè¿™äº›å‡½æ•°ä½œä¸ºå•ç‹¬çš„æ¨¡å—å‘å¸ƒï¼Œæˆ‘ä»¬ç¨åå¯ä»¥ä½¿ç”¨å®ƒä»¬æ¥è£…é¥°æˆ‘ä»¬çš„ storeï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token function" style="color:#E6D874">patchStoreToAddLogging</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">store</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token function" style="color:#E6D874">patchStoreToAddCrashReporting</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">store</span><span class="token punctuation" style="color:#F8F8F2">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>å°½ç®¡å¦‚æ­¤ï¼Œè¿™å¹¶ä¸å¥½ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="å°è¯•-4-éšè—çŒ´å­è¡¥ä¸"></a>å°è¯• #4: éšè—çŒ´å­è¡¥ä¸<a class="hash-link" href="#å°è¯•-4-éšè—çŒ´å­è¡¥ä¸" title="Direct link to heading">#</a></h3><p>æ‰“çŒ´å­è¡¥ä¸æ˜¯ä¸€ç§ Hackï¼ˆä¸æ¨èï¼‰çš„æ–¹å¼ã€‚â€œæ›¿æ¢ä»»ä½•ä½ å–œæ¬¢çš„æ–¹æ³•â€ï¼Œé‚£æ˜¯ä¸€ç§ä»€ä¹ˆæ ·çš„APIï¼Ÿè®©æˆ‘ä»¬æ‰¾å‡ºå®ƒçš„æœ¬è´¨ã€‚ä»¥å‰ï¼Œæˆ‘ä»¬çš„å‡½æ•°æ›¿æ¢äº†<code>store.dispatch</code>ã€‚å¦‚æœä»–ä»¬ <em>è¿”å›</em> æ–°çš„ <code>dispatch</code> å‡½æ•°æ€ä¹ˆæ ·ï¼Ÿ</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#F92672">function</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">logger</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">store</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> next </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> store</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">dispatch</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token comment" style="color:#c6cad2">// Previously:</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token comment" style="color:#c6cad2">// store.dispatch = function dispatchAndLog(action) {</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#F92672">return</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">function</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">dispatchAndLog</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">log</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;dispatching&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword" style="color:#F92672">let</span><span class="token plain"> result </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">next</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">log</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;next state&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> store</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">getState</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#F92672">return</span><span class="token plain"> result</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>æˆ‘ä»¬å¯ä»¥åœ¨ Redux ä¸­æä¾›ä¸€ä¸ª helper æ¥å¸®åŠ©æˆ‘ä»¬åšçŒ´å­è¡¥ä¸ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#F92672">function</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">applyMiddlewareByMonkeypatching</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">store</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> middlewares</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  middlewares </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> middlewares</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">slice</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  middlewares</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">reverse</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token comment" style="color:#c6cad2">// ä¾æ¬¡è°ƒç”¨æ¯ä¸ª middleware æ¥å¢å¼º dispatch</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  middlewares</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">forEach</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">middleware</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">store</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">dispatch</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">middleware</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">store</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å®ƒæ¥è°ƒç”¨å¤šä¸ªä¸­é—´ä»¶ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token function" style="color:#E6D874">applyMiddlewareByMonkeypatching</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">store</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">[</span><span class="token plain">logger</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> crashReporter</span><span class="token punctuation" style="color:#F8F8F2">]</span><span class="token punctuation" style="color:#F8F8F2">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>ç„¶è€Œï¼Œå®ƒä»ç„¶æ˜¯çŒ´å­è¡¥ä¸ã€‚
æˆ‘ä»¬å°†å®ƒéšè—åœ¨åº“ä¸­çš„äº‹å®å¹¶æ²¡æœ‰æ”¹å˜è¿™ä¸€äº‹å®ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="å°è¯•-5-ç§»é™¤çŒ´å­è¡¥ä¸"></a>å°è¯• #5: ç§»é™¤çŒ´å­è¡¥ä¸<a class="hash-link" href="#å°è¯•-5-ç§»é™¤çŒ´å­è¡¥ä¸" title="Direct link to heading">#</a></h3><p>ä¸ºä»€ä¹ˆæ¯æ¬¡éƒ½éœ€è¦è¦†ç›– <code>dispatch</code> å‘¢ï¼Ÿå¾ˆç®€å•ï¼Œä¸ºäº†ä»¥åèƒ½å¤Ÿè°ƒç”¨å®ƒï¼Œä½†è¿˜æœ‰å¦å¤–ä¸€ä¸ªåŸå› ï¼šè¿™æ ·æ¯ä¸ªä¸­é—´ä»¶éƒ½å¯ä»¥è®¿é—®ï¼ˆå’Œè°ƒç”¨ï¼‰ä¹‹å‰åŒ…è£¹çš„ <code>store.dispatch</code>ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#F92672">function</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">logger</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">store</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token comment" style="color:#c6cad2">// Must point to the function returned by the previous middleware:</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> next </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> store</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">dispatch</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#F92672">return</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">function</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">dispatchAndLog</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">log</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;dispatching&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword" style="color:#F92672">let</span><span class="token plain"> result </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">next</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">log</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;next state&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> store</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">getState</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#F92672">return</span><span class="token plain"> result</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>å¿…é¡»è¦é“¾å¼è°ƒç”¨ä¸­é—´ä»¶ï¼</p><p>å¦‚æœ <code>applyMiddlewareByMonkeypatching</code> åœ¨å¤„ç†ç¬¬ä¸€ä¸ªä¸­é—´ä»¶åæ²¡æœ‰ç«‹å³è¦†ç›–æ‰åŸæ¥çš„ <code>store.dispatch</code>ï¼Œ<code>store.dispatch</code> å°†ç»§ç»­æŒ‡å‘åŸå§‹çš„ <code>dispatch</code> å‡½æ•°ã€‚é‚£ä¹ˆç¬¬äºŒä¸ªä¸­é—´ä»¶ä¹Ÿä¼šç»‘å®šåˆ°åŸæ¥çš„ <code>dispatch</code> å‡½æ•°ä¸Šã€‚</p><p>ä½†æ˜¯è¿˜æœ‰ä¸€ç§ä¸åŒçš„æ–¹å¼æ¥åšé“¾å¼è°ƒç”¨ã€‚ä¸­é—´ä»¶æ¥æ¥å— <code>next()</code> è°ƒåº¦å‡½æ•°ä½œä¸ºå‚æ•°ï¼Œè€Œä¸æ˜¯ä» <code>store</code> å®ä¾‹ä¸­è¯»å–å®ƒã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#F92672">function</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">logger</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">store</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#F92672">return</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">function</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">wrapDispatchToAddLogging</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">next</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#F92672">return</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">function</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">dispatchAndLog</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">log</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;dispatching&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token keyword" style="color:#F92672">let</span><span class="token plain"> result </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">next</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">log</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;next state&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> store</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">getState</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#F92672">return</span><span class="token plain"> result</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>è¿™æ˜¯ä¸€ä¸ª <a href="https://knowyourmeme.com/memes/we-need-to-go-deeper" target="_blank" rel="noopener noreferrer">â€œæˆ‘ä»¬éœ€è¦æ›´æ·±å…¥â€</a> çš„æ—¶åˆ»ï¼Œæ‰€ä»¥è¿™å¯èƒ½éœ€è¦ä¸€æ®µæ—¶é—´æ¥ç†è§£ã€‚å‡½æ•°çº§è”æ„Ÿè§‰å¾ˆå“äººã€‚ES6 ç®­å¤´å‡½æ•°ä½¿è¿™ä¸ª <a href="https://en.wikipedia.org/wiki/Currying" target="_blank" rel="noopener noreferrer">è½²é‡ŒåŒ–</a> æ›´æ˜“è¯»ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#E6D874">logger</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token parameter">store</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token parameter">next</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token parameter">action</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">log</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;dispatching&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">let</span><span class="token plain"> result </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">next</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">log</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;next state&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> store</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">getState</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#F92672">return</span><span class="token plain"> result</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#E6D874">crashReporter</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token parameter">store</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token parameter">next</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token parameter">action</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#F92672">try</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#F92672">return</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">next</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#F92672">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">error</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;Caught an exception!&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> err</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token maybe-class-name">Raven</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">captureException</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      extra</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        action</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        state</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> store</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">getState</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#F92672">throw</span><span class="token plain"> err</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p><strong>è¿™æ­£æ˜¯ Redux ä¸­é—´ä»¶çš„æ ·å­ã€‚</strong></p><p>ç°åœ¨ä¸­é—´ä»¶æ¥å— <code>next()</code> dispatch å‡½æ•°ï¼Œå¹¶è¿”å›æ–°çš„ dispatch å‡½æ•°ï¼Œè¯¥å‡½æ•°åˆå……å½“å·¦ä¾§ä¸­é—´ä»¶çš„ <code>next()</code>ï¼Œä¾æ­¤ç±»æ¨ã€‚ä»ç„¶å¯ä»¥åœ¨éœ€è¦çš„æ—¶å€™è°ƒç”¨ store æ–¹æ³•ï¼ˆå¦‚ <code>getState()</code>ï¼‰ï¼Œå› æ­¤ <code>store</code> ä½œä¸ºé¡¶çº§å‚æ•°ä¼ å…¥åœ¨è¿™é‡Œä»ç„¶å¯ç”¨ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="å°è¯•-6ï¼šç®€å•ç²—æš´çš„ä¸­é—´ä»¶è°ƒç”¨æ–¹æ³•"></a>å°è¯• #6ï¼šç®€å•ç²—æš´çš„ä¸­é—´ä»¶è°ƒç”¨æ–¹æ³•<a class="hash-link" href="#å°è¯•-6ï¼šç®€å•ç²—æš´çš„ä¸­é—´ä»¶è°ƒç”¨æ–¹æ³•" title="Direct link to heading">#</a></h3><p>ä¸ºäº†æ›¿ä»£ <code>applyMiddlewareByMonkeypatching()</code>ï¼Œæˆ‘ä»¬å¯ä»¥ç¼–å†™ <code>applyMiddleware()</code>ï¼Œå®ƒå…ˆè®¡ç®—å‡ºæœ€ç»ˆçš„ã€è¢«æ‰€æœ‰ middleware åŒ…è£¹åçš„ <code>dispatch()</code> å‡½æ•°ï¼Œå¹¶ä½¿ç”¨å®ƒè¿”å› store çš„å‰¯æœ¬ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#c6cad2">// æ³¨æ„ï¼šè¿™æ˜¯ç®€å•ç²—æš´çš„ä¸­é—´ä»¶è°ƒç”¨æ–¹æ³•</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:#c6cad2">// å¹¶ *ä¸æ˜¯* Redux API çœŸå®çš„å®ç°æ–¹æ³•ã€‚</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">function</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">applyMiddleware</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">store</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> middlewares</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  middlewares </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> middlewares</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">slice</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  middlewares</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">reverse</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">let</span><span class="token plain"> dispatch </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> store</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">dispatch</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  middlewares</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">forEach</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">middleware</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">dispatch </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">middleware</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">store</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">dispatch</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#F92672">return</span><span class="token plain"> </span><span class="token known-class-name class-name">Object</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">assign</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> store</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> dispatch </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Redux å†…ç½®çš„ <a href="/api/applymiddleware"><code>applyMiddleware()</code></a> çš„å®ç°æ˜¯ç›¸ä¼¼çš„ï¼Œä½†<strong>åœ¨ä¸‰ä¸ªé‡è¦æ–¹é¢</strong>ä¸åŒï¼š</p><ul><li><p>å®ƒåªå‘ä¸­é—´ä»¶å…¬å¼€ <a href="/api/store">store API</a> çš„ä¸€ä¸ªå­é›†ï¼š[<code>dispatch(action)</code>](/api/store# dispatchaction) å’Œ <a href="/api/store#getState"><code>getState()</code></a>ã€‚</p></li><li><p>ç¡®ä¿å¦‚æœæ‚¨ä»ä¸­é—´ä»¶è°ƒç”¨ <code>store.dispatch(action)</code> è€Œä¸æ˜¯ <code>next(action)</code>ï¼Œè¯¥ action å®é™…ä¸Šå°†å†æ¬¡éå†æ•´ä¸ªä¸­é—´ä»¶é“¾ï¼ŒåŒ…æ‹¬å½“å‰çš„ä¸­é—´ä»¶ï¼Œè¿™éœ€è¦ä¸€äº›æŠ€å·§ã€‚<a href="/tutorials/fundamentals/part-6-async-logic">è¿™å¯¹å¼‚æ­¥ä¸­é—´ä»¶å¾ˆæœ‰ç”¨</a>ã€‚åœ¨é…ç½® Redux æœŸé—´è°ƒç”¨ <code>dispatch</code> æ—¶æœ‰ä¸€ä¸ªè­¦å‘Šï¼Œåé¢ä¼šè®²ã€‚</p></li><li><p>ä¸ºç¡®ä¿æ‚¨åªèƒ½åº”ç”¨ä¸€æ¬¡ä¸­é—´ä»¶ï¼Œå®ƒåœ¨ <code>createStore()</code> ä¸Šè¿è¡Œï¼Œè€Œä¸æ˜¯åœ¨ <code>store</code> æœ¬èº«ä¸Šè¿è¡Œã€‚å®ƒçš„å‡½æ•°ç­¾åä¸æ˜¯<code>(store, middlewares) =&gt; store</code>ï¼Œè€Œæ˜¯<code>(...middlewares) =&gt; (createStore) =&gt; createStore</code>ã€‚</p></li></ul><p>å› ä¸ºåœ¨ä½¿ç”¨ <code>createStore()</code> ä¹‹å‰å°†å‡½æ•°åº”ç”¨åˆ°å®ƒæ˜¯å¾ˆéº»çƒ¦çš„ï¼Œ<code>createStore()</code> çš„æœ€åä¸€ä¸ªå‚æ•°ä½œä¸ºå¯é€‰çš„æ¥æŒ‡å®šè¿™æ ·çš„å‡½æ•°ã€‚</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="è­¦å‘Šï¼šåœ¨é…ç½®-redux-æœŸé—´è°ƒç”¨-dispatch"></a>è­¦å‘Šï¼šåœ¨é…ç½® Redux æœŸé—´è°ƒç”¨ dispatch<a class="hash-link" href="#è­¦å‘Šï¼šåœ¨é…ç½®-redux-æœŸé—´è°ƒç”¨-dispatch" title="Direct link to heading">#</a></h4><p>å½“ <code>applyMiddleware</code> æ‰§è¡Œå¹¶é…ç½®ä½ çš„ä¸­é—´ä»¶æ—¶ï¼Œ<code>store.dispatch</code> å‡½æ•°å°†æŒ‡å‘ <code>createStore</code> æä¾›çš„æœ€åˆç‰ˆæœ¬ã€‚è¿™ä¸ªæ—¶å€™çš„ dispatch è¿˜ä¸ä¼šç»è¿‡ä»»ä½• middlewareã€‚å¦‚æœæ‚¨æœŸæœ›åœ¨é…ç½®æœŸé—´ä¸å¦ä¸€ä¸ªä¸­é—´ä»¶è¿›è¡Œäº¤äº’ï¼Œæ‚¨å¯èƒ½ä¼šæ„Ÿåˆ°å¤±æœ›ã€‚ç”±äºè¿™ç§æ„å¤–è¡Œä¸ºï¼Œåœ¨é…ç½®å®Œæˆä¹‹å‰å¦‚æœ dispatch äº† actionï¼Œ<code>applyMiddleware</code> å°†æŠ›å‡ºé”™è¯¯ã€‚è§£æ³•æ˜¯ï¼Œä½ åº”è¯¥é€šè¿‡ä¸€ä¸ªå…¬å…±å¯¹è±¡ï¼ˆä¾‹å¦‚åš API è¯·æ±‚çš„ä¸­é—´ä»¶ï¼Œé‚£å°±ç›´æ¥ç”¨ API è¯·æ±‚çš„å¯¹è±¡ï¼‰ç›´æ¥ä¸å…¶ä»–ä¸­é—´ä»¶é€šä¿¡ï¼Œæˆ–è€…æ”¾åˆ°ä¸­é—´ä»¶é…ç½®å®Œåçš„å›è°ƒå‡½æ•°ä¸­ç­‰å¾…æ‰§è¡Œã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="æœ€åçš„å®ç°"></a>æœ€åçš„å®ç°<a class="hash-link" href="#æœ€åçš„å®ç°" title="Direct link to heading">#</a></h3><p>é‰´äºè¿™ä¸ªä¸­é—´ä»¶ï¼Œæˆ‘ä»¬åˆšåˆšå†™é“ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#E6D874">logger</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token parameter">store</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token parameter">next</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token parameter">action</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">log</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;dispatching&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">let</span><span class="token plain"> result </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">next</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">log</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;next state&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> store</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">getState</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#F92672">return</span><span class="token plain"> result</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#E6D874">crashReporter</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token parameter">store</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token parameter">next</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token parameter">action</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#F92672">try</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#F92672">return</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">next</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#F92672">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">error</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;Caught an exception!&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> err</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token maybe-class-name">Raven</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">captureException</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      extra</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        action</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        state</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> store</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">getState</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#F92672">throw</span><span class="token plain"> err</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>ä»¥ä¸‹æ˜¯å¦‚ä½•å°†å…¶åº”ç”¨äº Redux store ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#F8F8F2">{</span><span class="token imports"> createStore</span><span class="token imports punctuation" style="color:#F8F8F2">,</span><span class="token imports"> combineReducers</span><span class="token imports punctuation" style="color:#F8F8F2">,</span><span class="token imports"> applyMiddleware </span><span class="token imports punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;redux&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> todoApp </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">combineReducers</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">reducers</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> store </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">createStore</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  todoApp</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token comment" style="color:#c6cad2">// applyMiddleware() tells createStore() how to handle middleware</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token function" style="color:#E6D874">applyMiddleware</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">logger</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> crashReporter</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>å°±æ˜¯è¿™æ ·ï¼ç°åœ¨ï¼Œdispatch åˆ° store çš„æ‰€æœ‰ action éƒ½ä¼šè°ƒç”¨ <code>logger</code> å’Œ <code>crashReporter</code> è¿™2ä¸ªä¸­é—´ä»¶ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#c6cad2">// Will flow through both logger and crashReporter middleware!</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">store</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">dispatch</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token function" style="color:#E6D874">addTodo</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;Use Redux&#x27;</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="seven-examples"></a>Seven Examples<a class="hash-link" href="#seven-examples" title="Direct link to heading">#</a></h2><p>å¦‚æœæ‚¨åœ¨é˜…è¯»ä¸Šè¿°éƒ¨åˆ†æ—¶å¤´è„‘å‘çƒ­ï¼Œè¯·æƒ³è±¡ä¸€ä¸‹ç¼–å†™å®ƒæ˜¯ä»€ä¹ˆæ„Ÿè§‰ã€‚æœ¬èŠ‚æ—¨åœ¨è®©æ‚¨å’Œæˆ‘æ”¾æ¾èº«å¿ƒï¼Œå¹¶æœ‰åŠ©äºè®©æ‚¨çš„å¤´è„‘å¼€çªã€‚</p><p>ä¸‹é¢çš„æ¯ä¸ªå‡½æ•°éƒ½æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„ Redux ä¸­é—´ä»¶ã€‚å®ƒä»¬å¹¶ä¸åŒæ ·æœ‰ç”¨ï¼Œä½†éƒ½åŒæ ·æœ‰è¶£ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#c6cad2">/**</span></div><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#c6cad2"> * æ—¥å¿—æ‰“å°æ¯ä¸ª dispatch çš„ action å’Œè°ƒç”¨åçš„çŠ¶æ€</span></div><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#c6cad2"> */</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#E6D874">logger</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token parameter">store</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token parameter">next</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token parameter">action</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">group</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">action</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">type</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">info</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;dispatching&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">let</span><span class="token plain"> result </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">next</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">log</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;next state&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> store</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">getState</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">groupEnd</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#F92672">return</span><span class="token plain"> result</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:#c6cad2">/**</span></div><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#c6cad2"> * æŠ¥é”™çš„æ—¶å€™å‘é€å¼‚å¸¸æŠ¥å‘Š</span></div><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#c6cad2"> */</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#E6D874">crashReporter</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token parameter">store</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token parameter">next</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token parameter">action</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#F92672">try</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#F92672">return</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">next</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#F92672">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">error</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;Caught an exception!&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> err</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token maybe-class-name">Raven</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">captureException</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      extra</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        action</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        state</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> store</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">getState</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#F92672">throw</span><span class="token plain"> err</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:#c6cad2">/**</span></div><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#c6cad2"> * ä¸€ä¸ªå®šæ—¶å™¨ï¼Œä½¿ç”¨ { meta: { delay: N } } å®‰æ’ action å»¶è¿Ÿ N æ¯«ç§’åè°ƒç”¨ã€‚</span></div><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#c6cad2"> * è®© `dispatch` è¿”å›ä¸€ä¸ªå–æ¶ˆå®šæ—¶å™¨çš„å‡½æ•°ã€‚</span></div><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#c6cad2"> */</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#E6D874">timeoutScheduler</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token parameter">store</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token parameter">next</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token parameter">action</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#F92672">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token operator" style="color:#F8F8F2">!</span><span class="token plain">action</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">meta</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">||</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">!</span><span class="token plain">action</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">meta</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">delay</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#F92672">return</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">next</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> timeoutId </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">setTimeout</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">next</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> action</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">meta</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">delay</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#F92672">return</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">function</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">cancel</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token function" style="color:#E6D874">clearTimeout</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">timeoutId</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:#c6cad2">/**</span></div><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#c6cad2"> * å¦ä¸€ä¸ªå®šæ—¶å™¨ï¼Œä½¿ç”¨ { meta: { raf: true } } è®© action åœ¨ rAF å¾ªç¯å†…è°ƒç”¨ã€‚</span></div><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#c6cad2"> * è®© `dispatch` è¿”å›ä¸€ä¸ªåˆ é™¤ action çš„å‡½æ•°</span></div><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#c6cad2"> */</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#E6D874">rafScheduler</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token parameter">store</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token parameter">next</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> queuedActions </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">[</span><span class="token punctuation" style="color:#F8F8F2">]</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">let</span><span class="token plain"> frame </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#F92672">null</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">function</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">loop</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    frame </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#F92672">null</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#F92672">try</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#F92672">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">queuedActions</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">length</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token function" style="color:#E6D874">next</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">queuedActions</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">shift</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#F92672">finally</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token function" style="color:#E6D874">maybeRaf</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">function</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">maybeRaf</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#F92672">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">queuedActions</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">length</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">&amp;&amp;</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">!</span><span class="token plain">frame</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      frame </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">requestAnimationFrame</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">loop</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#F92672">return</span><span class="token plain"> </span><span class="token parameter">action</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#F92672">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token operator" style="color:#F8F8F2">!</span><span class="token plain">action</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">meta</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">||</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">!</span><span class="token plain">action</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">meta</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">raf</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#F92672">return</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">next</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    queuedActions</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">push</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token function" style="color:#E6D874">maybeRaf</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#F92672">return</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">function</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">cancel</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      queuedActions </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> queuedActions</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">filter</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">a</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> a </span><span class="token operator" style="color:#F8F8F2">!==</span><span class="token plain"> action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:#c6cad2">/**</span></div><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#c6cad2"> * è®©ä½ å¯ä»¥ç›´æ¥ dispatch promise ä½œä¸º actionã€‚</span></div><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#c6cad2"> * å¦‚æœ promise æ‰§è¡ŒæˆåŠŸï¼Œå®ƒçš„ç»“æœå°†ä½œä¸ºä¸€ä¸ª action å‘é€ã€‚</span></div><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#c6cad2"> * `dispatch` è¿”å›çš„ä¹Ÿæ˜¯ promiseï¼Œè¿™æ ·å¦‚æœå‡ºé”™ä¹Ÿèƒ½å¤„ç†ã€‚</span></div><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#c6cad2"> */</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#E6D874">vanillaPromise</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token parameter">store</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token parameter">next</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token parameter">action</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#F92672">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token keyword" style="color:#F92672">typeof</span><span class="token plain"> action</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">then</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">!==</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;function&#x27;</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#F92672">return</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">next</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#F92672">return</span><span class="token plain"> </span><span class="token known-class-name class-name">Promise</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">resolve</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">then</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">store</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">dispatch</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:#c6cad2">/**</span></div><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#c6cad2"> * å…è®¸æ‚¨ dispatch å¸¦æœ‰ { promise } å­—æ®µçš„ç‰¹æ®Š actionã€‚</span></div><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#c6cad2"> *</span></div><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#c6cad2"> * è¿™ä¸ªä¸­é—´ä»¶ä¼šåœ¨ä¸€å¼€å§‹å°±æŠŠå®ƒä»¬å˜æˆä¸€ä¸ªå•ä¸€çš„ action ï¼Œ</span></div><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#c6cad2"> * ä»¥åŠå½“ `promise` æˆåŠŸæ—¶å† dispatch ä¸€ä¸ªæˆåŠŸï¼ˆæˆ–å¤±è´¥ï¼‰çš„ action ã€‚</span></div><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#c6cad2"> *</span></div><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#c6cad2"> * ä¸ºæ–¹ä¾¿èµ·è§ï¼Œ`dispatch` å°†è¿”å› promise ä»¥ä¾¿è°ƒç”¨è€…å¯ä»¥ç»§ç»­ thenã€‚</span></div><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#c6cad2"> */</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#E6D874">readyStatePromise</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token parameter">store</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token parameter">next</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token parameter">action</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#F92672">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token operator" style="color:#F8F8F2">!</span><span class="token plain">action</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">promise</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#F92672">return</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">next</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">function</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">makeAction</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">ready</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> data</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> newAction </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token known-class-name class-name">Object</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">assign</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> action</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> ready </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> data</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword" style="color:#F92672">delete</span><span class="token plain"> newAction</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">promise</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#F92672">return</span><span class="token plain"> newAction</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token function" style="color:#E6D874">next</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token function" style="color:#E6D874">makeAction</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token boolean" style="color:#AE81FF">false</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#F92672">return</span><span class="token plain"> action</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">promise</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">then</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token parameter">result</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">next</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token function" style="color:#E6D874">makeAction</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token boolean" style="color:#AE81FF">true</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> result </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token parameter">error</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">next</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token function" style="color:#E6D874">makeAction</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token boolean" style="color:#AE81FF">true</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> error </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:#c6cad2">/**</span></div><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#c6cad2"> * è®©ä½  dispatch å‡½æ•°è€Œä¸æ˜¯ action å¯¹è±¡ã€‚</span></div><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#c6cad2"> * æ­¤å‡½æ•°å°†æ¥æ”¶ `dispatch` å’Œ `getState` ä½œä¸ºå‚æ•°ã€‚</span></div><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#c6cad2"> *</span></div><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#c6cad2"> * ç”¨äºæå‰é€€å‡ºï¼ˆä½¿ç”¨ `getState()` çš„æ¡ä»¶åˆ¤æ–­ï¼‰ï¼Œä»¥åŠ</span></div><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#c6cad2"> * ç”¨äºå¼‚æ­¥æ§åˆ¶æµï¼ˆå®ƒå¯ä»¥ `dispatch()` åˆ«çš„ä¸œè¥¿ï¼‰ã€‚</span></div><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#c6cad2"> *</span></div><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#c6cad2"> * `dispatch` å°†è¿”å›è¢«è°ƒåº¦å‡½æ•°çš„è¿”å›å€¼ã€‚</span></div><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#c6cad2"> */</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#E6D874">thunk</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token parameter">store</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token parameter">next</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token parameter">action</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">typeof</span><span class="token plain"> action </span><span class="token operator" style="color:#F8F8F2">===</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;function&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token operator" style="color:#F8F8F2">?</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">action</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">store</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">dispatch</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> store</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">getState</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">next</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:#c6cad2">// æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸Šæ‰€æœ‰ä¸­é—´ä»¶ï¼ï¼ˆè¿™å¹¶ä¸æ„å‘³ç€ä½ åº”è¯¥ã€‚ï¼‰</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> todoApp </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">combineReducers</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">reducers</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> store </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">createStore</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  todoApp</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token function" style="color:#E6D874">applyMiddleware</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    rafScheduler</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    timeoutScheduler</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    thunk</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    vanillaPromise</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    readyStatePromise</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    logger</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    crashReporter</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/understanding/history-and-design/prior-art"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« å…ˆå‰æŠ€æœ¯</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/faq"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Redux FAQ Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#ç†è§£-middleware" class="table-of-contents__link">ç†è§£ Middleware</a><ul><li><a href="#é—®é¢˜ï¼šæ—¥å¿—" class="table-of-contents__link">é—®é¢˜ï¼šæ—¥å¿—</a></li><li><a href="#å°è¯•-1ï¼šæ‰‹åŠ¨æ‰“æ—¥å¿—" class="table-of-contents__link">å°è¯• #1ï¼šæ‰‹åŠ¨æ‰“æ—¥å¿—</a></li><li><a href="#å°è¯•-2-åŒ…è£¹-dispatch" class="table-of-contents__link">å°è¯• #2: åŒ…è£¹ dispatch</a></li><li><a href="#å°è¯•-3-ç»™-dispatch-åšçŒ´å­è¡¥ä¸ï¼ˆmonkeypatchï¼‰" class="table-of-contents__link">å°è¯• #3: ç»™ dispatch åšçŒ´å­è¡¥ä¸ï¼ˆMonkeypatchï¼‰</a></li><li><a href="#é—®é¢˜-å¼‚å¸¸ç›‘æ§" class="table-of-contents__link">é—®é¢˜: å¼‚å¸¸ç›‘æ§</a></li><li><a href="#å°è¯•-4-éšè—çŒ´å­è¡¥ä¸" class="table-of-contents__link">å°è¯• #4: éšè—çŒ´å­è¡¥ä¸</a></li><li><a href="#å°è¯•-5-ç§»é™¤çŒ´å­è¡¥ä¸" class="table-of-contents__link">å°è¯• #5: ç§»é™¤çŒ´å­è¡¥ä¸</a></li><li><a href="#å°è¯•-6ï¼šç®€å•ç²—æš´çš„ä¸­é—´ä»¶è°ƒç”¨æ–¹æ³•" class="table-of-contents__link">å°è¯• #6ï¼šç®€å•ç²—æš´çš„ä¸­é—´ä»¶è°ƒç”¨æ–¹æ³•</a></li><li><a href="#æœ€åçš„å®ç°" class="table-of-contents__link">æœ€åçš„å®ç°</a></li></ul></li><li><a href="#seven-examples" class="table-of-contents__link">Seven Examples</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/introduction/getting-started">å…¥é—¨</a></li><li class="footer__item"><a class="footer__link-item" href="/tutorials/essentials/part-1-overview-concepts">æ•™ç¨‹</a></li><li class="footer__item"><a class="footer__link-item" href="/faq">å¸¸è§é—®é¢˜</a></li><li class="footer__item"><a class="footer__link-item" href="/api/api-reference">API æ–‡æ¡£</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">ç¤¾åŒº</h4><ul class="footer__items"><li class="footer__item"><a href="https://discord.gg/0ZcbPKXt5bZ6au5t" target="_blank" rel="noopener noreferrer" class="footer__link-item">Reactiflux Discord</a></li><li class="footer__item"><a href="http://stackoverflow.com/questions/tagged/redux" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow</a></li><li class="footer__item"><a class="footer__link-item" href="/introduction/getting-started#help-and-discussion">Feedback</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">æ›´å¤š</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/camsong/redux-in-chinese" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li><li class="footer__item">
                <a href="https://www.netlify.com">
                  <img src="https://www.netlify.com/img/global/badges/netlify-color-accent.svg" alt="Deploys by Netlify">
                </a>
              </li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://redux.js.org/" target="_blank" rel="noopener noreferrer" class="footerLogoLink_MyFc"><img src="/img/redux.svg" alt="Redux Logo" class="themedImage_1VuW themedImage--light_3UqQ footer__logo"><img src="/img/redux.svg" alt="Redux Logo" class="themedImage_1VuW themedImage--dark_hz6m footer__logo"></a></div><div class="footer__copyright">Copyright Â© 2015â€“2021 Dan Abramov and Cam Song.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.3485d6c8.js"></script>
<script src="/assets/js/main.3f741185.js"></script>
</body>
</html>