<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.0">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Redux ä¸­æ–‡å®˜ç½‘ Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Redux ä¸­æ–‡å®˜ç½‘ Blog Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-66122997-1","auto"),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="search" type="application/opensearchdescription+xml" title="Redux ä¸­æ–‡å®˜ç½‘" href="/opensearch.xml"><title data-react-helmet="true">Redux å¾ªåºæ¸è¿›ï¼Œç¬¬å…­èŠ‚ï¼šæ€§èƒ½ä¸æ•°æ®èŒƒå¼åŒ– | Redux ä¸­æ–‡å®˜ç½‘</title><meta data-react-helmet="true" property="og:url" content="http://cn.redux.js.org/tutorials/essentials/part-6-performance-normalization"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Redux å¾ªåºæ¸è¿›ï¼Œç¬¬å…­èŠ‚ï¼šæ€§èƒ½ä¸æ•°æ®èŒƒå¼åŒ– | Redux ä¸­æ–‡å®˜ç½‘"><meta data-react-helmet="true" name="description" content="The official Redux Essentials tutorial: learn how to improve app performance and structure data correctly"><meta data-react-helmet="true" property="og:description" content="The official Redux Essentials tutorial: learn how to improve app performance and structure data correctly"><meta data-react-helmet="true" property="og:image" content="http://cn.redux.js.org/img/redux-logo-landscape.png"><meta data-react-helmet="true" name="twitter:image" content="http://cn.redux.js.org/img/redux-logo-landscape.png"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon/favicon.ico"><link data-react-helmet="true" rel="canonical" href="http://cn.redux.js.org/tutorials/essentials/part-6-performance-normalization"><link data-react-helmet="true" rel="alternate" href="http://cn.redux.js.org/tutorials/essentials/part-6-performance-normalization" hreflang="en"><link data-react-helmet="true" rel="alternate" href="http://cn.redux.js.org/tutorials/essentials/part-6-performance-normalization" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.a0cae3ae.css">
<link rel="preload" href="/assets/js/runtime~main.9044bd3c.js" as="script">
<link rel="preload" href="/assets/js/main.983ddc03.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/redux.svg" alt="Redux Logo" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/img/redux.svg" alt="Redux Logo" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"><strong class="navbar__title">Redux ä¸­æ–‡å®˜ç½‘</strong></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/introduction/getting-started">å…¥é—¨</a><a class="navbar__item navbar__link" href="/tutorials/essentials/part-1-overview-concepts">æ•™ç¨‹</a><a class="navbar__item navbar__link" href="/api/api-reference">API</a><a class="navbar__item navbar__link" href="/faq">å¸¸è§é—®é¢˜</a><a class="navbar__item navbar__link" href="/style-guide/style-guide">æœ€ä½³å®è·µ</a><a href="https://www.github.com/camsong/redux-in-chinese" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">æºç </a><a href="https://github.com/camsong/redux-in-chinese/issues" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">çº é”™</a><div class="react-toggle displayOnlyInLargeViewport_cxYs react-toggle--disabled" role="button" tabindex="-1"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_iYfV">ğŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_iYfV">ğŸŒ</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/redux.svg" alt="Redux Logo" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/img/redux.svg" alt="Redux Logo" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"><strong class="navbar__title">Redux ä¸­æ–‡å®˜ç½‘</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/introduction/getting-started">å…¥é—¨</a></li><li class="menu__list-item"><a class="menu__link" href="/tutorials/essentials/part-1-overview-concepts">æ•™ç¨‹</a></li><li class="menu__list-item"><a class="menu__link" href="/api/api-reference">API</a></li><li class="menu__list-item"><a class="menu__link" href="/faq">å¸¸è§é—®é¢˜</a></li><li class="menu__list-item"><a class="menu__link" href="/style-guide/style-guide">æœ€ä½³å®è·µ</a></li><li class="menu__list-item"><a href="https://www.github.com/camsong/redux-in-chinese" target="_blank" rel="noopener noreferrer" class="menu__link">æºç </a></li><li class="menu__list-item"><a href="https://github.com/camsong/redux-in-chinese/issues" target="_blank" rel="noopener noreferrer" class="menu__link">çº é”™</a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_lDyR"><div class="docSidebarContainer_0YBq" role="complementary"><div class="sidebar_a3j0"><div class="menu menu--responsive thin-scrollbar menu_cyFh"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_iZzd" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">ç®€ä»‹</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/introduction/getting-started">å…¥é—¨ Redux</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/introduction/installation">å®‰è£…</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/introduction/core-concepts">æ ¸å¿ƒæ¦‚å¿µ</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/introduction/learning-resources">å­¦ä¹ èµ„æº</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/introduction/ecosystem">ç”Ÿæ€</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/introduction/examples">ç¤ºä¾‹</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">æ•™ç¨‹</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/tutorials/index">æ•™ç¨‹ç›®å½•</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">Redux å¾ªåºæ¸è¿›</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/tutorials/essentials/part-1-overview-concepts">åŸºç¡€æ¦‚å¿µ</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/tutorials/essentials/part-2-app-structure">åº”ç”¨ç»“æ„</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/tutorials/essentials/part-3-data-flow">æ•°æ®æµåŸºç¡€</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/tutorials/essentials/part-4-using-data">ä½¿ç”¨æ•°æ®</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/tutorials/essentials/part-5-async-logic">å¼‚æ­¥é€»è¾‘ä¸æ•°æ®è¯·æ±‚</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/tutorials/essentials/part-6-performance-normalization">æ€§èƒ½ä¸æ•°æ®èŒƒå¼åŒ–</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Redux æ·±å…¥æµ…å‡º</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/tutorials/fundamentals/part-1-overview">Redux æ¦‚è§ˆ</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/tutorials/fundamentals/part-2-concepts-data-flow">Redux æ¦‚å¿µä¸æ•°æ®æµ</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/tutorials/fundamentals/part-3-state-actions-reducers">State, Actions, and Reducers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/tutorials/fundamentals/part-4-store">Store</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/tutorials/fundamentals/part-5-ui-react">UI and React</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/tutorials/fundamentals/part-6-async-logic">Async Logic and Data Fetching</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/tutorials/fundamentals/part-7-standard-patterns">æ ‡å‡† Redux æ¨¡å¼</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/tutorials/fundamentals/part-8-modern-redux">Modern Redux with Redux Toolkit</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">æŠ€å·§</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/recipe-index">æŠ€å·§</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/configuring-your-store">é…ç½® Store</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/usage-with-typescript">Usage with TypeScript</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/migrating-to-redux">è¿ç§»åˆ° Redux</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/using-object-spread-operator">ä½¿ç”¨å¯¹è±¡å±•å¼€è¿ç®—ç¬¦</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/reducing-boilerplate">å‡å°‘æ ·æ¿ä»£ç </a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/server-rendering">æœåŠ¡ç«¯æ¸²æŸ“</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/writing-tests">ç¼–å†™æµ‹è¯•</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/computing-derived-data">è®¡ç®—è¡ç”Ÿæ•°æ®</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/implementing-undo-history">å®ç°æ’¤é”€é‡åš</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/isolating-redux-sub-apps">å­åº”ç”¨éš”ç¦»</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/code-splitting">ä»£ç åˆ†å‰²</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/troubleshooting">Troubleshooting</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">ç»„ç»‡ Reducers</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/structuring-reducers/structuring-reducers">ç»„ç»‡ Reducer</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/structuring-reducers/prerequisite-concepts">Reducer å¿…å¤‡æ¦‚å¿µ</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/structuring-reducers/basic-reducer-structure">Reducer å’Œ State çš„åŸºæœ¬ç»“æ„</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/structuring-reducers/splitting-reducer-logic">æ‹†åˆ† Reducer é€»è¾‘</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/structuring-reducers/refactoring-reducer-example">é‡æ„ Reducerï¼šåŸºäºå‡½æ•°åˆ†è§£ï¼ˆFunctional Decompositionï¼‰å’Œ Reducer ç»„åˆ</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/structuring-reducers/using-combinereducers">`combineReducers` ç”¨æ³•</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/structuring-reducers/beyond-combinereducers">`combineReducers` è¿›é˜¶</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/structuring-reducers/normalizing-state-shape">State èŒƒå¼åŒ–</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/structuring-reducers/updating-normalized-data">ç®¡ç†èŒƒå¼åŒ–æ•°æ®</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/structuring-reducers/reusing-reducer-logic">Reducer é€»è¾‘å¤ç”¨</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/structuring-reducers/immutable-update-patterns">Immutable ä¸å¯å˜æ›´æ–°æ¨¡å¼</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/structuring-reducers/initializing-state">åˆå§‹åŒ– State</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">æ·±å…¥ç†è§£ Redux</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">åƒ Redux ä¸€æ ·æ€è€ƒ</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/understanding/thinking-in-redux/motivation">åŠ¨æœº</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/understanding/thinking-in-redux/three-principles">ä¸‰å¤§åŸåˆ™</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/understanding/thinking-in-redux/glossary">è¯æ±‡è¡¨</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">å†å²ä¸è®¾è®¡åŸåˆ™</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/understanding/history-and-design/prior-art">å…ˆå‰æŠ€æœ¯</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/understanding/history-and-design/middleware">Middleware ä¸­é—´ä»¶</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">å¸¸è§é—®é¢˜</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/faq">Redux FAQ</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/faq/general">Redux FAQ: General</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/faq/reducers">Redux FAQ: Reducers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/faq/organizing-state">Redux FAQ: Organizing State</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/faq/store-setup">Redux FAQ: Store Setup</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/faq/actions">Redux FAQ: Actions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/faq/immutable-data">Redux FAQ: Immutable Data</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/faq/code-structure">Redux FAQ: Code Structure</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/faq/performance">Redux FAQ: Performance</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/faq/design-decisions">Redux FAQ: Design Decisions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/faq/react-redux">Redux FAQ: React Redux</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/faq/miscellaneous">Redux FAQ: Miscellaneous</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">ç¼–ç è§„èŒƒ</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/style-guide/style-guide">Style Guide: Best Practices</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">API æ–‡æ¡£</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/api/api-reference">API Reference</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/api/createstore">createStore</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/api/store">Store</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/api/combinereducers">combineReducers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/api/applymiddleware">applyMiddleware</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/api/bindactioncreators">bindActionCreators</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/api/compose">compose</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Redux Toolkit</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/redux-toolkit/overview">Redux Toolkit: æ¦‚è§ˆ</a></li></ul></li></ul></div></div></div><main class="docMainContainer_r8cw"><div class="container padding-vert--lg docItemWrapper_NJLN"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><header><h1 class="docTitle_-X99">ç¬¬å…­èŠ‚ï¼šæ€§èƒ½ä¸æ•°æ®èŒƒå¼åŒ–</h1></header><div class="markdown"><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>ä½ å°†å­¦åˆ°</h5></div><div class="admonition-content"><ul><li>å¦‚ä½•ä½¿ç”¨ <code>createSelector</code> åˆ›å»ºè®°å¿†åŒ–çš„ selector å‡½æ•°</li><li>ä¼˜åŒ–ç»„ä»¶æ¸²æŸ“æ€§èƒ½çš„æ–¹æ³•</li><li>å¦‚ä½•ä½¿ç”¨ <code>createEntityAdapter</code> æ¥å­˜å‚¨å’Œæ›´æ–°èŒƒå¼åŒ–æ•°æ®</li></ul></div></div><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>å¿…å¤‡èƒ½åŠ›</h5></div><div class="admonition-content"><ul><li>å®Œæˆ<a href="/tutorials/essentials/part-5-async-logic">ç¬¬äº”èŠ‚</a>ï¼Œç†è§£æ•°æ®è¯·æ±‚æµç¨‹</li></ul></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="ç®€ä»‹"></a>ç®€ä»‹<a class="hash-link" href="#ç®€ä»‹" title="Direct link to heading">#</a></h2><p>åœ¨<a href="/tutorials/essentials/part-5-async-logic">ç¬¬äº”èŠ‚ï¼šå¼‚æ­¥é€»è¾‘ä¸æ•°æ®è¯·æ±‚</a>ä¸­ï¼Œæˆ‘ä»¬è®²è§£äº†å¦‚ä½•ç¼–å†™å¼‚æ­¥ thunks ä»æœåŠ¡ç«¯ API è·å–æ•°æ®ï¼Œå¦‚ä½•å¤„ç†å¼‚æ­¥è¯·æ±‚ state çš„å¼€å‘æ¨¡å¼ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨ selector å‡½æ•°å¯¹ä» Redux state ä¸­è¯»å–æ•°æ®çš„é€»è¾‘è¿›è¡Œå°è£…ã€‚</p><p>åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†ç ”ç©¶ä¼˜åŒ–æ–¹æ³•æ¥ç¡®ä¿æˆ‘ä»¬çš„åº”ç”¨å…·æœ‰è¾ƒå¥½æ€§èƒ½ï¼Œä»¥åŠç”¨äºè‡ªåŠ¨å¤„ç† store ä¸­æ•°æ®å¸¸è§æ›´æ–°çš„æŠ€æœ¯ã€‚</p><p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬çš„å¤§éƒ¨åˆ†åŠŸèƒ½éƒ½ä»¥ <code>posts</code> çš„ç‰¹ç‚¹ä¸ºä¸­å¿ƒã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†ä¸ºè¿™ä¸ªåº”ç”¨æ·»åŠ å‡ ä¸ªæ–°éƒ¨åˆ†ï¼Œæ·»åŠ è¿™äº›ä¹‹åï¼Œæˆ‘ä»¬å°†çœ‹ä¸€çœ‹æ„å»ºäº‹ç‰©çš„å…·ä½“ç»†èŠ‚ï¼Œå¹¶è®¨è®ºåˆ°ç›®å‰ä¸ºæ­¢æˆ‘ä»¬æ„å»ºçš„ä¸€äº›ç¼ºé™·ä»¥åŠæˆ‘ä»¬åº”è¯¥å¦‚ä½•å¯¹å…¶è¿›è¡Œæ”¹è¿›ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="æ·»åŠ ç”¨æˆ·é¡µé¢"></a>æ·»åŠ ç”¨æˆ·é¡µé¢<a class="hash-link" href="#æ·»åŠ ç”¨æˆ·é¡µé¢" title="Direct link to heading">#</a></h2><p>æˆ‘ä»¬ä»è™šå‡ API ä¸­è·å–ç”¨æˆ·åˆ—è¡¨ï¼Œå½“æˆ‘ä»¬æ·»åŠ æ–°å¸–å­æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä»ä¸­é€‰å–ä¸€ä¸ªç”¨æˆ·ä½œä¸ºä½œè€…ã€‚ä½†æ˜¯ï¼Œç¤¾äº¤åª’ä½“åº”ç”¨ç¨‹åºéœ€è¦æœ‰èƒ½å¤ŸæŸ¥çœ‹ç‰¹å®šç”¨æˆ·çš„é¡µé¢ï¼Œå¹¶æŸ¥çœ‹ä»–ä»¬å‘å¸ƒçš„æ‰€æœ‰å¸–å­ã€‚è®©æˆ‘ä»¬æ·»åŠ ä¸€ä¸ªé¡µé¢æ¥æ˜¾ç¤ºæ‰€æœ‰ç”¨æˆ·åˆ—è¡¨ï¼Œæ·»åŠ å¦ä¸€ä¸ªé¡µé¢æ¥æ˜¾ç¤ºç‰¹å®šç”¨æˆ·çš„æ‰€æœ‰å¸–å­ã€‚</p><p>æˆ‘ä»¬å°†ä»æ·»åŠ  <code>&lt;UsersList&gt;</code> ç»„ä»¶å¼€å§‹ã€‚å®ƒéµå¾ªå¸¸è§„æ¨¡å¼ï¼Œä½¿ç”¨ <code>useSelector</code> ä» Store ä¸­è·å–æ•°æ®ï¼Œç„¶åé€šè¿‡æ•°ç»„æ˜ å°„ç”Ÿæˆä¸€ä¸ªç”¨æˆ·åˆ—è¡¨ï¼Œå…¶ä¸­ç”¨æˆ·åŒ…å«ä¸€ä¸ªè·³è½¬åˆ°å…¶å„è‡ªé¡µé¢çš„é“¾æ¥ï¼š</p><div class="codeBlockContainer_J+bg"><div style="color:#f8f8f2;background-color:#272822" class="codeBlockTitle_oQzk">features/users/UsersList.js</div><div class="codeBlockContent_csEI jsx"><div tabindex="0" class="prism-code language-jsx codeBlock_rtdJ thin-scrollbar codeBlockWithTitle_ZT05"><div class="codeBlockLines_1zSZ" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token imports maybe-class-name">React</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;react&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#F8F8F2">{</span><span class="token imports"> useSelector </span><span class="token imports punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;react-redux&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#F8F8F2">{</span><span class="token imports"> </span><span class="token imports maybe-class-name">Link</span><span class="token imports"> </span><span class="token imports punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;react-router-dom&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#F8F8F2">{</span><span class="token imports"> selectAllUsers </span><span class="token imports punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;./usersSlice&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function maybe-class-name" style="color:#E6D874">UsersList</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> users </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">useSelector</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">selectAllUsers</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> renderedUsers </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> users</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">map</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">user</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token tag punctuation" style="color:#F8F8F2">&lt;</span><span class="token tag" style="color:#F92672">li</span><span class="token tag" style="color:#F92672"> </span><span class="token tag attr-name" style="color:#a6e22e">key</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#F8F8F2">=</span><span class="token tag script language-javascript punctuation" style="color:#F8F8F2">{</span><span class="token tag script language-javascript" style="color:#F92672">user</span><span class="token tag script language-javascript punctuation" style="color:#F8F8F2">.</span><span class="token tag script language-javascript property-access" style="color:#F92672">id</span><span class="token tag script language-javascript punctuation" style="color:#F8F8F2">}</span><span class="token tag punctuation" style="color:#F8F8F2">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain-text">      </span><span class="token tag punctuation" style="color:#F8F8F2">&lt;</span><span class="token tag class-name" style="color:#F92672">Link</span><span class="token tag" style="color:#F92672"> </span><span class="token tag attr-name" style="color:#a6e22e">to</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#F8F8F2">=</span><span class="token tag script language-javascript punctuation" style="color:#F8F8F2">{</span><span class="token tag script language-javascript template-string template-punctuation string" style="color:#a6e22e">`</span><span class="token tag script language-javascript template-string string" style="color:#a6e22e">/users/</span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation" style="color:#F8F8F2">${</span><span class="token tag script language-javascript template-string interpolation" style="color:#F92672">user</span><span class="token tag script language-javascript template-string interpolation punctuation" style="color:#F8F8F2">.</span><span class="token tag script language-javascript template-string interpolation property-access" style="color:#F92672">id</span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation" style="color:#F8F8F2">}</span><span class="token tag script language-javascript template-string template-punctuation string" style="color:#a6e22e">`</span><span class="token tag script language-javascript punctuation" style="color:#F8F8F2">}</span><span class="token tag punctuation" style="color:#F8F8F2">&gt;</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain">user</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">name</span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token tag punctuation" style="color:#F8F8F2">&lt;/</span><span class="token tag class-name" style="color:#F92672">Link</span><span class="token tag punctuation" style="color:#F8F8F2">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:#F8F8F2">&lt;/</span><span class="token tag" style="color:#F92672">li</span><span class="token tag punctuation" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#F92672">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token tag punctuation" style="color:#F8F8F2">&lt;</span><span class="token tag" style="color:#F92672">section</span><span class="token tag punctuation" style="color:#F8F8F2">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain-text">      </span><span class="token tag punctuation" style="color:#F8F8F2">&lt;</span><span class="token tag" style="color:#F92672">h2</span><span class="token tag punctuation" style="color:#F8F8F2">&gt;</span><span class="token plain-text">Users</span><span class="token tag punctuation" style="color:#F8F8F2">&lt;/</span><span class="token tag" style="color:#F92672">h2</span><span class="token tag punctuation" style="color:#F8F8F2">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain-text" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain-text">      </span><span class="token tag punctuation" style="color:#F8F8F2">&lt;</span><span class="token tag" style="color:#F92672">ul</span><span class="token tag punctuation" style="color:#F8F8F2">&gt;</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain">renderedUsers</span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token tag punctuation" style="color:#F8F8F2">&lt;/</span><span class="token tag" style="color:#F92672">ul</span><span class="token tag punctuation" style="color:#F8F8F2">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:#F8F8F2">&lt;/</span><span class="token tag" style="color:#F92672">section</span><span class="token tag punctuation" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>æˆ‘ä»¬è¿˜æ²¡æœ‰ <code>selectAllUsers</code> selectorï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å°†å…¶æ·»åŠ åˆ° <code>usersSlice.js</code> ä¸­ï¼ŒåŒæ—¶æ·»åŠ ä¸€ä¸ª <code>selectUserById</code> selectorï¼š</p><div class="codeBlockContainer_J+bg"><div style="color:#f8f8f2;background-color:#272822" class="codeBlockTitle_oQzk">features/users/usersSlice.js</div><div class="codeBlockContent_csEI js"><div tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar codeBlockWithTitle_ZT05"><div class="codeBlockLines_1zSZ" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">default</span><span class="token plain"> usersSlice</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">reducer</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#E6D874">selectAllUsers</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token parameter">state</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> state</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">users</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#E6D874">selectUserById</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> userId</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  state</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">users</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">find</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">user</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> user</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">id</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">===</span><span class="token plain"> userId</span><span class="token punctuation" style="color:#F8F8F2">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†æ·»åŠ  <code>&lt;UserPage&gt;</code>ï¼Œ ç±»ä¼¼äºæˆ‘ä»¬çš„ <code>&lt;SinglePostPage&gt;</code> ï¼Œä»è·¯ç”±ä¸­è·å– <code>userId</code> å‚æ•°ï¼š</p><div class="codeBlockContainer_J+bg"><div style="color:#f8f8f2;background-color:#272822" class="codeBlockTitle_oQzk">features/users/UserPage.js</div><div class="codeBlockContent_csEI jsx"><div tabindex="0" class="prism-code language-jsx codeBlock_rtdJ thin-scrollbar codeBlockWithTitle_ZT05"><div class="codeBlockLines_1zSZ" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token imports maybe-class-name">React</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;react&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#F8F8F2">{</span><span class="token imports"> useSelector </span><span class="token imports punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;react-redux&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#F8F8F2">{</span><span class="token imports"> </span><span class="token imports maybe-class-name">Link</span><span class="token imports"> </span><span class="token imports punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;react-router-dom&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#F8F8F2">{</span><span class="token imports"> selectUserById </span><span class="token imports punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;../users/usersSlice&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#F8F8F2">{</span><span class="token imports"> selectAllPosts </span><span class="token imports punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;../posts/postsSlice&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function maybe-class-name" style="color:#E6D874">UserPage</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter punctuation" style="color:#F8F8F2">{</span><span class="token parameter"> match </span><span class="token parameter punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> userId </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> match</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">params</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> user </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">useSelector</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">selectUserById</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">state</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> userId</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> postsForUser </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">useSelector</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> allPosts </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">selectAllPosts</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">state</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#F92672">return</span><span class="token plain"> allPosts</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">filter</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">post</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> post</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">user</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">===</span><span class="token plain"> userId</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> postTitles </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> postsForUser</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">map</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">post</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token tag punctuation" style="color:#F8F8F2">&lt;</span><span class="token tag" style="color:#F92672">li</span><span class="token tag" style="color:#F92672"> </span><span class="token tag attr-name" style="color:#a6e22e">key</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#F8F8F2">=</span><span class="token tag script language-javascript punctuation" style="color:#F8F8F2">{</span><span class="token tag script language-javascript" style="color:#F92672">post</span><span class="token tag script language-javascript punctuation" style="color:#F8F8F2">.</span><span class="token tag script language-javascript property-access" style="color:#F92672">id</span><span class="token tag script language-javascript punctuation" style="color:#F8F8F2">}</span><span class="token tag punctuation" style="color:#F8F8F2">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain-text">      </span><span class="token tag punctuation" style="color:#F8F8F2">&lt;</span><span class="token tag class-name" style="color:#F92672">Link</span><span class="token tag" style="color:#F92672"> </span><span class="token tag attr-name" style="color:#a6e22e">to</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#F8F8F2">=</span><span class="token tag script language-javascript punctuation" style="color:#F8F8F2">{</span><span class="token tag script language-javascript template-string template-punctuation string" style="color:#a6e22e">`</span><span class="token tag script language-javascript template-string string" style="color:#a6e22e">/posts/</span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation" style="color:#F8F8F2">${</span><span class="token tag script language-javascript template-string interpolation" style="color:#F92672">post</span><span class="token tag script language-javascript template-string interpolation punctuation" style="color:#F8F8F2">.</span><span class="token tag script language-javascript template-string interpolation property-access" style="color:#F92672">id</span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation" style="color:#F8F8F2">}</span><span class="token tag script language-javascript template-string template-punctuation string" style="color:#a6e22e">`</span><span class="token tag script language-javascript punctuation" style="color:#F8F8F2">}</span><span class="token tag punctuation" style="color:#F8F8F2">&gt;</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain">post</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">title</span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token tag punctuation" style="color:#F8F8F2">&lt;/</span><span class="token tag class-name" style="color:#F92672">Link</span><span class="token tag punctuation" style="color:#F8F8F2">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:#F8F8F2">&lt;/</span><span class="token tag" style="color:#F92672">li</span><span class="token tag punctuation" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#F92672">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token tag punctuation" style="color:#F8F8F2">&lt;</span><span class="token tag" style="color:#F92672">section</span><span class="token tag punctuation" style="color:#F8F8F2">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain-text">      </span><span class="token tag punctuation" style="color:#F8F8F2">&lt;</span><span class="token tag" style="color:#F92672">h2</span><span class="token tag punctuation" style="color:#F8F8F2">&gt;</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain">user</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">name</span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token tag punctuation" style="color:#F8F8F2">&lt;/</span><span class="token tag" style="color:#F92672">h2</span><span class="token tag punctuation" style="color:#F8F8F2">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain-text" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain-text">      </span><span class="token tag punctuation" style="color:#F8F8F2">&lt;</span><span class="token tag" style="color:#F92672">ul</span><span class="token tag punctuation" style="color:#F8F8F2">&gt;</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain">postTitles</span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token tag punctuation" style="color:#F8F8F2">&lt;/</span><span class="token tag" style="color:#F92672">ul</span><span class="token tag punctuation" style="color:#F8F8F2">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:#F8F8F2">&lt;/</span><span class="token tag" style="color:#F92672">section</span><span class="token tag punctuation" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>æ­£å¦‚æˆ‘ä»¬ä¹‹å‰æ‰€è§ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è°ƒç”¨ <code>useSelector</code> æˆ–ä» props ä¸­è·å–æ•°æ®ï¼Œå¹¶åœ¨å¦ä¸€ä¸ª <code>useSelector</code> ä¸­ä½¿ç”¨å®ƒæ¥å¸®åŠ©å†³å®šä» store ä¸­è·å–å“ªäº›å†…å®¹ã€‚</p><p>åœ¨ <code>&lt;App&gt;</code> ä¸­ä¸ºè¿™äº›ç»„ä»¶æ·»åŠ è·¯ç”±ã€‚</p><div class="codeBlockContainer_J+bg"><div style="color:#f8f8f2;background-color:#272822" class="codeBlockTitle_oQzk">App.js</div><div class="codeBlockContent_csEI jsx"><div tabindex="0" class="prism-code language-jsx codeBlock_rtdJ thin-scrollbar codeBlockWithTitle_ZT05"><div class="codeBlockLines_1zSZ" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token plain">          </span><span class="token tag punctuation" style="color:#F8F8F2">&lt;</span><span class="token tag class-name" style="color:#F92672">Route</span><span class="token tag" style="color:#F92672"> </span><span class="token tag attr-name" style="color:#a6e22e">exact</span><span class="token tag" style="color:#F92672"> </span><span class="token tag attr-name" style="color:#a6e22e">path</span><span class="token tag attr-value punctuation attr-equals" style="color:#F8F8F2">=</span><span class="token tag attr-value punctuation" style="color:#F8F8F2">&quot;</span><span class="token tag attr-value" style="color:#E6D874">/posts/:postId</span><span class="token tag attr-value punctuation" style="color:#F8F8F2">&quot;</span><span class="token tag" style="color:#F92672"> </span><span class="token tag attr-name" style="color:#a6e22e">component</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#F8F8F2">=</span><span class="token tag script language-javascript punctuation" style="color:#F8F8F2">{</span><span class="token tag script language-javascript maybe-class-name" style="color:#F92672">SinglePostPage</span><span class="token tag script language-javascript punctuation" style="color:#F8F8F2">}</span><span class="token tag" style="color:#F92672"> </span><span class="token tag punctuation" style="color:#F8F8F2">/&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">          </span><span class="token tag punctuation" style="color:#F8F8F2">&lt;</span><span class="token tag class-name" style="color:#F92672">Route</span><span class="token tag" style="color:#F92672"> </span><span class="token tag attr-name" style="color:#a6e22e">exact</span><span class="token tag" style="color:#F92672"> </span><span class="token tag attr-name" style="color:#a6e22e">path</span><span class="token tag attr-value punctuation attr-equals" style="color:#F8F8F2">=</span><span class="token tag attr-value punctuation" style="color:#F8F8F2">&quot;</span><span class="token tag attr-value" style="color:#E6D874">/editPost/:postId</span><span class="token tag attr-value punctuation" style="color:#F8F8F2">&quot;</span><span class="token tag" style="color:#F92672"> </span><span class="token tag attr-name" style="color:#a6e22e">component</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#F8F8F2">=</span><span class="token tag script language-javascript punctuation" style="color:#F8F8F2">{</span><span class="token tag script language-javascript maybe-class-name" style="color:#F92672">EditPostForm</span><span class="token tag script language-javascript punctuation" style="color:#F8F8F2">}</span><span class="token tag" style="color:#F92672"> </span><span class="token tag punctuation" style="color:#F8F8F2">/&gt;</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">          </span><span class="token tag punctuation" style="color:#F8F8F2">&lt;</span><span class="token tag class-name" style="color:#F92672">Route</span><span class="token tag" style="color:#F92672"> </span><span class="token tag attr-name" style="color:#a6e22e">exact</span><span class="token tag" style="color:#F92672"> </span><span class="token tag attr-name" style="color:#a6e22e">path</span><span class="token tag attr-value punctuation attr-equals" style="color:#F8F8F2">=</span><span class="token tag attr-value punctuation" style="color:#F8F8F2">&quot;</span><span class="token tag attr-value" style="color:#E6D874">/users</span><span class="token tag attr-value punctuation" style="color:#F8F8F2">&quot;</span><span class="token tag" style="color:#F92672"> </span><span class="token tag attr-name" style="color:#a6e22e">component</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#F8F8F2">=</span><span class="token tag script language-javascript punctuation" style="color:#F8F8F2">{</span><span class="token tag script language-javascript maybe-class-name" style="color:#F92672">UsersList</span><span class="token tag script language-javascript punctuation" style="color:#F8F8F2">}</span><span class="token tag" style="color:#F92672"> </span><span class="token tag punctuation" style="color:#F8F8F2">/&gt;</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">          </span><span class="token tag punctuation" style="color:#F8F8F2">&lt;</span><span class="token tag class-name" style="color:#F92672">Route</span><span class="token tag" style="color:#F92672"> </span><span class="token tag attr-name" style="color:#a6e22e">exact</span><span class="token tag" style="color:#F92672"> </span><span class="token tag attr-name" style="color:#a6e22e">path</span><span class="token tag attr-value punctuation attr-equals" style="color:#F8F8F2">=</span><span class="token tag attr-value punctuation" style="color:#F8F8F2">&quot;</span><span class="token tag attr-value" style="color:#E6D874">/users/:userId</span><span class="token tag attr-value punctuation" style="color:#F8F8F2">&quot;</span><span class="token tag" style="color:#F92672"> </span><span class="token tag attr-name" style="color:#a6e22e">component</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#F8F8F2">=</span><span class="token tag script language-javascript punctuation" style="color:#F8F8F2">{</span><span class="token tag script language-javascript maybe-class-name" style="color:#F92672">UserPage</span><span class="token tag script language-javascript punctuation" style="color:#F8F8F2">}</span><span class="token tag" style="color:#F92672"> </span><span class="token tag punctuation" style="color:#F8F8F2">/&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">          </span><span class="token tag punctuation" style="color:#F8F8F2">&lt;</span><span class="token tag class-name" style="color:#F92672">Redirect</span><span class="token tag" style="color:#F92672"> </span><span class="token tag attr-name" style="color:#a6e22e">to</span><span class="token tag attr-value punctuation attr-equals" style="color:#F8F8F2">=</span><span class="token tag attr-value punctuation" style="color:#F8F8F2">&quot;</span><span class="token tag attr-value" style="color:#E6D874">/</span><span class="token tag attr-value punctuation" style="color:#F8F8F2">&quot;</span><span class="token tag" style="color:#F92672"> </span><span class="token tag punctuation" style="color:#F8F8F2">/&gt;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>åœ¨ <code>&lt;Navbar&gt;</code> ä¸­æ·»åŠ ä¸€ä¸ªç”¨äºé“¾æ¥åˆ° <code>/users</code> çš„ tab ï¼Œä½¿æˆ‘ä»¬èƒ½å¤Ÿç‚¹å‡»å¹¶è·³è½¬åˆ°<code>&lt;UsersList&gt;</code>ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="æ·»åŠ é€šçŸ¥"></a>æ·»åŠ é€šçŸ¥<a class="hash-link" href="#æ·»åŠ é€šçŸ¥" title="Direct link to heading">#</a></h2><p>å¦‚æœä¸èƒ½å¼¹å‡ºé€šçŸ¥å‘Šè¯‰æˆ‘ä»¬æœ‰äººå‘å¸ƒäº†æ¶ˆæ¯ã€ç•™ä¸‹äº†è¯„è®ºæˆ–è€…å¯¹æˆ‘ä»¬çš„å¸–å­åšå‡ºäº†å›åº”ï¼Œé‚£ä¹ˆä»»ä½•ç¤¾äº¤åª’ä½“åº”ç”¨éƒ½æ˜¯ä¸å®Œæ•´çš„ã€‚</p><p>åœ¨ä¸€ä¸ªçœŸå®çš„åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬çš„å®¢æˆ·ç«¯å’Œåç«¯æœåŠ¡å™¨è¿›è¡ŒæŒç»­çš„é€šä¿¡ï¼Œå½“å‘ç”ŸæŸäº›äº‹æƒ…æ—¶ï¼ŒæœåŠ¡å™¨éƒ½ä¼šå‘å®¢æˆ·ç«¯æ¨é€é€šçŸ¥ã€‚ç”±äºæˆ‘ä»¬è¿™æ˜¯ä¸€ä¸ªå°å‹åº”ç”¨ï¼Œæˆ‘ä»¬å°†é€šè¿‡æ·»åŠ ä¸€ä¸ªæŒ‰é’®ä»è™šå‡çš„ API ä¸­è·å–ä¸€äº›é€šçŸ¥æ¥æ¨¡æ‹Ÿè¯¥è¿‡ç¨‹ã€‚æˆ‘ä»¬ä¹Ÿæ²¡æœ‰ä»»ä½•ç”¨æ¥å‘é€æ¶ˆæ¯æˆ–å¯¹å¸–å­åšå‡ºååº”çš„<strong>çœŸå®</strong>ç”¨æˆ·ï¼Œå› æ­¤è™šå‡ API ä¼šåœ¨æˆ‘ä»¬æ¯æ¬¡å‘å‡ºè¯·æ±‚æ—¶åˆ›å»ºä¸€äº›éšæœºé€šçŸ¥æ¡ç›®ã€‚ï¼ˆè¯·è®°ä½ï¼Œè¿™é‡Œçš„ç›®æ ‡æ˜¯äº†è§£å¦‚ä½•ä½¿ç”¨ Redux æœ¬èº«ã€‚ï¼‰</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="é€šçŸ¥åˆ‡ç‰‡"></a>é€šçŸ¥åˆ‡ç‰‡<a class="hash-link" href="#é€šçŸ¥åˆ‡ç‰‡" title="Direct link to heading">#</a></h3><p>ç”±äºè¿™æ˜¯æˆ‘ä»¬åº”ç”¨ç¨‹åºçš„ä¸€ä¸ªæ–°éƒ¨åˆ†ï¼Œç¬¬ä¸€æ­¥æ˜¯ä¸ºæˆ‘ä»¬çš„é€šçŸ¥åˆ›å»ºä¸€ä¸ªæ–°åˆ‡ç‰‡ï¼Œä»¥åŠä¸€ä¸ªä» API è·å–ä¸€äº›é€šçŸ¥æ¡ç›®çš„å¼‚æ­¥ thunkã€‚ä¸ºäº†åˆ›å»ºä¸€äº›çœŸå®çš„é€šçŸ¥ï¼Œæˆ‘ä»¬å°†åœ¨ state ä¸­çš„ä¿å­˜æœ€æ–°é€šçŸ¥çš„æ—¶é—´æˆ³ã€‚è¿™å°†ä½¿æ¨¡æ‹ŸæœåŠ¡å™¨ç”Ÿæˆæ¯”è¯¥æ—¶é—´æˆ³æ›´æ–°çš„é€šçŸ¥ï¼š</p><div class="codeBlockContainer_J+bg"><div style="color:#f8f8f2;background-color:#272822" class="codeBlockTitle_oQzk">features/notifications/notificationsSlice.js</div><div class="codeBlockContent_csEI js"><div tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar codeBlockWithTitle_ZT05"><div class="codeBlockLines_1zSZ" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#F8F8F2">{</span><span class="token imports"> createSlice</span><span class="token imports punctuation" style="color:#F8F8F2">,</span><span class="token imports"> createAsyncThunk </span><span class="token imports punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;@reduxjs/toolkit&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#F8F8F2">{</span><span class="token imports"> client </span><span class="token imports punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;../../api/client&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> fetchNotifications </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">createAsyncThunk</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token string" style="color:#a6e22e">&#x27;notifications/fetchNotifications&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">async</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">_</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> </span><span class="token parameter punctuation" style="color:#F8F8F2">{</span><span class="token parameter"> getState </span><span class="token parameter punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> allNotifications </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">selectAllNotifications</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token function" style="color:#E6D874">getState</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">[</span><span class="token plain">latestNotification</span><span class="token punctuation" style="color:#F8F8F2">]</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> allNotifications</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> latestTimestamp </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> latestNotification </span><span class="token operator" style="color:#F8F8F2">?</span><span class="token plain"> latestNotification</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">date</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> response </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#F92672">await</span><span class="token plain"> client</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">get</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token template-string template-punctuation string" style="color:#a6e22e">`</span><span class="token template-string string" style="color:#a6e22e">/fakeApi/notifications?since=</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#F8F8F2">${</span><span class="token template-string interpolation">latestTimestamp</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#F8F8F2">}</span><span class="token template-string template-punctuation string" style="color:#a6e22e">`</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#F92672">return</span><span class="token plain"> response</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">notifications</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> notificationsSlice </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">createSlice</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token literal-property property" style="color:#F92672">name</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;notifications&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token literal-property property" style="color:#F92672">initialState</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">[</span><span class="token punctuation" style="color:#F8F8F2">]</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token literal-property property" style="color:#F92672">reducers</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token literal-property property" style="color:#F92672">extraReducers</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">[</span><span class="token plain">fetchNotifications</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">fulfilled</span><span class="token punctuation" style="color:#F8F8F2">]</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      state</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">push</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token spread operator" style="color:#F8F8F2">...</span><span class="token plain">action</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">payload</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token comment" style="color:#c6cad2">// Sort with newest first</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      state</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">sort</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">a</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> b</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> b</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">date</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">localeCompare</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">a</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">date</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">default</span><span class="token plain"> notificationsSlice</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">reducer</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#E6D874">selectAllNotifications</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token parameter">state</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> state</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">notifications</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>å’Œå…¶ä»–çš„åˆ‡ç‰‡ä¸€æ ·ï¼Œå°† <code>notificationsReducer</code> å¼•å…¥ <code>store.js</code>ï¼Œ å¹¶å°†å…¶æ·»åŠ åˆ° <code>configureStore()</code> çš„è°ƒç”¨ä¸­ã€‚</p><p>æˆ‘ä»¬ç¼–å†™äº†ä¸€ä¸ªåä¸º <code>fetchNotifications</code> çš„å¼‚æ­¥é€šçŸ¥ï¼Œå®ƒå°†ä»æœåŠ¡å™¨æ£€ç´¢æ–°é€šçŸ¥åˆ—è¡¨ã€‚ä½œä¸ºå…¶ä¸­çš„ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬å¸Œæœ›å°†æœ€æ–°é€šçŸ¥çš„åˆ›å»ºæ—¶é—´æˆ³ä½œä¸ºè¯·æ±‚çš„ä¸€éƒ¨åˆ†ï¼Œä»¥ä¾¿æœåŠ¡å™¨çŸ¥é“å®ƒåº”è¯¥åªè¿”å›å®é™…ä¸Šæ›´æ–°çš„é€šçŸ¥ã€‚</p><p>æˆ‘ä»¬çŸ¥é“å°†è¿”å›ä¸€ä¸ªé€šçŸ¥æ•°ç»„ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å°†å®ƒä»¬ä½œä¸ºå•ç‹¬çš„å‚æ•°ä¼ é€’ç»™ <code>state.push()</code> ï¼Œæ•°ç»„å°†æ·»åŠ æ¯ä¸ªæ¡ç›®ã€‚ä¸ºäº†é˜²æ­¢æœåŠ¡å™¨å°†å®ƒä»¬ä¹±åºå‘é€ï¼Œæˆ‘ä»¬è¿˜æƒ³ç¡®ä¿å®ƒä»¬è¿›è¡Œäº†æ’åºï¼Œä»¥ä¾¿æœ€è¿‘çš„é€šçŸ¥åœ¨æ•°ç»„ä¸­çš„æœ€åä¸€ä¸ªã€‚ ï¼ˆæé†’ä¸€ä¸‹ï¼Œ<code>array.sort()</code> æ€»æ˜¯ä¼šæ”¹å˜ç°æœ‰çš„æ•°ç»„â€”â€”è¿™æ˜¯å®‰å…¨çš„ï¼Œå› ä¸ºæˆ‘ä»¬æ˜¯åœ¨ <code>createSlice</code> å’Œ Immer å†…ä½¿ç”¨ã€‚ï¼‰</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="thunk-å‚æ•°"></a>Thunk å‚æ•°<a class="hash-link" href="#thunk-å‚æ•°" title="Direct link to heading">#</a></h3><p>çœ‹çœ‹æˆ‘ä»¬çš„ <code>fetchNotifications</code> thunkï¼Œå®ƒæœ‰ä¸€äº›æˆ‘ä»¬ä»¥å‰æ²¡è§è¿‡çš„æ–°ä¸œè¥¿ã€‚è®©æˆ‘ä»¬èŠ±ç‚¹æ—¶é—´æ¥è®¨è®ºä¸€ä¸‹ thunk å‚æ•°ã€‚</p><p>æˆ‘ä»¬å·²ç»çœ‹åˆ°ï¼Œå½“æˆ‘ä»¬å‘é€å®ƒæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å°†å‚æ•°ä¼ é€’ç»™ thunk action çš„åˆ›å»ºè€…ï¼Œä¾‹å¦‚ <code>dispatch(addPost(newPost))</code>ã€‚ç‰¹åˆ«æ˜¯ <code>createAsyncThunk</code>ï¼Œåªèƒ½ä¼ é€’ä¸€ä¸ªå‚æ•°ï¼Œæ— è®ºæˆ‘ä»¬ä¼ å…¥çš„æ˜¯ä»€ä¹ˆï¼Œå®ƒéƒ½å°†æˆä¸º payload creation å›è°ƒçš„ç¬¬ä¸€ä¸ªå‚æ•°ã€‚</p><p>payload creator çš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ª&#x27; thunkAPI &#x27;å¯¹è±¡ï¼ŒåŒ…å«å‡ ä¸ªæœ‰ç”¨çš„å‡½æ•°å’Œä¿¡æ¯ï¼š</p><ul><li><code>dispatch</code> å’Œ <code>getState</code>ï¼š<code>dispatch</code> å’Œ <code>getState</code> æ–¹æ³•ç”± Redux store æä¾›ã€‚æ‚¨å¯ä»¥åœ¨ thunk ä¸­ä½¿ç”¨è¿™äº›æ¥å‘èµ· actionï¼Œæˆ–è€…ä»æœ€æ–°çš„ Redux store ä¸­è·å– state ï¼ˆä¾‹å¦‚åœ¨å‘èµ· å¦ä¸€ä¸ª action åè·å–æ›´æ–°åçš„å€¼ï¼‰ã€‚</li><li><code>extra</code>ï¼šå½“åˆ›å»º store æ—¶ï¼Œç”¨äºä¼ é€’ç»™ thunk ä¸­é—´ä»¶çš„â€œé¢å¤–å‚æ•°â€ã€‚è¿™é€šå¸¸æ—¶æŸç§ API çš„åŒ…è£…å™¨ï¼Œæ¯”å¦‚ä¸€ç»„çŸ¥é“å¦‚ä½•å¯¹åº”ç”¨ç¨‹åºçš„æœåŠ¡å™¨è¿›è¡Œ API è°ƒç”¨å¹¶è¿”å›æ•°æ®çš„å‡½æ•°ï¼Œè¿™æ ·æ‚¨çš„ thunk å°±ä¸å¿…ç›´æ¥åŒ…å«æ‰€æœ‰çš„ URL å’ŒæŸ¥è¯¢é€»è¾‘ã€‚</li><li><code>requestId</code>ï¼šè¯¥ thunk è°ƒç”¨çš„å”¯ä¸€éšæœº ID ï¼Œç”¨äºè·Ÿè¸ªå•ä¸ªè¯·æ±‚çš„çŠ¶æ€ã€‚</li><li><code>signal</code>ï¼šä¸€ä¸ª<code>AbortController.signal</code> å‡½æ•°ï¼Œå¯ç”¨äºå–æ¶ˆæ­£åœ¨è¿›è¡Œçš„è¯·æ±‚ã€‚</li><li><code>rejectWithValue</code>ï¼šä¸€ä¸ªç”¨äºå½“ thunk æ”¶åˆ°ä¸€ä¸ªé”™è¯¯æ—¶å¸®åŠ©è‡ªå®šä¹‰ <code>rejected</code> action å†…å®¹çš„å·¥å…·ã€‚</li></ul><p>ï¼ˆå¦‚æœæ‚¨è¦æ‰‹å†™ thunk è€Œä¸æ˜¯ä½¿ç”¨ <code>createAsyncThunk</code>ï¼Œåˆ™ thunk å‡½æ•°å°†è·å– <code>(dispatch, getState)</code> ä½œä¸ºå•ç‹¬çš„å‚æ•°ï¼Œè€Œä¸æ˜¯å°†ä»–ä»¬æ”¾åœ¨ä¸€ä¸ªå¯¹è±¡ä¸­ã€‚ï¼‰</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>è¯´æ˜</h5></div><div class="admonition-content"><p>æœ‰å…³è¿™äº›å‚æ•°ä»¥åŠå¦‚ä½•å¤„ç†å–æ¶ˆ thunk å’Œè¯·æ±‚çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹ <a href="https://redux-toolkit.js.org/api/createAsyncThunk" target="_blank" rel="noopener noreferrer"><code>createAsyncThunk</code> API å‚è€ƒé¡µ</a>.</p></div></div><p>åœ¨æœ¬ä¾‹ä¸­ï¼Œæˆ‘ä»¬çŸ¥é“é€šçŸ¥åˆ—è¡¨å­˜å‚¨åœ¨æˆ‘ä»¬ Redux store çš„ state ä¸­ï¼Œå¹¶ä¸”æœ€æ–°çš„é€šçŸ¥åº”è¯¥åœ¨æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªã€‚æˆ‘ä»¬å¯ä»¥ä» thunkAPI å¯¹è±¡ä¸­è§£æ„ getState å‡½æ•°ï¼Œè°ƒç”¨å®ƒæ¥è¯»å– state å€¼ï¼Œå¹¶ä½¿ç”¨ selectAllNotifications é€‰æ‹©å™¨ä¸ºæˆ‘ä»¬æä¾›é€šçŸ¥æ•°ç»„ã€‚ç”±äºé€šçŸ¥æ•°ç»„æŒ‰æœ€æ–°è¿›è¡Œäº†æ’åºï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ•°ç»„è§£æ„æ¥è·å–æœ€æ–°çš„é€šçŸ¥ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="æ·»åŠ é€šçŸ¥åˆ—è¡¨"></a>æ·»åŠ é€šçŸ¥åˆ—è¡¨<a class="hash-link" href="#æ·»åŠ é€šçŸ¥åˆ—è¡¨" title="Direct link to heading">#</a></h3><p>åˆ›å»ºåˆ‡ç‰‡ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥æ·»åŠ ä¸€ä¸ª <code>&lt;NotificationsList&gt;</code> ç»„ä»¶ï¼š</p><div class="codeBlockContainer_J+bg"><div style="color:#f8f8f2;background-color:#272822" class="codeBlockTitle_oQzk">features/notifications/NotificationsList.js</div><div class="codeBlockContent_csEI jsx"><div tabindex="0" class="prism-code language-jsx codeBlock_rtdJ thin-scrollbar codeBlockWithTitle_ZT05"><div class="codeBlockLines_1zSZ" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token imports maybe-class-name">React</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;react&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#F8F8F2">{</span><span class="token imports"> useSelector </span><span class="token imports punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;react-redux&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#F8F8F2">{</span><span class="token imports"> formatDistanceToNow</span><span class="token imports punctuation" style="color:#F8F8F2">,</span><span class="token imports"> parseISO </span><span class="token imports punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;date-fns&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#F8F8F2">{</span><span class="token imports"> selectAllUsers </span><span class="token imports punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;../users/usersSlice&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#F8F8F2">{</span><span class="token imports"> selectAllNotifications </span><span class="token imports punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;./notificationsSlice&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function maybe-class-name" style="color:#E6D874">NotificationsList</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> notifications </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">useSelector</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">selectAllNotifications</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> users </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">useSelector</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">selectAllUsers</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> renderedNotifications </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> notifications</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">map</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">notification</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> date </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">parseISO</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">notification</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">date</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> timeAgo </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">formatDistanceToNow</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">date</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> user </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> users</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">find</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">user</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> user</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">id</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">===</span><span class="token plain"> notification</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">user</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">||</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token literal-property property" style="color:#F92672">name</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;Unknown User&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#F92672">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token tag punctuation" style="color:#F8F8F2">&lt;</span><span class="token tag" style="color:#F92672">div</span><span class="token tag" style="color:#F92672"> </span><span class="token tag attr-name" style="color:#a6e22e">key</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#F8F8F2">=</span><span class="token tag script language-javascript punctuation" style="color:#F8F8F2">{</span><span class="token tag script language-javascript" style="color:#F92672">notification</span><span class="token tag script language-javascript punctuation" style="color:#F8F8F2">.</span><span class="token tag script language-javascript property-access" style="color:#F92672">id</span><span class="token tag script language-javascript punctuation" style="color:#F8F8F2">}</span><span class="token tag" style="color:#F92672"> </span><span class="token tag attr-name" style="color:#a6e22e">className</span><span class="token tag attr-value punctuation attr-equals" style="color:#F8F8F2">=</span><span class="token tag attr-value punctuation" style="color:#F8F8F2">&quot;</span><span class="token tag attr-value" style="color:#E6D874">notification</span><span class="token tag attr-value punctuation" style="color:#F8F8F2">&quot;</span><span class="token tag punctuation" style="color:#F8F8F2">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain-text">        </span><span class="token tag punctuation" style="color:#F8F8F2">&lt;</span><span class="token tag" style="color:#F92672">div</span><span class="token tag punctuation" style="color:#F8F8F2">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain-text">          </span><span class="token tag punctuation" style="color:#F8F8F2">&lt;</span><span class="token tag" style="color:#F92672">b</span><span class="token tag punctuation" style="color:#F8F8F2">&gt;</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain">user</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">name</span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token tag punctuation" style="color:#F8F8F2">&lt;/</span><span class="token tag" style="color:#F92672">b</span><span class="token tag punctuation" style="color:#F8F8F2">&gt;</span><span class="token plain-text"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain">notification</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">message</span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain-text"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain-text">        </span><span class="token tag punctuation" style="color:#F8F8F2">&lt;/</span><span class="token tag" style="color:#F92672">div</span><span class="token tag punctuation" style="color:#F8F8F2">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain-text">        </span><span class="token tag punctuation" style="color:#F8F8F2">&lt;</span><span class="token tag" style="color:#F92672">div</span><span class="token tag" style="color:#F92672"> </span><span class="token tag attr-name" style="color:#a6e22e">title</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#F8F8F2">=</span><span class="token tag script language-javascript punctuation" style="color:#F8F8F2">{</span><span class="token tag script language-javascript" style="color:#F92672">notification</span><span class="token tag script language-javascript punctuation" style="color:#F8F8F2">.</span><span class="token tag script language-javascript property-access" style="color:#F92672">date</span><span class="token tag script language-javascript punctuation" style="color:#F8F8F2">}</span><span class="token tag punctuation" style="color:#F8F8F2">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain-text">          </span><span class="token tag punctuation" style="color:#F8F8F2">&lt;</span><span class="token tag" style="color:#F92672">i</span><span class="token tag punctuation" style="color:#F8F8F2">&gt;</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain">timeAgo</span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain-text"> ago</span><span class="token tag punctuation" style="color:#F8F8F2">&lt;/</span><span class="token tag" style="color:#F92672">i</span><span class="token tag punctuation" style="color:#F8F8F2">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain-text">        </span><span class="token tag punctuation" style="color:#F8F8F2">&lt;/</span><span class="token tag" style="color:#F92672">div</span><span class="token tag punctuation" style="color:#F8F8F2">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain-text">      </span><span class="token tag punctuation" style="color:#F8F8F2">&lt;/</span><span class="token tag" style="color:#F92672">div</span><span class="token tag punctuation" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#F92672">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token tag punctuation" style="color:#F8F8F2">&lt;</span><span class="token tag" style="color:#F92672">section</span><span class="token tag" style="color:#F92672"> </span><span class="token tag attr-name" style="color:#a6e22e">className</span><span class="token tag attr-value punctuation attr-equals" style="color:#F8F8F2">=</span><span class="token tag attr-value punctuation" style="color:#F8F8F2">&quot;</span><span class="token tag attr-value" style="color:#E6D874">notificationsList</span><span class="token tag attr-value punctuation" style="color:#F8F8F2">&quot;</span><span class="token tag punctuation" style="color:#F8F8F2">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain-text">      </span><span class="token tag punctuation" style="color:#F8F8F2">&lt;</span><span class="token tag" style="color:#F92672">h2</span><span class="token tag punctuation" style="color:#F8F8F2">&gt;</span><span class="token plain-text">Notifications</span><span class="token tag punctuation" style="color:#F8F8F2">&lt;/</span><span class="token tag" style="color:#F92672">h2</span><span class="token tag punctuation" style="color:#F8F8F2">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain-text">      </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain">renderedNotifications</span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain-text"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:#F8F8F2">&lt;/</span><span class="token tag" style="color:#F92672">section</span><span class="token tag punctuation" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>åŒæ ·ï¼Œæˆ‘ä»¬ä» Redux state ä¸­è¯»å–é¡¹ç›®åˆ—è¡¨ï¼Œå¯¹å®ƒä»¬è¿›è¡Œæ˜ å°„ï¼Œç»™æ¯ä¸ªé¡¹ç›®æ¸²æŸ“å†…å®¹ã€‚</p><p>æˆ‘ä»¬è¿˜éœ€è¦åœ¨ <code>&lt;Navbar&gt;</code> ä¸­æ·»åŠ ä¸€ä¸ªâ€œé€šçŸ¥â€ tabï¼Œä»¥åŠç”¨äºè·å–ä¸€äº›é€šçŸ¥çš„æ–°æŒ‰é’®ï¼š</p><div class="codeBlockContainer_J+bg"><div style="color:#f8f8f2;background-color:#272822" class="codeBlockTitle_oQzk">app/Navbar.js</div><div class="codeBlockContent_csEI jsx"><div tabindex="0" class="prism-code language-jsx codeBlock_rtdJ thin-scrollbar codeBlockWithTitle_ZT05"><div class="codeBlockLines_1zSZ" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token imports maybe-class-name">React</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;react&#x27;</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#F8F8F2">{</span><span class="token imports"> useDispatch </span><span class="token imports punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;react-redux&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#F8F8F2">{</span><span class="token imports"> </span><span class="token imports maybe-class-name">Link</span><span class="token imports"> </span><span class="token imports punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;react-router-dom&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#F8F8F2">{</span><span class="token imports"> fetchNotifications </span><span class="token imports punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;../features/notifications/notificationsSlice&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function maybe-class-name" style="color:#E6D874">Navbar</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> dispatch </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">useDispatch</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#E6D874">fetchNewNotifications</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token function" style="color:#E6D874">dispatch</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token function" style="color:#E6D874">fetchNotifications</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#F92672">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token tag punctuation" style="color:#F8F8F2">&lt;</span><span class="token tag" style="color:#F92672">nav</span><span class="token tag punctuation" style="color:#F8F8F2">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain-text">      </span><span class="token tag punctuation" style="color:#F8F8F2">&lt;</span><span class="token tag" style="color:#F92672">section</span><span class="token tag punctuation" style="color:#F8F8F2">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain-text">        </span><span class="token tag punctuation" style="color:#F8F8F2">&lt;</span><span class="token tag" style="color:#F92672">h1</span><span class="token tag punctuation" style="color:#F8F8F2">&gt;</span><span class="token plain-text">Redux Essentials Example</span><span class="token tag punctuation" style="color:#F8F8F2">&lt;/</span><span class="token tag" style="color:#F92672">h1</span><span class="token tag punctuation" style="color:#F8F8F2">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain-text" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain-text">        </span><span class="token tag punctuation" style="color:#F8F8F2">&lt;</span><span class="token tag" style="color:#F92672">div</span><span class="token tag" style="color:#F92672"> </span><span class="token tag attr-name" style="color:#a6e22e">className</span><span class="token tag attr-value punctuation attr-equals" style="color:#F8F8F2">=</span><span class="token tag attr-value punctuation" style="color:#F8F8F2">&quot;</span><span class="token tag attr-value" style="color:#E6D874">navContent</span><span class="token tag attr-value punctuation" style="color:#F8F8F2">&quot;</span><span class="token tag punctuation" style="color:#F8F8F2">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain-text">          </span><span class="token tag punctuation" style="color:#F8F8F2">&lt;</span><span class="token tag" style="color:#F92672">div</span><span class="token tag" style="color:#F92672"> </span><span class="token tag attr-name" style="color:#a6e22e">className</span><span class="token tag attr-value punctuation attr-equals" style="color:#F8F8F2">=</span><span class="token tag attr-value punctuation" style="color:#F8F8F2">&quot;</span><span class="token tag attr-value" style="color:#E6D874">navLinks</span><span class="token tag attr-value punctuation" style="color:#F8F8F2">&quot;</span><span class="token tag punctuation" style="color:#F8F8F2">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain-text">            </span><span class="token tag punctuation" style="color:#F8F8F2">&lt;</span><span class="token tag class-name" style="color:#F92672">Link</span><span class="token tag" style="color:#F92672"> </span><span class="token tag attr-name" style="color:#a6e22e">to</span><span class="token tag attr-value punctuation attr-equals" style="color:#F8F8F2">=</span><span class="token tag attr-value punctuation" style="color:#F8F8F2">&quot;</span><span class="token tag attr-value" style="color:#E6D874">/</span><span class="token tag attr-value punctuation" style="color:#F8F8F2">&quot;</span><span class="token tag punctuation" style="color:#F8F8F2">&gt;</span><span class="token plain-text">Posts</span><span class="token tag punctuation" style="color:#F8F8F2">&lt;/</span><span class="token tag class-name" style="color:#F92672">Link</span><span class="token tag punctuation" style="color:#F8F8F2">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain-text">            </span><span class="token tag punctuation" style="color:#F8F8F2">&lt;</span><span class="token tag class-name" style="color:#F92672">Link</span><span class="token tag" style="color:#F92672"> </span><span class="token tag attr-name" style="color:#a6e22e">to</span><span class="token tag attr-value punctuation attr-equals" style="color:#F8F8F2">=</span><span class="token tag attr-value punctuation" style="color:#F8F8F2">&quot;</span><span class="token tag attr-value" style="color:#E6D874">/users</span><span class="token tag attr-value punctuation" style="color:#F8F8F2">&quot;</span><span class="token tag punctuation" style="color:#F8F8F2">&gt;</span><span class="token plain-text">Users</span><span class="token tag punctuation" style="color:#F8F8F2">&lt;/</span><span class="token tag class-name" style="color:#F92672">Link</span><span class="token tag punctuation" style="color:#F8F8F2">&gt;</span><span class="token plain-text"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain-text">            </span><span class="token tag punctuation" style="color:#F8F8F2">&lt;</span><span class="token tag class-name" style="color:#F92672">Link</span><span class="token tag" style="color:#F92672"> </span><span class="token tag attr-name" style="color:#a6e22e">to</span><span class="token tag attr-value punctuation attr-equals" style="color:#F8F8F2">=</span><span class="token tag attr-value punctuation" style="color:#F8F8F2">&quot;</span><span class="token tag attr-value" style="color:#E6D874">/notifications</span><span class="token tag attr-value punctuation" style="color:#F8F8F2">&quot;</span><span class="token tag punctuation" style="color:#F8F8F2">&gt;</span><span class="token plain-text">Notifications</span><span class="token tag punctuation" style="color:#F8F8F2">&lt;/</span><span class="token tag class-name" style="color:#F92672">Link</span><span class="token tag punctuation" style="color:#F8F8F2">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain-text">          </span><span class="token tag punctuation" style="color:#F8F8F2">&lt;/</span><span class="token tag" style="color:#F92672">div</span><span class="token tag punctuation" style="color:#F8F8F2">&gt;</span><span class="token plain-text"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain-text">          </span><span class="token tag punctuation" style="color:#F8F8F2">&lt;</span><span class="token tag" style="color:#F92672">button</span><span class="token tag" style="color:#F92672"> </span><span class="token tag attr-name" style="color:#a6e22e">className</span><span class="token tag attr-value punctuation attr-equals" style="color:#F8F8F2">=</span><span class="token tag attr-value punctuation" style="color:#F8F8F2">&quot;</span><span class="token tag attr-value" style="color:#E6D874">button</span><span class="token tag attr-value punctuation" style="color:#F8F8F2">&quot;</span><span class="token tag" style="color:#F92672"> </span><span class="token tag attr-name" style="color:#a6e22e">onClick</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#F8F8F2">=</span><span class="token tag script language-javascript punctuation" style="color:#F8F8F2">{</span><span class="token tag script language-javascript" style="color:#F92672">fetchNewNotifications</span><span class="token tag script language-javascript punctuation" style="color:#F8F8F2">}</span><span class="token tag punctuation" style="color:#F8F8F2">&gt;</span><span class="token plain-text"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain-text">            Refresh Notifications</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain-text">          </span><span class="token tag punctuation" style="color:#F8F8F2">&lt;/</span><span class="token tag" style="color:#F92672">button</span><span class="token tag punctuation" style="color:#F8F8F2">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain-text">        </span><span class="token tag punctuation" style="color:#F8F8F2">&lt;/</span><span class="token tag" style="color:#F92672">div</span><span class="token tag punctuation" style="color:#F8F8F2">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain-text">      </span><span class="token tag punctuation" style="color:#F8F8F2">&lt;/</span><span class="token tag" style="color:#F92672">section</span><span class="token tag punctuation" style="color:#F8F8F2">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:#F8F8F2">&lt;/</span><span class="token tag" style="color:#F92672">nav</span><span class="token tag punctuation" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>æœ€åï¼Œæˆ‘ä»¬åœ¨ <code>App.js</code>ä¸­æ·»åŠ â€œé€šçŸ¥â€è·¯ç”±ï¼Œä»¥ä¾¿æˆ‘ä»¬å¯ä»¥å¯¼èˆªåˆ°å®ƒï¼š</p><div class="codeBlockContainer_J+bg"><div style="color:#f8f8f2;background-color:#272822" class="codeBlockTitle_oQzk">App.js</div><div class="codeBlockContent_csEI js"><div tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar codeBlockWithTitle_ZT05"><div class="codeBlockLines_1zSZ" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#c6cad2">// omit imports</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#F8F8F2">{</span><span class="token imports"> </span><span class="token imports maybe-class-name">NotificationsList</span><span class="token imports"> </span><span class="token imports punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;./features/notifications/NotificationsList&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">function</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#E6D874">App</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#F92672">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token maybe-class-name">Router</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token maybe-class-name">Navbar</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">/</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token plain">div className</span><span class="token operator" style="color:#F8F8F2">=</span><span class="token string" style="color:#a6e22e">&quot;App&quot;</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token maybe-class-name">Switch</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">          </span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token maybe-class-name">Route</span><span class="token plain"> exact path</span><span class="token operator" style="color:#F8F8F2">=</span><span class="token string" style="color:#a6e22e">&quot;/notifications&quot;</span><span class="token plain"> component</span><span class="token operator" style="color:#F8F8F2">=</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token maybe-class-name">NotificationsList</span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">/</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">          </span><span class="token comment" style="color:#c6cad2">// omit existing routes</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">          </span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token maybe-class-name">Redirect</span><span class="token plain"> to</span><span class="token operator" style="color:#F8F8F2">=</span><span class="token string" style="color:#a6e22e">&quot;/&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">/</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token operator" style="color:#F8F8F2">/</span><span class="token maybe-class-name">Switch</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token operator" style="color:#F8F8F2">/</span><span class="token plain">div</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token operator" style="color:#F8F8F2">/</span><span class="token maybe-class-name">Router</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œâ€œé€šçŸ¥â€ tab å¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img alt="Initial Notifications tab" src="/assets/images/notifications-initial-78eeb6d749f8287ebebe6a8b4e28efae.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="æ˜¾ç¤ºæ–°é€šçŸ¥"></a>æ˜¾ç¤ºæ–°é€šçŸ¥<a class="hash-link" href="#æ˜¾ç¤ºæ–°é€šçŸ¥" title="Direct link to heading">#</a></h3><p>æˆ‘ä»¬æ¯æ¬¡å•å‡»â€œåˆ·æ–°é€šçŸ¥â€æ—¶ï¼Œéƒ½ä¼šåœ¨æˆ‘ä»¬çš„åˆ—è¡¨ä¸­æ·»åŠ æ›´å¤šçš„é€šçŸ¥æ¡ç›®ã€‚åœ¨ä¸€ä¸ªçœŸå®çš„åº”ç”¨ç¨‹åºä¸­ï¼Œå½“æˆ‘ä»¬æŸ¥çœ‹ UI çš„å…¶ä»–éƒ¨åˆ†æ—¶ï¼Œè¿™äº›æ•°æ®å¯èƒ½å–è‡ªæœåŠ¡å™¨ã€‚åœ¨æµè§ˆ <code>&lt;PostsList&gt;</code> æˆ– <code>&lt;UserPage&gt;</code> æ—¶æˆ‘ä»¬å¯ä»¥é€šè¿‡å•å‡»â€œåˆ·æ–°é€šçŸ¥â€æ¥æ‰§è¡Œç±»ä¼¼çš„æ“ä½œã€‚ä½†æ˜¯ï¼Œç°åœ¨æˆ‘ä»¬ä¸çŸ¥é“åˆšæ”¶åˆ°å¤šå°‘é€šçŸ¥ï¼Œå¦‚æœæˆ‘ä»¬ç»§ç»­ç‚¹å‡»æŒ‰é’®ï¼Œå¯èƒ½ä¼šæœ‰å¾ˆå¤šé€šçŸ¥æˆ‘ä»¬è¿˜æ²¡æœ‰é˜…è¯»ã€‚è®©æˆ‘ä»¬æ·»åŠ ä¸€äº›é€»è¾‘æ¥è·Ÿè¸ªå“ªäº›é€šçŸ¥æ˜¯å·²ç»é˜…è¯»çš„ä»¥åŠå“ªäº›é€šçŸ¥æ˜¯â€œæ–°çš„â€ã€‚è®©æˆ‘ä»¬åœ¨å¯¼èˆªæ ä¸­çš„â€œé€šçŸ¥â€ tab ä¸Šå°†â€œæœªè¯»â€é€šçŸ¥çš„è®¡æ•°æ˜¾ç¤ºä¸ºå¾½ç« ï¼Œå¹¶ä»¥ä¸åŒçš„é¢œè‰²æ˜¾ç¤ºæ–°é€šçŸ¥ã€‚</p><p>æˆ‘ä»¬çš„è™šå‡ API è¿”å›çš„é€šçŸ¥æ¡ç›®å¸¦æœ‰ <code>isNew</code> å’Œ <code>read</code> å­—æ®µï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä»£ç ä¸­ä½¿ç”¨è¿™äº›å€¼ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬å°†æ›´æ–° <code>notificationsSlice</code>ï¼Œ æ·»åŠ ä¸€ä¸ªå°†æ‰€æœ‰é€šçŸ¥æ ‡è®°ä¸ºå·²è¯»çš„ reducerï¼Œä»¥åŠä¸€äº›å°†ç°æœ‰é€šçŸ¥æ ‡è®°ä¸ºâ€œéæ–°â€çš„é€»è¾‘ï¼š</p><div class="codeBlockContainer_J+bg"><div style="color:#f8f8f2;background-color:#272822" class="codeBlockTitle_oQzk">features/notifications/notificationsSlice.js</div><div class="codeBlockContent_csEI js"><div tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar codeBlockWithTitle_ZT05"><div class="codeBlockLines_1zSZ" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> notificationsSlice </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">createSlice</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token literal-property property" style="color:#F92672">name</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;notifications&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token literal-property property" style="color:#F92672">initialState</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">[</span><span class="token punctuation" style="color:#F8F8F2">]</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token literal-property property" style="color:#F92672">reducers</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token function" style="color:#E6D874">allNotificationsRead</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">      state</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">forEach</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">notification</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">        notification</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">read</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token boolean" style="color:#AE81FF">true</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token literal-property property" style="color:#F92672">extraReducers</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">[</span><span class="token plain">fetchNotifications</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">fulfilled</span><span class="token punctuation" style="color:#F8F8F2">]</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">      state</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">forEach</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">notification</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token comment" style="color:#c6cad2">// Any notifications we&#x27;ve read are no longer new</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">        notification</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">isNew</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">!</span><span class="token plain">notification</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">read</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      state</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">push</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token spread operator" style="color:#F8F8F2">...</span><span class="token plain">action</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">payload</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token comment" style="color:#c6cad2">// Sort with newest first</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      state</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">sort</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">a</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> b</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> b</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">date</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">localeCompare</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">a</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">date</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> allNotificationsRead </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> notificationsSlice</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">actions</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">default</span><span class="token plain"> notificationsSlice</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">reducer</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>åœ¨å±•ç¤º <code>&lt;NotificationsList&gt;</code> ç»„ä»¶æ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›å°†è¿™äº›é€šçŸ¥æ ‡è®°ä¸ºå·²è¯»ï¼Œå› ä¸ºæˆ‘ä»¬ç‚¹å‡» tab æŸ¥çœ‹äº†è¿™äº›é€šçŸ¥ï¼Œæˆ–è€…å› ä¸ºæˆ‘ä»¬å·²ç»æ‰“å¼€å®ƒå¹¶æ”¶åˆ°äº†ä¸€äº›å…¶å®ƒçš„é€šçŸ¥ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨è¯¥ç»„ä»¶é‡æ–°æ¸²æŸ“çš„æ—¶å€™è°ƒç”¨ <code>allNotificationsRead</code> æ¥å®ç°è¿™å°†é€šçŸ¥æ•°æ®æ ‡è®°ä¸ºå·²è¯»ã€‚ä¸ºäº†é¿å…åœ¨æ›´æ–°æ—¶åˆ·æ–°æ—§æ•°æ®ï¼Œæˆ‘ä»¬å°†åœ¨ <code>useLayoutEffect</code> é’©å­ä¸­æ‰§è¡Œè¯¥æ“ä½œã€‚æˆ‘ä»¬è¿˜æƒ³ä¸ºé¡µé¢ä¸­çš„æ‰€æœ‰é€šçŸ¥åˆ—è¡¨æ¡ç›®æ·»åŠ ä¸€ä¸ªé¢å¤–çš„ç±»åï¼Œç”¨æ¥çªå‡ºæ˜¾ç¤ºå®ƒä»¬ï¼š</p><div class="codeBlockContainer_J+bg"><div style="color:#f8f8f2;background-color:#272822" class="codeBlockTitle_oQzk">features/notifications/NotificationsList.js</div><div class="codeBlockContent_csEI js"><div tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar codeBlockWithTitle_ZT05"><div class="codeBlockLines_1zSZ" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token imports maybe-class-name">React</span><span class="token imports punctuation" style="color:#F8F8F2">,</span><span class="token imports"> </span><span class="token imports punctuation" style="color:#F8F8F2">{</span><span class="token imports"> useEffect </span><span class="token imports punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;react&#x27;</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#F8F8F2">{</span><span class="token imports"> useSelector</span><span class="token imports punctuation" style="color:#F8F8F2">,</span><span class="token imports"> useDispatch </span><span class="token imports punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;react-redux&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#F8F8F2">{</span><span class="token imports"> formatDistanceToNow</span><span class="token imports punctuation" style="color:#F8F8F2">,</span><span class="token imports"> parseISO </span><span class="token imports punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;date-fns&#x27;</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token imports">classnames</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;classnames&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#F8F8F2">{</span><span class="token imports"> selectAllUsers </span><span class="token imports punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;../users/usersSlice&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#F8F8F2">{</span><span class="token imports"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token imports">  selectAllNotifications</span><span class="token imports punctuation" style="color:#F8F8F2">,</span><span class="token imports"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token imports">  allNotificationsRead</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token imports"></span><span class="token imports punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;./notificationsSlice&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function maybe-class-name" style="color:#E6D874">NotificationsList</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> dispatch </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">useDispatch</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> notifications </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">useSelector</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">selectAllNotifications</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> users </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">useSelector</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">selectAllUsers</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token function" style="color:#E6D874">useEffect</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token function" style="color:#E6D874">dispatch</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token function" style="color:#E6D874">allNotificationsRead</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> renderedNotifications </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> notifications</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">map</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">notification</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> date </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">parseISO</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">notification</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">date</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> timeAgo </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">formatDistanceToNow</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">date</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> user </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> users</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">find</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">user</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> user</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">id</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">===</span><span class="token plain"> notification</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">user</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">||</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token literal-property property" style="color:#F92672">name</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;Unknown User&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> notificationClassname </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">classnames</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;notification&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token keyword" style="color:#F92672">new</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> notification</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">isNew</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#F92672">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token plain">div key</span><span class="token operator" style="color:#F8F8F2">=</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain">notification</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">id</span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> className</span><span class="token operator" style="color:#F8F8F2">=</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain">notificationClassname</span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token plain">div</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">          </span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token plain">b</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain">user</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">name</span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token operator" style="color:#F8F8F2">/</span><span class="token plain">b</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain">notification</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">message</span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token operator" style="color:#F8F8F2">/</span><span class="token plain">div</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token plain">div title</span><span class="token operator" style="color:#F8F8F2">=</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain">notification</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">date</span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">          </span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token plain">i</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain">timeAgo</span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> ago</span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token operator" style="color:#F8F8F2">/</span><span class="token plain">i</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token operator" style="color:#F8F8F2">/</span><span class="token plain">div</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token operator" style="color:#F8F8F2">/</span><span class="token plain">div</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#F92672">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token plain">section className</span><span class="token operator" style="color:#F8F8F2">=</span><span class="token string" style="color:#a6e22e">&quot;notificationsList&quot;</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token plain">h2</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token maybe-class-name">Notifications</span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token operator" style="color:#F8F8F2">/</span><span class="token plain">h2</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain">renderedNotifications</span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token operator" style="color:#F8F8F2">/</span><span class="token plain">section</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>è¿™æ˜¯å¯è¡Œçš„ï¼Œä½†å®é™…ä¸Šæœ‰ä¸€äº›ä»¤äººæƒŠè®¶çš„è¡Œä¸ºã€‚æ¯å½“æœ‰æ–°çš„é€šçŸ¥ï¼ˆå› ä¸ºæˆ‘ä»¬åˆ‡æ¢åˆ°è¿™ä¸ª tabï¼Œæˆ–è€…é€šè¿‡ API è·å–ä¸€äº›æ–°çš„é€šçŸ¥ï¼‰ï¼Œå®é™…ä¸Šï¼Œä½ ä¼šçœ‹åˆ°å‘èµ·äº†ä¸¤æ¬¡ <code>&quot;notifications/allNotificationsRead&quot;</code>ã€‚ è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p><p>å‡è®¾æˆ‘ä»¬åœ¨æŸ¥çœ‹ <code>&lt;PostsList&gt;</code> æ—¶è·å–äº†ä¸€äº›é€šçŸ¥ï¼Œç„¶åå•å‡»â€œé€šçŸ¥â€ tab ã€‚ <code>&lt;NotificationsList&gt;</code> ç»„ä»¶å°†è¢«æŒ‚è½½ï¼Œ<code>useEffect</code> å›è°ƒå°†åœ¨ç¬¬ä¸€æ¬¡æ¸²æŸ“å’Œå‘èµ·<code>allNotificationsRead</code> ä¹‹åè¿è¡Œã€‚ æˆ‘ä»¬çš„ <code>notificationsSlice</code> å°†é€šè¿‡æ›´æ–° store ä¸­çš„é€šçŸ¥æ¡ç›®æ¥å“åº”è¿™ä¸€è¿‡ç¨‹ã€‚ è¿™ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ <code>state.notifications</code> æ•°ç»„ï¼Œå…¶ä¸­åŒ…å«ä¸å¯å˜æ›´æ–°çš„æ¡ç›®ï¼Œå› ä¸ºç»„ä»¶è§‚å¯Ÿåˆ°ä» <code>useSelector</code> è¿”å›äº†æ–°çš„æ•°ç»„ï¼Œè¿™ä¼šå¯¼è‡´ç»„ä»¶å†æ¬¡æ¸²æŸ“ï¼Œä»è€Œå†æ¬¡è§¦å‘ <code>useEffect</code> é’©å­å¹¶å†æ¬¡å‘èµ·<code>allNotificationsRead</code>ã€‚reducer ä¹Ÿå°†å†æ¬¡è¿è¡Œï¼Œä½†è¿™æ¬¡å¹¶æ²¡æœ‰æ•°æ®æ›´æ–°ï¼Œå› æ­¤ç»„ä»¶ä¸ä¼šé‡æ–°æ¸²æŸ“ã€‚</p><p>æœ‰å‡ ç§æ–¹æ³•å¯ä»¥é¿å…äºŒæ¬¡å‘èµ·ï¼Œä¾‹å¦‚é€šè¿‡æ‹†åˆ†ç»„ä»¶æŒ‚è½½æ—¶çš„é€»è¾‘ç¡®ä¿åªå‘èµ·ä¸€æ¬¡ï¼Œå¹¶ä¸”ä»…åœ¨é€šçŸ¥æ•°ç»„çš„å¤§å°å‘ç”Ÿå˜åŒ–æ—¶æ‰å†æ¬¡å‘èµ·ã€‚è¿™å¹¶æ²¡æœ‰ç ´åå…¶å®ƒä»»ä½•ä¸œè¥¿ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä¸ç®¡å®ƒã€‚</p><p>è¿™çš„ç¡®è¡¨æ˜<strong>å¯ä»¥å‘èµ·ä¸€ä¸ª action ä½†ä¸ä¼šå¯¼è‡´ä»» state å‘ç”Ÿæ›´æ”¹</strong>ã€‚ è¯·è®°ä½ï¼Œ<strong>å®ƒæ€»æ˜¯ç”±ä½ çš„ reducer æ¥å†³å®šå“ªäº› state ç¡®å®éœ€è¦æ›´æ–°ï¼Œå¹¶ä¸”â€œä¸å‘ç”Ÿä»»ä½•æ›´æ”¹â€å¯¹äº reducer æ¥è¯´ä¹Ÿæ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„å†³å®š</strong>ã€‚</p><p>ä»¥ä¸‹æ˜¯é€šçŸ¥ tab ç°åœ¨çš„æ ·å­ï¼Œå› ä¸ºæˆ‘ä»¬å·²ç»æœ‰äº†â€œæ–°/è¯»â€çš„è¡Œä¸ºäº†ï¼š</p><p><img alt="New notifications" src="/assets/images/notifications-new-47a4cee8ef5292cc65a8b4b89245c112.png"></p><p>åœ¨ç»§ç»­ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦åšçš„æœ€åä¸€ä»¶äº‹æ˜¯åœ¨å¯¼èˆªæ ä¸­çš„â€œé€šçŸ¥â€ tab ä¸Šæ·»åŠ å¾½ç« ã€‚å½“æˆ‘ä»¬åœ¨å…¶ä»– tab ä¸­æ—¶ï¼Œè¿™å°†å‘æˆ‘ä»¬å±•ç¤ºâ€œæœªè¯»â€é€šçŸ¥çš„æ¡æ•°ï¼š</p><div class="codeBlockContainer_J+bg"><div style="color:#f8f8f2;background-color:#272822" class="codeBlockTitle_oQzk">app/Navbar.js</div><div class="codeBlockContent_csEI js"><div tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar codeBlockWithTitle_ZT05"><div class="codeBlockLines_1zSZ" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#c6cad2">// omit imports</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#F8F8F2">{</span><span class="token imports"> useDispatch</span><span class="token imports punctuation" style="color:#F8F8F2">,</span><span class="token imports"> useSelector </span><span class="token imports punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;react-redux&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#F8F8F2">{</span><span class="token imports"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token imports">  fetchNotifications</span><span class="token imports punctuation" style="color:#F8F8F2">,</span><span class="token imports"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token imports">  selectAllNotifications</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token imports"></span><span class="token imports punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;../features/notifications/notificationsSlice&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function maybe-class-name" style="color:#E6D874">Navbar</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> dispatch </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">useDispatch</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> notifications </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">useSelector</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">selectAllNotifications</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> numUnreadNotifications </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> notifications</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">filter</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">n</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">!</span><span class="token plain">n</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">read</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">length</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token comment" style="color:#c6cad2">// omit component contents</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">let</span><span class="token plain"> unreadNotificationsBadge</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#F92672">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">numUnreadNotifications </span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#AE81FF">0</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    unreadNotificationsBadge </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token plain">span className</span><span class="token operator" style="color:#F8F8F2">=</span><span class="token string" style="color:#a6e22e">&quot;badge&quot;</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain">numUnreadNotifications</span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token operator" style="color:#F8F8F2">/</span><span class="token plain">span</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#F92672">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token plain">nav</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token comment" style="color:#c6cad2">// omit component contents</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token plain">div className</span><span class="token operator" style="color:#F8F8F2">=</span><span class="token string" style="color:#a6e22e">&quot;navLinks&quot;</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token maybe-class-name">Link</span><span class="token plain"> to</span><span class="token operator" style="color:#F8F8F2">=</span><span class="token string" style="color:#a6e22e">&quot;/&quot;</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token maybe-class-name">Posts</span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token operator" style="color:#F8F8F2">/</span><span class="token maybe-class-name">Link</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token maybe-class-name">Link</span><span class="token plain"> to</span><span class="token operator" style="color:#F8F8F2">=</span><span class="token string" style="color:#a6e22e">&quot;/users&quot;</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token maybe-class-name">Users</span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token operator" style="color:#F8F8F2">/</span><span class="token maybe-class-name">Link</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token maybe-class-name">Link</span><span class="token plain"> to</span><span class="token operator" style="color:#F8F8F2">=</span><span class="token string" style="color:#a6e22e">&quot;/notifications&quot;</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">          </span><span class="token maybe-class-name">Notifications</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain">unreadNotificationsBadge</span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token operator" style="color:#F8F8F2">/</span><span class="token maybe-class-name">Link</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token operator" style="color:#F8F8F2">/</span><span class="token plain">div</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token comment" style="color:#c6cad2">// omit component contents</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token operator" style="color:#F8F8F2">/</span><span class="token plain">nav</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="æå‡æ¸²æŸ“æ€§èƒ½"></a>æå‡æ¸²æŸ“æ€§èƒ½<a class="hash-link" href="#æå‡æ¸²æŸ“æ€§èƒ½" title="Direct link to heading">#</a></h2><p>æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºçœ‹èµ·æ¥å·²ç»èƒ½ç”¨äº†ï¼Œä½†å®é™…ä¸Šæˆ‘ä»¬ç»„ä»¶é‡æ–°æ¸²æŸ“çš„æ—¶æœºå’Œæ–¹å¼éƒ½å­˜åœ¨ä¸€äº›ç¼ºé™·ã€‚è®©æˆ‘ä»¬æ¥çœ‹çœ‹è¿™äº›é—®é¢˜ï¼Œå¹¶è®¨è®ºä¸€äº›æå‡æ€§èƒ½çš„æ–¹æ³•ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="è°ƒç ”æ¸²æŸ“è¡Œä¸º"></a>è°ƒç ”æ¸²æŸ“è¡Œä¸º<a class="hash-link" href="#è°ƒç ”æ¸²æŸ“è¡Œä¸º" title="Direct link to heading">#</a></h3><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ React DevTools Profiler æŸ¥çœ‹ state æ›´æ–°æ—¶ç»„ä»¶é‡æ–°æ¸²æŸ“çš„åˆ†æå›¾ã€‚å°è¯•å•å‡»å•ä¸ªç”¨æˆ·çš„<code>&lt;UserPage&gt;</code>ã€‚ æ‰“å¼€æµè§ˆå™¨çš„ DevToolsï¼Œç„¶ååœ¨ React â€œProfilerâ€ é€‰é¡¹å¡ä¸­ï¼Œå•å‡»å·¦ä¸Šè§’çš„åœ†å½¢ â€œRecordâ€ æŒ‰é’®ã€‚ ç„¶åï¼Œå•å‡»æˆ‘ä»¬åº”ç”¨ç¨‹åºä¸­çš„ â€œåˆ·æ–°é€šçŸ¥â€ æŒ‰é’®ï¼Œå¹¶åœ¨ React DevTools Profiler ä¸­åœæ­¢è®°å½•ã€‚ æ‚¨åº”è¯¥ä¼šçœ‹åˆ°å¦‚ä¸‹æ‰€ç¤ºçš„å›¾è¡¨ï¼š</p><p><img alt="React DevTools Profiler æ¸²æŸ“å›¾ - &amp;lt;UserPage&amp;gt;" src="/assets/images/userpage-rerender-d064bb5a9461960f5949ba996597c3f7.png"></p><p>æˆ‘ä»¬çœ‹åˆ° <code>&lt;Navbar&gt;</code> è¿›è¡Œäº†é‡æ–°æ¸²æŸ“ï¼Œè¿™æ˜¯åˆç†çš„ï¼Œå› ä¸ºå®ƒå¿…é¡»åœ¨ tab ä¸Šæ˜¾ç¤ºæ›´æ–°çš„â€œæœªè¯»é€šçŸ¥â€æ ‡è®°ã€‚ ä½†æ˜¯ï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬çš„ <code>&lt;UserPage&gt;</code> ä¹Ÿä¼šé‡æ–°æ¸²æŸ“å‘¢ï¼Ÿ</p><p>å½“æˆ‘ä»¬æ£€æŸ¥ Redux DevTools ä¸­æœ€åå‘èµ·çš„å‡ ä¸ª actionï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°åªæœ‰é€šçŸ¥ state è¿›è¡Œæ›´æ–°ã€‚ç”±äº <code>&lt;UserPage&gt;</code> æ²¡æœ‰è¯»å–ä»»ä½•é€šçŸ¥ï¼Œå› æ­¤å®ƒä¸åº”è¯¥é‡æ–°æ¸²æŸ“ã€‚ç»„ä»¶ç¼–å†™ä¸€å®šå­˜åœ¨ä¸€äº›é—®é¢˜ã€‚</p><p>å½“æˆ‘ä»¬ä»”ç»†æŸ¥çœ‹ <code>&lt;UserPage&gt;</code>ï¼Œå°±ä¼šå‘ç°ä¸€ä¸ªå…·ä½“çš„é—®é¢˜ï¼š</p><div class="codeBlockContainer_J+bg"><div style="color:#f8f8f2;background-color:#272822" class="codeBlockTitle_oQzk">&quot;features/UserPage.js</div><div class="codeBlockContent_csEI jsx"><div tabindex="0" class="prism-code language-jsx codeBlock_rtdJ thin-scrollbar codeBlockWithTitle_ZT05"><div class="codeBlockLines_1zSZ" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function maybe-class-name" style="color:#E6D874">UserPage</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter punctuation" style="color:#F8F8F2">{</span><span class="token parameter"> match </span><span class="token parameter punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> userId </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> match</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">params</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> user </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">useSelector</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">selectUserById</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">state</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> userId</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> postsForUser </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">useSelector</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> allPosts </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">selectAllPosts</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">state</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#F92672">return</span><span class="token plain"> allPosts</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">filter</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">post</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> post</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">user</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">===</span><span class="token plain"> userId</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token comment" style="color:#c6cad2">// omit rendering logic</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>æˆ‘ä»¬çŸ¥é“æ¯å‘èµ·ä¸€ä¸ª action éƒ½å°†è¿è¡Œ <code>useSelector</code>ï¼Œå¦‚æœæˆ‘ä»¬è¿”å›ä¸€ä¸ªæ–°çš„å¼•ç”¨å€¼ï¼Œå®ƒä¼šå¼ºåˆ¶ç»„ä»¶é‡æ–°æ¸²æŸ“ã€‚</p><p>æˆ‘ä»¬åœ¨ <code>useSelector</code> é’©å­ä¸­è°ƒç”¨äº† <code>filter()</code>ï¼Œä»¥ä¾¿åªè¿”å›å±äºè¯¥ç”¨æˆ·çš„å¸–å­åˆ—è¡¨ã€‚ä¸å¹¸çš„æ˜¯ï¼Œ<strong>è¿™æ„å‘³ç€ <code>useSelector</code> <em>æ€»ä¼š</em> è¿”å›ä¸€ä¸ªæ–°çš„æ•°ç»„ï¼Œæ‰€ä»¥ <em>æ¯æ¬¡</em> æ‰§è¡Œä»¥ä¸Šæ“ä½œæˆ‘ä»¬çš„ç»„ä»¶éƒ½å°†é‡æ–°æ¸²æŸ“ï¼Œå³ä½¿è¿”å›çš„æ•°æ®å¹¶æ²¡æœ‰å‘ç”Ÿæ”¹å˜ï¼</strong></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="è®°å¿†åŒ–çš„-selector-å‡½æ•°"></a>è®°å¿†åŒ–çš„ Selector å‡½æ•°<a class="hash-link" href="#è®°å¿†åŒ–çš„-selector-å‡½æ•°" title="Direct link to heading">#</a></h3><p>æˆ‘ä»¬çœŸæ­£éœ€è¦çš„æ˜¯ä¸€ç§ä»…åœ¨ <code>state.posts</code> æˆ– <code>userId</code> å‘ç”Ÿå˜åŒ–æ—¶è®¡ç®—æ–°çš„è¿‡æ»¤æ•°ç»„çš„æ–¹æ³•ã€‚å¦‚æœå®ƒä»¬æ²¡æœ‰æ”¹å˜ï¼Œæˆ‘ä»¬å¸Œæœ›è¿”å›ä¸Šæ¬¡ç›¸åŒè¿‡æ»¤æ•°ç»„çš„å¼•ç”¨ã€‚</p><p>è¿™ä¸ªæƒ³æ³•è¢«ç§°ä¸ºâ€œè®°å¿†â€ã€‚æˆ‘ä»¬è¦ä¿å­˜ä¹‹å‰çš„ä¸€ç»„è¾“å…¥å’Œè®¡ç®—çš„ç»“æœï¼Œå¦‚æœè¾“å…¥ç›¸åŒï¼Œåˆ™è¿”å›ä¹‹å‰çš„ç»“æœï¼Œè€Œä¸æ˜¯é‡æ–°è®¡ç®—ã€‚</p><p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬ä¸€ç›´åœ¨è‡ªå·±ç¼–å†™ selector å‡½æ•°ï¼Œè¿™æ ·æˆ‘ä»¬å°±ä¸å¿…å¤åˆ¶å’Œç²˜è´´ä» store ä¸­è¯»å–æ•°æ®çš„ä»£ç ã€‚å¦‚æœæœ‰åŠæ³•è®©æˆ‘ä»¬çš„ selector å‡½æ•°è®°å¿†åŒ–ï¼Œé‚£å°±å¤ªå¥½äº†ã€‚</p><p><strong><a href="https://github.com/reduxjs/reselect" target="_blank" rel="noopener noreferrer">Reselect</a> æ˜¯ä¸€ä¸ªåˆ›å»ºè®°å¿†åŒ– selector å‡½æ•°çš„åº“</strong>ï¼Œå¹¶ä¸”æ˜¯ä¸“é—¨è®¾è®¡ç”¨æ¥ä¸ Redux ä¸€èµ·ä½¿ç”¨çš„ã€‚å®ƒæœ‰ä¸€ä¸ª <code>createSelector</code> å‡½æ•°ï¼Œå¯ä»¥åˆ›å»ºè®°å¿†åŒ–çš„ selectorï¼Œåªæœ‰åœ¨è¾“å…¥å‘ç”Ÿå˜åŒ–æ—¶æ‰ä¼šé‡æ–°è®¡ç®—ç»“æœã€‚Redux Toolkit <a href="https://redux-toolkit.js.org/api/createSelector" target="_blank" rel="noopener noreferrer">å¯¼å‡ºäº† <code>createSelector</code> å‡½æ•°</a> ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨å®ƒã€‚</p><p>è®©æˆ‘ä»¬ä½¿ç”¨ Reselect åˆ›å»ºä¸€ä¸ªæ–°çš„ <code>selectPostsByUser</code> selectorï¼Œå¹¶åœ¨è¿™é‡Œä½¿ç”¨å®ƒã€‚</p><div class="codeBlockContainer_J+bg"><div style="color:#f8f8f2;background-color:#272822" class="codeBlockTitle_oQzk">features/posts/postsSlice.js</div><div class="codeBlockContent_csEI js"><div tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar codeBlockWithTitle_ZT05"><div class="codeBlockLines_1zSZ" style="color:#f8f8f2;background-color:#272822"><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#F8F8F2">{</span><span class="token imports"> createSlice</span><span class="token imports punctuation" style="color:#F8F8F2">,</span><span class="token imports"> createAsyncThunk</span><span class="token imports punctuation" style="color:#F8F8F2">,</span><span class="token imports"> createSelector </span><span class="token imports punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;@reduxjs/toolkit&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:#c6cad2">// omit slice logic</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#E6D874">selectAllPosts</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token parameter">state</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> state</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">posts</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">posts</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#E6D874">selectPostById</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> postId</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  state</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">posts</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">posts</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">find</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">post</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> post</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">id</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">===</span><span class="token plain"> postId</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> selectPostsByUser </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">createSelector</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">[</span><span class="token plain">selectAllPosts</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> userId</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> userId</span><span class="token punctuation" style="color:#F8F8F2">]</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">posts</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> userId</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> posts</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">filter</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">post</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> post</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">user</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">===</span><span class="token plain"> userId</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p><code>createSelector</code> å°†ä¸€ä¸ªæˆ–å¤šä¸ªâ€œè¾“å…¥ selector â€å‡½æ•°ä½œä¸ºå‚æ•°ï¼Œå¤–åŠ ä¸€ä¸ªâ€œè¾“å‡º selector â€å‡½æ•°ã€‚ å½“æˆ‘ä»¬è°ƒç”¨ <code>selectPostsByUser(state, userId)</code> æ—¶ï¼Œ<code>createSelector</code> ä¼šå°†æ‰€æœ‰å‚æ•°ä¼ é€’ç»™æ¯ä¸ªè¾“å…¥ selector ã€‚æ— è®ºè¿™äº›è¾“å…¥ selector è¿”å›ä»€ä¹ˆï¼Œéƒ½å°†æˆä¸ºè¾“å‡º selector çš„å‚æ•°ã€‚</p><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çŸ¥é“æˆ‘ä»¬éœ€è¦å°†å¸–å­æ•°ç»„å’Œç”¨æˆ· ID ä½œä¸ºè¾“å‡º selector çš„ä¸¤ä¸ªå‚æ•°ã€‚æˆ‘ä»¬å¯ä»¥é‡ç”¨ç°æœ‰çš„ <code>selectAllPosts</code> selector æ¥æå–å¸–å­æ•°ç»„ã€‚ç”±äºç”¨æˆ· ID æ˜¯æˆ‘ä»¬ä¼ é€’ç»™ <code>selectPostsByUser</code> çš„ç¬¬äºŒä¸ªå‚æ•°ï¼Œæˆ‘ä»¬å¯ä»¥ç¼–å†™ä¸€ä¸ªåªè¿”å› <code>userId</code> çš„å° selectorã€‚</p><p>ç„¶åï¼Œæˆ‘ä»¬çš„è¾“å‡º selector æ¥å— <code>posts</code> å’Œ <code>userId</code>ï¼Œå¹¶è¿”å›è¿‡æ»¤åçš„å±äºè¯¥ç”¨æˆ·çš„å¸–å­æ•°ç»„ã€‚</p><p>å¦‚æœæˆ‘ä»¬å°è¯•å¤šæ¬¡è°ƒç”¨ <code>selectPostsByUser</code>ï¼Œå®ƒåªä¼šåœ¨ <code>posts</code> æˆ– <code>userId</code> å‘ç”Ÿå˜åŒ–æ—¶é‡æ–°æ‰§è¡Œè¾“å‡º selectorï¼š</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI js"><div tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> state1 </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">getState</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:#c6cad2">// Output selector runs, because it&#x27;s the first call</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token function" style="color:#E6D874">selectPostsByUser</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">state1</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;user1&#x27;</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:#c6cad2">// Output selector does _not_ run, because the arguments haven&#x27;t changed</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token function" style="color:#E6D874">selectPostsByUser</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">state1</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;user1&#x27;</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:#c6cad2">// Output selector runs, because `userId` changed</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token function" style="color:#E6D874">selectPostsByUser</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">state1</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;user2&#x27;</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token function" style="color:#E6D874">dispatch</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token function" style="color:#E6D874">reactionAdded</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> state2 </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">getState</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:#c6cad2">// Output selector does not run, because `posts` and `userId` are the same</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token function" style="color:#E6D874">selectPostsByUser</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">state2</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;user2&#x27;</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:#c6cad2">// Add some more posts</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token function" style="color:#E6D874">dispatch</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token function" style="color:#E6D874">addNewPost</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> state3 </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">getState</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:#c6cad2">// Output selector runs, because `posts` has changed</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token function" style="color:#E6D874">selectPostsByUser</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">state3</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;user2&#x27;</span><span class="token punctuation" style="color:#F8F8F2">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>å¦‚æœæˆ‘ä»¬åœ¨ <code>&lt;UserPage&gt;</code> ä¸­è°ƒç”¨è¿™ä¸ª selector å¹¶åœ¨è·å–é€šçŸ¥æ—¶é‡æ–°è¿è¡Œ React profilerï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™æ¬¡ <code>&lt;UserPage&gt;</code> æ²¡æœ‰é‡æ–°æ¸²æŸ“ï¼š</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI jsx"><div tabindex="0" class="prism-code language-jsx codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function maybe-class-name" style="color:#E6D874">UserPage</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter punctuation" style="color:#F8F8F2">{</span><span class="token parameter"> match </span><span class="token parameter punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> userId </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> match</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">params</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> user </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">useSelector</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">selectUserById</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">state</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> userId</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> postsForUser </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">useSelector</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">selectPostsByUser</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">state</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> userId</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token comment" style="color:#c6cad2">// omit rendering logic</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>è®°å¿†åŒ–çš„ selector æ˜¯æé«˜ React+Redux åº”ç”¨ç¨‹åºæ€§èƒ½çš„å®è´µå·¥å…·ï¼Œå› ä¸ºå®ƒä»¬å¯ä»¥å¸®åŠ©æˆ‘ä»¬é¿å…ä¸å¿…è¦çš„é‡æ–°æ¸²æŸ“ï¼Œå¹¶ä¸”å¦‚æœè¾“å…¥æ•°æ®æ²¡æœ‰æ›´æ”¹ï¼Œè¿˜å¯ä»¥é¿å…æ‰§è¡Œæ½œåœ¨çš„å¤æ‚æˆ–æ˜‚è´µçš„è®¡ç®—ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="è°ƒç ”å¸–å­åˆ—è¡¨"></a>è°ƒç ”å¸–å­åˆ—è¡¨<a class="hash-link" href="#è°ƒç ”å¸–å­åˆ—è¡¨" title="Direct link to heading">#</a></h3><p>å¦‚æœæˆ‘ä»¬å›åˆ°<code>&lt;PostsList&gt;</code> å¹¶åœ¨æ•è· React profiler è·Ÿè¸ªæ—¶ç‚¹å‡»å…¶ä¸­ä¸€ä¸ªå¸–å­ä¸Šçš„ååº”æŒ‰é’®ï¼Œæˆ‘ä»¬çœ‹åˆ°ä¸ä»… <code>&lt;PostsList&gt;</code> å’ŒçœŸæ­£æ›´æ–°çš„ <code>&lt;PostExcerpt&gt;</code> å®ä¾‹æ¸²æŸ“äº†ï¼Œå…¶å®ƒæ‰€æœ‰çš„ <code>&lt;PostExcerpt&gt;</code> ç»„ä»¶é¡µä¹Ÿæ¸²æŸ“äº†ï¼š</p><p><img alt="React DevTools Profiler render capture - &amp;lt;PostsList&amp;gt;" src="/assets/images/postslist-rerender-cf83ea2e96266af8ce3027d614f0c574.png"></p><p>ä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Ÿ å…¶ä»–å¸–å­éƒ½æ²¡æœ‰æ”¹å˜ï¼Œä¸ºä»€ä¹ˆä»–ä»¬ä¹Ÿå‘ç”Ÿäº†é‡æ–°æ¸²æŸ“ï¼Ÿ</p><p>[<strong>React çš„é»˜è®¤è¡Œä¸ºæ˜¯å½“çˆ¶ç»„ä»¶æ¸²æŸ“æ—¶ï¼ŒReact ä¼šé€’å½’æ¸²æŸ“å…¶ä¸­çš„æ‰€æœ‰å­ç»„ä»¶ï¼</strong>](<a href="https://blog.isquaredsoftware.com/2020/05/blogged-answers-a-mostly" target="_blank" rel="noopener noreferrer">https://blog.isquaredsoftware.com/2020/05/blogged-answers-a-mostly</a> -complete-guide-to-react-rendering-behavior/)ã€‚ ä¸€ä¸ª post å¯¹è±¡çš„ä¸å¯å˜æ›´æ–°ä¹Ÿåˆ›å»ºäº†ä¸€ä¸ªæ–°çš„ <code>posts</code> æ•°ç»„ã€‚<code>&lt;PostsList&gt;</code> å¿…é¡»é‡æ–°æ¸²æŸ“ï¼Œå› ä¸º <code>posts</code> æ•°ç»„æ˜¯ä¸€ä¸ªæ–°çš„å¼•ç”¨ï¼Œæ‰€ä»¥åœ¨æ¸²æŸ“ä¹‹åï¼ŒReact ç»§ç»­å‘ä¸‹å¹¶é‡æ–°æ¸²æŸ“æ‰€æœ‰çš„ <code>&lt;PostExcerpt&gt;</code> ç»„ä»¶ã€‚</p><p>è¿™å¯¹äºæˆ‘ä»¬çš„å°ç¤ºä¾‹åº”ç”¨ç¨‹åºæ¥è¯´å¹¶ä¸æ˜¯ä¸€ä¸ªä¸¥é‡çš„é—®é¢˜ï¼Œä½†æ˜¯åœ¨ä¸€ä¸ªæ›´å¤§çš„çœŸå®åº”ç”¨ç¨‹åºä¸­ï¼Œå¯èƒ½æœ‰ä¸€äº›éå¸¸é•¿çš„åˆ—è¡¨æˆ–è€…éå¸¸å¤§çš„ç»„ä»¶æ ‘ï¼Œé‡æ–°æ¸²æŸ“æ‰€æœ‰é¢å¤–çš„ç»„ä»¶å¯èƒ½ä¼šå¯¼è‡´é€Ÿåº¦ä¸‹é™ã€‚</p><p>åœ¨ <code>&lt;PostsList&gt;</code> ä¸­æœ‰å‡ ç§æ–¹æ³•å¯ä»¥ä¼˜åŒ–è¿™ç§è¡Œä¸ºã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬å¯ä»¥å°† <code>&lt;PostExcerpt&gt;</code> ç»„ä»¶åŒ…è£…åœ¨ React.memo() ä¸­ï¼Œè¿™å¯ä»¥ç¡®ä¿ç»„ä»¶åªæœ‰åœ¨ props çœŸæ­£æ›´æ”¹æ—¶æ‰ä¼šé‡æ–°æ¸²æŸ“ã€‚è¿™å®é™…ä¸Šè¿˜æ˜¯ä¼šå¾ˆå¥½åœ°è¿è¡Œâ€”â€”å°è¯•ä¸€ä¸‹ï¼Œçœ‹çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆï¼š</p><div class="codeBlockContainer_J+bg"><div style="color:#f8f8f2;background-color:#272822" class="codeBlockTitle_oQzk">&quot;features/posts/PostsList.js</div><div class="codeBlockContent_csEI jsx"><div tabindex="0" class="prism-code language-jsx codeBlock_rtdJ thin-scrollbar codeBlockWithTitle_ZT05"><div class="codeBlockLines_1zSZ" style="color:#f8f8f2;background-color:#272822"><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token keyword" style="color:#F92672">let</span><span class="token plain"> </span><span class="token function-variable function maybe-class-name" style="color:#E6D874">PostExcerpt</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter punctuation" style="color:#F8F8F2">{</span><span class="token parameter"> post </span><span class="token parameter punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token comment" style="color:#c6cad2">// omit logic</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token maybe-class-name">PostExcerpt</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">memo</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token maybe-class-name">PostExcerpt</span><span class="token punctuation" style="color:#F8F8F2">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>å¦ä¸€ç§é€‰æ‹©æ˜¯é‡å†™<code>&lt;PostsList&gt;</code>ï¼Œä½¿å…¶ä»…ä» store ä¸­é€‰æ‹©å¸–å­ ID åˆ—è¡¨è€Œä¸æ˜¯æ•´ä¸ª<code>posts</code>æ•°ç»„ï¼Œå¹¶é‡å†™ <code>&lt;PostExcerpt&gt;</code>ï¼Œä½¿å…¶æ¥æ”¶ <code>postId</code> prop å¹¶è°ƒç”¨ <code>useSelector</code> æ¥è¯»å–éœ€è¦çš„ post å¯¹è±¡ã€‚ å¦‚æœ <code>&lt;PostsList&gt;</code> è·å¾—ä¸ä»¥å‰ç›¸åŒçš„ ID åˆ—è¡¨ï¼Œåˆ™ä¸éœ€è¦é‡æ–°æ¸²æŸ“ï¼Œå› æ­¤åªæœ‰æˆ‘ä»¬æ›´æ–°çš„é‚£ä¸ª <code>&lt;PostExcerpt&gt;</code> ç»„ä»¶æ‰ä¼šæ¸²æŸ“ã€‚</p><p>ä¸å¹¸çš„æ˜¯ï¼Œè¿™å˜å¾—å¾ˆæ£˜æ‰‹ï¼Œå› ä¸ºæˆ‘ä»¬è¿˜éœ€è¦å°†æ‰€æœ‰å¸–å­æŒ‰æ—¥æœŸæ’åºå¹¶ä»¥æ­£ç¡®çš„é¡ºåºæ¸²æŸ“ã€‚å¯ä»¥æ›´æ–°æˆ‘ä»¬çš„ <code>postsSlice</code> ä»¥å§‹ç»ˆä¿æŒæ•°ç»„æ’åºï¼Œå› æ­¤æˆ‘ä»¬ä¸å¿…åœ¨ç»„ä»¶ä¸­å¯¹å…¶è¿›è¡Œæ’åºï¼Œå¹¶ä½¿ç”¨è®°å¿†åŒ–çš„ selector ä»…æå–å¸–å­ ID åˆ—è¡¨ã€‚æˆ‘ä»¬è¿˜å¯ä»¥è‡ªå®šä¹‰ useSelector çš„æ¯”è¾ƒå‡½æ•°æ¥æ£€æŸ¥ç»“æœï¼Œï¼Œæ¯”å¦‚ <code>useSelector(selectPostIds, shallowEqual)</code>ï¼Œè¿™æ ·å¦‚æœ IDs æ•°ç»„çš„å†…å®¹æ²¡æœ‰æ”¹å˜ï¼Œå°±ä¼šè·³è¿‡é‡æ–°æ¸²æŸ“ã€‚</p><p>æœ€åä¸€ä¸ªé€‰é¡¹æ˜¯æ‰¾åˆ°æŸç§æ–¹æ³•è®©æˆ‘ä»¬çš„ reducer ä¸ºæ‰€æœ‰å¸–å­ä¿ç•™ä¸€ä¸ªå•ç‹¬çš„ ID æ•°ç»„ï¼Œå¹¶ä¸”ä»…åœ¨æ·»åŠ æˆ–åˆ é™¤å¸–å­æ—¶ä¿®æ”¹è¯¥æ•°ç»„ï¼Œå¹¶å¯¹ <code>&lt;PostsList&gt;</code> å’Œ <code>&lt;PostExcerpt&gt;</code> è¿›è¡Œç›¸åŒçš„é‡å†™ã€‚ è¿™æ ·ï¼Œ<code>&lt;PostsList&gt;</code> åªéœ€è¦åœ¨ IDs æ•°ç»„æ›´æ”¹æ—¶é‡æ–°æ¸²æŸ“ã€‚</p><p>æ–¹ä¾¿çš„æ˜¯ï¼ŒRedux Toolkit æœ‰ä¸€ä¸ª createEntityAdapter å‡½æ•°å¯ä»¥å¸®åŠ©æˆ‘ä»¬åšåˆ°è¿™ä¸€ç‚¹ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="èŒƒå¼åŒ–æ•°æ®"></a>èŒƒå¼åŒ–æ•°æ®<a class="hash-link" href="#èŒƒå¼åŒ–æ•°æ®" title="Direct link to heading">#</a></h2><p>æ‚¨å·²ç»çœ‹åˆ°ï¼Œæˆ‘ä»¬çš„å¾ˆå¤šé€»è¾‘éƒ½æ˜¯é€šè¿‡ ID å­—æ®µæ¥æŸ¥æ‰¾å¯¹åº”çš„é¡¹ã€‚ç”±äºæˆ‘ä»¬ä¸€ç›´å°†æ•°æ®å­˜å‚¨åœ¨æ•°ç»„ä¸­ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬å¿…é¡»ä½¿ç”¨ <code>array.find()</code> éå†æ•°ç»„ä¸­çš„æ‰€æœ‰é¡¹ï¼Œç›´åˆ°æ‰¾åˆ°æˆ‘ä»¬å¯»æ‰¾çš„é‚£ä¸ª ID çš„å¯¹åº”çš„é¡¹ã€‚</p><p>å®é™…ä¸Šï¼Œè¿™ä¸ä¼šèŠ±è´¹å¾ˆé•¿æ—¶é—´ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬æ•°ç»„åŒ…å«æ•°ç™¾æˆ–æ•°åƒä¸ªé¡¹ï¼Œåˆ™æŸ¥çœ‹æ•´ä¸ªæ•°ç»„ä»¥æ‰¾åˆ°ä¸€ä¸ªé¡¹ç›®æ˜¯è€—æ—¶çš„ã€‚ æˆ‘ä»¬éœ€è¦çš„æ˜¯ä¸€ç§ç›´æ¥æ ¹æ®å…¶ ID æŸ¥æ‰¾å•ä¸ªé¡¹çš„æ–¹æ³•ï¼Œè€Œæ— éœ€æ£€æŸ¥æ‰€æœ‰å…¶ä»–é¡¹ã€‚è¿™ä¸ªè¿‡ç¨‹è¢«ç§°ä¸ºâ€œèŒƒå¼åŒ–â€ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="èŒƒå¼åŒ–-state-ç»“æ„"></a>èŒƒå¼åŒ– State ç»“æ„<a class="hash-link" href="#èŒƒå¼åŒ–-state-ç»“æ„" title="Direct link to heading">#</a></h3><p>â€œèŒƒå¼åŒ– stateâ€æ˜¯æŒ‡ï¼š</p><ul><li>æˆ‘ä»¬ state ä¸­çš„æ¯ä¸ªç‰¹å®šæ•°æ®åªæœ‰ä¸€ä¸ªå‰¯æœ¬ï¼Œä¸å­˜åœ¨é‡å¤ã€‚</li><li>å·²èŒƒå¼åŒ–çš„æ•°æ®ä¿å­˜åœ¨æŸ¥æ‰¾è¡¨ä¸­ï¼Œå…¶ä¸­é¡¹ç›® ID æ˜¯é”®ï¼Œé¡¹æœ¬èº«æ˜¯å€¼ã€‚</li><li>ä¹Ÿå¯èƒ½æœ‰ä¸€ä¸ªç‰¹å®šé¡¹ç”¨äºä¿å­˜æ‰€æœ‰ ID çš„æ•°ç»„ã€‚</li></ul><p>JavaScript å¯¹è±¡å¯ä»¥ç”¨ä½œæŸ¥æ‰¾è¡¨ï¼Œç±»ä¼¼äºå…¶ä»–è¯­è¨€ä¸­çš„ &quot;maps&quot; æˆ– &quot;dictionaries&quot;ã€‚ ä»¥ä¸‹æ˜¯ä¸€ç»„â€œç”¨æˆ·â€å¯¹è±¡çš„èŒƒå¼åŒ– state å¯èƒ½å¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI js"><div tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token literal-property property" style="color:#F92672">users</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token literal-property property" style="color:#F92672">ids</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">[</span><span class="token string" style="color:#a6e22e">&quot;user1&quot;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;user2&quot;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;user3&quot;</span><span class="token punctuation" style="color:#F8F8F2">]</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token literal-property property" style="color:#F92672">entities</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token string-property property" style="color:#F92672">&quot;user1&quot;</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token literal-property property" style="color:#F92672">id</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;user1&quot;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> firstName</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> lastName</span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token string-property property" style="color:#F92672">&quot;user2&quot;</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token literal-property property" style="color:#F92672">id</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;user2&quot;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> firstName</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> lastName</span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token string-property property" style="color:#F92672">&quot;user3&quot;</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token literal-property property" style="color:#F92672">id</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;user3&quot;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> firstName</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> lastName</span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>è¿™ä½¿å¾—é€šè¿‡ ID æŸ¥æ‰¾ç‰¹å®šçš„â€œç”¨æˆ·â€å¯¹è±¡å˜å¾—ç®€å•ï¼Œä¸éœ€éå†æ•°ç»„ä¸­å…¶ä»–çš„ç”¨æˆ·å¯¹è±¡ï¼š</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI js"><div tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> userId </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;user2&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> userObject </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> state</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">users</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">entities</span><span class="token punctuation" style="color:#F8F8F2">[</span><span class="token plain">userId</span><span class="token punctuation" style="color:#F8F8F2">]</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>è¯´æ˜</h5></div><div class="admonition-content"><p>æœ‰å…³èŒƒå¼åŒ– state ä¸ºä½•æœ‰ç”¨çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…<a href="/recipes/structuring-reducers/normalizing-state-shape">èŒƒå¼åŒ– state ç»“æ„</a> å’Œ Redux å·¥å…·åŒ…ä½¿ç”¨æŒ‡å—éƒ¨åˆ†å…³äº<a href="https://redux-toolkit.js.org/usage/usage-guide#managing-normalized-data" target="_blank" rel="noopener noreferrer">ç®¡ç†èŒƒå¼åŒ–æ•°æ®</a>ã€‚</p></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="ä½¿ç”¨-createentityadapter-ç®¡ç†èŒƒå¼åŒ–-state"></a>ä½¿ç”¨&#x27; createEntityAdapter &#x27;ç®¡ç†èŒƒå¼åŒ– state<a class="hash-link" href="#ä½¿ç”¨-createentityadapter-ç®¡ç†èŒƒå¼åŒ–-state" title="Direct link to heading">#</a></h3><p>Redux Toolkit çš„ <code>createEntityAdapter</code> API æä¾›äº†ä¸€ç§å°†æ•°æ®å­˜å‚¨åœ¨åˆ‡ç‰‡ä¸­çš„æ ‡å‡†åŒ–æ–¹æ³•ï¼Œæ–¹æ³•æ˜¯è·å–é¡¹ç›®é›†åˆå¹¶å°†å®ƒä»¬æ”¾å…¥ <code>{ ids: [], entities: {} }</code> çš„ç»“æ„ä¸­ã€‚é™¤äº†è¿™ä¸ªé¢„å®šä¹‰çš„ state ç»“æ„ï¼Œå®ƒè¿˜ä¼šç”Ÿæˆä¸€ç»„çŸ¥é“å¦‚ä½•å¤„ç†è¯¥æ•°æ®çš„ reducer å‡½æ•°å’Œ selectorã€‚</p><p>è¿™æœ‰å‡ ä¸ªå¥½å¤„ï¼š</p><ul><li>æˆ‘ä»¬ä¸å¿…è‡ªå·±ç¼–å†™ä»£ç æ¥ç®¡ç†èŒƒå¼åŒ–</li><li><code>createEntityAdapter</code> çš„é¢„æ„å»º reducer å‡½æ•°å¤„ç†ä¸€äº›å¸¸è§çš„æƒ…å†µï¼Œä¾‹å¦‚â€œæ·»åŠ æ‰€æœ‰é¡¹â€ã€â€œæ›´æ–°é¡¹â€æˆ–â€œåˆ é™¤å¤šä¸ªé¡¹â€</li><li><code>createEntityAdapter</code> å¯ä»¥åŸºäºé¡¹çš„å†…å®¹å°† ID ä¿æŒåœ¨æ’åºçš„æ•°ç»„ä¸­ï¼Œå¹¶ä¸”ä»…åœ¨æ·»åŠ /åˆ é™¤é¡¹æˆ–æ’åºè§„åˆ™æ›´æ”¹æ—¶æ‰æ›´æ–°è¯¥æ•°ç»„ã€‚</li></ul><p><code>createEntityAdapter</code> æ¥å—ä¸€ä¸ªé€‰é¡¹å¯¹è±¡ï¼Œè¯¥å¯¹è±¡å¯èƒ½åŒ…å«ä¸€ä¸ª <code>sortComparer</code> å‡½æ•°ï¼Œè¯¥å‡½æ•°å°†ç”¨äºé€šè¿‡æ¯”è¾ƒä¸¤ä¸ªé¡¹ç›®æ¥ä¿æŒé¡¹ç›® id æ•°ç»„çš„æ’åº(å·¥ä½œæ–¹å¼ä¸ <code>array.sort()</code> ç›¸åŒ)ã€‚</p><p>å®ƒè¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥å¯¹è±¡åŒ…å« <a href="https://redux-toolkit.js.org/api/createEntityAdapter#crud-functions" target="_blank" rel="noopener noreferrer">ä¸€ç»„ç”Ÿæˆçš„ reducer å‡½æ•°ï¼Œç”¨äºä»å®ä½“ state å¯¹è±¡ä¸­æ·»åŠ ã€æ›´æ–°å’Œåˆ é™¤é¡¹ç›®</a>ã€‚è¿™äº› reducer å‡½æ•°æ—¢å¯ä»¥ç”¨ä½œç‰¹å®š action ç±»å‹çš„ reducerï¼Œä¹Ÿå¯ä»¥ç”¨ä½œ <code>createSlice</code> ä¸­å¦ä¸€ä¸ª reducer ä¸­çš„ &quot;mutating&quot; å®ç”¨å‡½æ•°ã€‚</p><p>adapter å¯¹è±¡ä¹Ÿæœ‰ä¸€ä¸ª <code>getSelectors</code> å‡½æ•°ã€‚ä½ å¯ä»¥ä¼ å…¥ä¸€ä¸ª selectorï¼Œå®ƒä» Redux æ ¹ state è¿”å›è¿™ä¸ªç‰¹å®šçš„ state åˆ‡ç‰‡ï¼Œå®ƒä¼šç”Ÿæˆç±»ä¼¼äº <code>selectAll</code> å’Œ <code>selectById</code> çš„é€‰æ‹©å™¨ã€‚</p><p>æœ€åï¼Œadapter å¯¹è±¡æœ‰ä¸€ä¸ª <code>getInitialState</code> å‡½æ•°ï¼Œå®ƒç”Ÿæˆä¸€ä¸ªç©ºçš„ <code>{ids: [], entities: {}}</code> å¯¹è±¡ã€‚æ‚¨å¯ä»¥ä¼ é€’æ›´å¤šå­—æ®µç»™ <code>getInitialState</code>ï¼Œè¿™äº›å­—æ®µå°†ä¼šè¢«åˆå¹¶ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="æ›´æ–°å¸–å­åˆ‡ç‰‡"></a>æ›´æ–°å¸–å­åˆ‡ç‰‡<a class="hash-link" href="#æ›´æ–°å¸–å­åˆ‡ç‰‡" title="Direct link to heading">#</a></h3><p>è€ƒè™‘åˆ°è¿™ä¸€ç‚¹ï¼Œè®©æˆ‘ä»¬ä½¿ç”¨ <code>createEntityAdapter</code> æ›´æ–° <code>postsSlice</code> ï¼š</p><div class="codeBlockContainer_J+bg"><div style="color:#f8f8f2;background-color:#272822" class="codeBlockTitle_oQzk">features/posts/postsSlice.js</div><div class="codeBlockContent_csEI js"><div tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar codeBlockWithTitle_ZT05"><div class="codeBlockLines_1zSZ" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  createEntityAdapter</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token comment" style="color:#c6cad2">// omit other imports</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;@reduxjs/toolkit&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> postsAdapter </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">createEntityAdapter</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token function-variable function" style="color:#E6D874">sortComparer</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">a</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> b</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> b</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">date</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">localeCompare</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">a</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">date</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> initialState </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> postsAdapter</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">getInitialState</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token literal-property property" style="color:#F92672">status</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;idle&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token literal-property property" style="color:#F92672">error</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#F92672">null</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:#c6cad2">// omit thunks</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> postsSlice </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">createSlice</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token literal-property property" style="color:#F92672">name</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;posts&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  initialState</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token literal-property property" style="color:#F92672">reducers</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token function" style="color:#E6D874">reactionAdded</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> postId</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> reaction </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> action</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">payload</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> existingPost </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> state</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">entities</span><span class="token punctuation" style="color:#F8F8F2">[</span><span class="token plain">postId</span><span class="token punctuation" style="color:#F8F8F2">]</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#F92672">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">existingPost</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        existingPost</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">reactions</span><span class="token punctuation" style="color:#F8F8F2">[</span><span class="token plain">reaction</span><span class="token punctuation" style="color:#F8F8F2">]</span><span class="token operator" style="color:#F8F8F2">++</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token function" style="color:#E6D874">postUpdated</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> id</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> title</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> content </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> action</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">payload</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> existingPost </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> state</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">entities</span><span class="token punctuation" style="color:#F8F8F2">[</span><span class="token plain">id</span><span class="token punctuation" style="color:#F8F8F2">]</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#F92672">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">existingPost</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        existingPost</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">title</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> title</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        existingPost</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">content</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> content</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token literal-property property" style="color:#F92672">extraReducers</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token comment" style="color:#c6cad2">// omit other reducers</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">[</span><span class="token plain">fetchPosts</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">fulfilled</span><span class="token punctuation" style="color:#F8F8F2">]</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      state</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">status</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;succeeded&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token comment" style="color:#c6cad2">// Add any fetched posts to the array</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token comment" style="color:#c6cad2">// Use the `upsertMany` reducer as a mutating update utility</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">      postsAdapter</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">upsertMany</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">state</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> action</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">payload</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token comment" style="color:#c6cad2">// Use the `addOne` reducer for the fulfilled case</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">[</span><span class="token plain">addNewPost</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">fulfilled</span><span class="token punctuation" style="color:#F8F8F2">]</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> postsAdapter</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">addOne</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> postAdded</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> postUpdated</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> reactionAdded </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> postsSlice</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">actions</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">default</span><span class="token plain"> postsSlice</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">reducer</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:#c6cad2">// Export the customized selectors for this adapter using `getSelectors`</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token literal-property property" style="color:#F92672">selectAll</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> selectAllPosts</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token literal-property property" style="color:#F92672">selectById</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> selectPostById</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token literal-property property" style="color:#F92672">selectIds</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> selectPostIds</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token comment" style="color:#c6cad2">// Pass in a selector that returns the posts slice of state</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> postsAdapter</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">getSelectors</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> state</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">posts</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> selectPostsByUser </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">createSelector</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">[</span><span class="token plain">selectAllPosts</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> userId</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> userId</span><span class="token punctuation" style="color:#F8F8F2">]</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">posts</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> userId</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> posts</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">filter</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">post</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> post</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">user</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">===</span><span class="token plain"> userId</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>ä¸Šé¢ä»£ç åšäº†å¾ˆå¤šäº‹æƒ…ï¼è®©æˆ‘ä»¬åˆ†æ­¥è®²è§£ä¸€ä¸‹ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬å¯¼å…¥äº† <code>createEntityAdapter</code>ï¼Œå¹¶è°ƒç”¨å®ƒæ¥åˆ›å»º <code>postsAdapter</code> å¯¹è±¡ã€‚æˆ‘ä»¬å¸Œæœ›ä¿ç•™ä¸€ä¸ªæ‰€æœ‰å¸–å­ ID å¹¶æŒ‰æœ€æ–°æ’åºçš„æ•°ç»„ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¼ å…¥ä¸€ä¸ª <code>sortComparer</code> å‡½æ•°ï¼Œå®ƒå°†æ ¹æ® <code>post.date</code> å­—æ®µå°†è¾ƒæ–°çš„é¡¹æ’åºåˆ°å‰é¢ã€‚</p><p><code>getInitialState()</code> è¿”å›ä¸€ä¸ªç©ºçš„ <code>{ids: [], entities: {}}</code> èŒƒå¼åŒ– state å¯¹è±¡ã€‚æˆ‘ä»¬çš„ <code>postsSlice</code> éœ€è¦ç”¨ <code>status</code> å’Œ <code>error</code> å­—æ®µæ¥ä¿ç•™åŠ è½½ stateï¼Œæ‰€ä»¥æˆ‘ä»¬å°†å®ƒä»¬ä¼ é€’ç»™ <code>getInitialState()</code>ã€‚</p><p>ç°åœ¨æˆ‘ä»¬çš„å¸–å­ä½œä¸ºä¸€ä¸ªæŸ¥æ‰¾è¡¨ä¿å­˜åœ¨ <code>state.entities</code> ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä¿®æ”¹ <code>reactionAdded</code> å’Œ <code>postUpdated</code> reducerï¼Œç›´æ¥æ ¹æ® id æŸ¥æ‰¾æ­£ç¡®çš„å¸–å­ï¼Œè€Œä¸å¿…éå†æ—§çš„<code>å¸–å­</code>æ•°ç»„ã€‚</p><p>å½“æ”¶åˆ° <code>fetchPosts.fulfilled</code> action æ—¶ï¼Œæˆ‘ä»¬é€šè¿‡å°†ç°æœ‰ <code>state</code> å’Œ <code>action.payload</code> ä¼ å…¥ <code>postsAdapter.upsertMany</code> å‡½æ•°ï¼Œä»è€Œå°†æ‰€æœ‰ä¼ å…¥çš„å¸–å­æ·»åŠ åˆ° state ä¸­ã€‚å¦‚æœ <code>action.payload</code> ä¸­æœ‰ä»»ä½•é¡¹ç›®å·²ç»å­˜åœ¨äºæˆ‘ä»¬ state ä¸­ï¼Œ<code>upsertMany</code> å‡½æ•°å°†æ ¹æ®åŒ¹é…çš„ ID å°†å®ƒä»¬åˆå¹¶åœ¨ä¸€èµ·ã€‚</p><p>å½“æˆ‘ä»¬æ”¶åˆ° <code>addNewPost.fulfilled</code> action æ—¶ï¼Œæˆ‘ä»¬éœ€è¦å°†ä¸€ä¸ªæ–°çš„å¸–å­å¯¹è±¡æ·»åŠ åˆ°æˆ‘ä»¬çš„ state ä¸­ã€‚æˆ‘ä»¬å¯ä»¥ç›´æ¥å°† adapter ç”¨ä½œ reducerï¼Œå› æ­¤æˆ‘ä»¬å°†ä¼ é€’ <code>postsAdapter.addOne</code> ä½œä¸º reducer å‡½æ•°æ¥å¤„ç†è¯¥æ“ä½œã€‚</p><p>æœ€åï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ <code>postsAdapter.getSelectors</code> ç”Ÿæˆçš„ selector å‡½æ•°æ›¿æ¢æ—§çš„æ‰‹å†™çš„ <code>selectAllPosts</code> å’Œ <code>selectPostById</code> selector å‡½æ•°ã€‚ç”±äº selector æ˜¯ä½¿ç”¨æ ¹ Redux state å¯¹è±¡è°ƒç”¨çš„ï¼Œå®ƒä»¬éœ€è¦çŸ¥é“åœ¨ Redux state ä¸­åœ¨å“ªé‡Œå¯ä»¥æ‰¾åˆ°æˆ‘ä»¬çš„å¸–å­æ•°æ®ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¼ å…¥ä¸€ä¸ªè¿”å› <code>state.posts</code> çš„å° selectorã€‚ç”Ÿæˆçš„ selector å‡½æ•°æ€»æ˜¯ç§°ä¸º <code>selectAll</code> å’Œ <code>selectById</code>ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ ES6 è§£æ„è¯­æ³•åœ¨å¯¼å‡ºå®ƒä»¬æ—¶é‡å‘½åå®ƒä»¬å¹¶åŒ¹é…æ—§çš„ selector åç§°ã€‚æˆ‘ä»¬è¿˜å°†ä»¥åŒæ ·çš„æ–¹å¼å¯¼å‡º <code>selectPostIds</code>ï¼Œå› ä¸ºæˆ‘ä»¬æƒ³åœ¨ <code>&lt;PostsList&gt;</code> ç»„ä»¶ä¸­è¯»å–å·²æ’åºçš„å¸–å­ ID åˆ—è¡¨ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="ä¼˜åŒ–å¸–å­åˆ—è¡¨"></a>ä¼˜åŒ–å¸–å­åˆ—è¡¨<a class="hash-link" href="#ä¼˜åŒ–å¸–å­åˆ—è¡¨" title="Direct link to heading">#</a></h3><p>ç°åœ¨æˆ‘ä»¬çš„å¸–å­åˆ‡ç‰‡ä½¿ç”¨äº† createEntityAdapterï¼Œæˆ‘ä»¬å¯ä»¥æ›´æ–° <code>&lt;PostsList</code>&gt; ä»¥ä¼˜åŒ–å…¶æ¸²æŸ“è¡Œä¸ºã€‚</p><p>æˆ‘ä»¬å°†æ›´æ–° <code>&lt;PostsList&gt;</code> ï¼Œä½¿å…¶åªè¯»å–å·²æ’åºçš„å¸–å­ ID æ•°ç»„ï¼Œå¹¶å°† postId ä¼ é€’ç»™æ¯ä¸ª <code>&lt;PostExcerpt&gt;</code>ï¼š</p><div class="codeBlockContainer_J+bg"><div style="color:#f8f8f2;background-color:#272822" class="codeBlockTitle_oQzk">features/posts/PostsList.js</div><div class="codeBlockContent_csEI jsx"><div tabindex="0" class="prism-code language-jsx codeBlock_rtdJ thin-scrollbar codeBlockWithTitle_ZT05"><div class="codeBlockLines_1zSZ" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#c6cad2">// omit other imports</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#F8F8F2">{</span><span class="token imports"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token imports">  selectAllPosts</span><span class="token imports punctuation" style="color:#F8F8F2">,</span><span class="token imports"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token imports">  fetchPosts</span><span class="token imports punctuation" style="color:#F8F8F2">,</span><span class="token imports"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token imports">  selectPostIds</span><span class="token imports punctuation" style="color:#F8F8F2">,</span><span class="token imports"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token imports">  selectPostById</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token imports"></span><span class="token imports punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;./postsSlice&#x27;</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">let</span><span class="token plain"> </span><span class="token function-variable function maybe-class-name" style="color:#E6D874">PostExcerpt</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter punctuation" style="color:#F8F8F2">{</span><span class="token parameter"> postId </span><span class="token parameter punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> post </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">useSelector</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">selectPostById</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">state</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> postId</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token comment" style="color:#c6cad2">// omit rendering logic</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function maybe-class-name" style="color:#E6D874">PostsList</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> dispatch </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">useDispatch</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> orderedPostIds </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">useSelector</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">selectPostIds</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token comment" style="color:#c6cad2">// omit other selections and effects</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#F92672">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">postStatus </span><span class="token operator" style="color:#F8F8F2">===</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;loading&#x27;</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    content </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token tag punctuation" style="color:#F8F8F2">&lt;</span><span class="token tag" style="color:#F92672">div</span><span class="token tag" style="color:#F92672"> </span><span class="token tag attr-name" style="color:#a6e22e">className</span><span class="token tag attr-value punctuation attr-equals" style="color:#F8F8F2">=</span><span class="token tag attr-value punctuation" style="color:#F8F8F2">&quot;</span><span class="token tag attr-value" style="color:#E6D874">loader</span><span class="token tag attr-value punctuation" style="color:#F8F8F2">&quot;</span><span class="token tag punctuation" style="color:#F8F8F2">&gt;</span><span class="token plain-text">Loading...</span><span class="token tag punctuation" style="color:#F8F8F2">&lt;/</span><span class="token tag" style="color:#F92672">div</span><span class="token tag punctuation" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#F92672">else</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#F92672">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">postStatus </span><span class="token operator" style="color:#F8F8F2">===</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;succeeded&#x27;</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    content </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> orderedPostIds</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">map</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">postId</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token tag punctuation" style="color:#F8F8F2">&lt;</span><span class="token tag class-name" style="color:#F92672">PostExcerpt</span><span class="token tag" style="color:#F92672"> </span><span class="token tag attr-name" style="color:#a6e22e">key</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#F8F8F2">=</span><span class="token tag script language-javascript punctuation" style="color:#F8F8F2">{</span><span class="token tag script language-javascript" style="color:#F92672">postId</span><span class="token tag script language-javascript punctuation" style="color:#F8F8F2">}</span><span class="token tag" style="color:#F92672"> </span><span class="token tag attr-name" style="color:#a6e22e">postId</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#F8F8F2">=</span><span class="token tag script language-javascript punctuation" style="color:#F8F8F2">{</span><span class="token tag script language-javascript" style="color:#F92672">postId</span><span class="token tag script language-javascript punctuation" style="color:#F8F8F2">}</span><span class="token tag" style="color:#F92672"> </span><span class="token tag punctuation" style="color:#F8F8F2">/&gt;</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#F92672">else</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#F92672">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">postStatus </span><span class="token operator" style="color:#F8F8F2">===</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;error&#x27;</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    content </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token tag punctuation" style="color:#F8F8F2">&lt;</span><span class="token tag" style="color:#F92672">div</span><span class="token tag punctuation" style="color:#F8F8F2">&gt;</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain">error</span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token tag punctuation" style="color:#F8F8F2">&lt;/</span><span class="token tag" style="color:#F92672">div</span><span class="token tag punctuation" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token comment" style="color:#c6cad2">// omit other rendering</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>ç°åœ¨ï¼Œå¦‚æœæˆ‘ä»¬åœ¨æ•è· React ç»„ä»¶æ€§èƒ½ profile æ—¶å°è¯•ç‚¹å‡»å…¶ä¸­ä¸€ä¸ªå¸–å­ä¸Šçš„ååº”æŒ‰é’®ï¼Œæˆ‘ä»¬åº”è¯¥ä¼šçœ‹åˆ°åªæœ‰ä¸€ä¸ªç»„ä»¶è¿›è¡Œäº†é‡æ–°æ¸²æŸ“ï¼š</p><p><img alt="React DevTools Profiler render capture - optimized &amp;lt;PostsList&amp;gt;" src="/assets/images/postslist-optimized-dcf59b403248250ec88d365fe04221ad.png"></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="è½¬æ¢å…¶ä»–åˆ‡ç‰‡"></a>è½¬æ¢å…¶ä»–åˆ‡ç‰‡<a class="hash-link" href="#è½¬æ¢å…¶ä»–åˆ‡ç‰‡" title="Direct link to heading">#</a></h2><p>æˆ‘ä»¬å¿«å®Œæˆäº†ã€‚ä½œä¸ºæœ€åçš„æ¸…ç†æ­¥éª¤ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ <code>createEntityAdapter</code> æ›´æ–°å…¶ä»–ä¸¤ä¸ªåˆ‡ç‰‡ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="è½¬æ¢ç”¨æˆ·åˆ‡ç‰‡"></a>è½¬æ¢ç”¨æˆ·åˆ‡ç‰‡<a class="hash-link" href="#è½¬æ¢ç”¨æˆ·åˆ‡ç‰‡" title="Direct link to heading">#</a></h3><p><code>usersSlice</code> ç›¸å½“å°ï¼Œæˆ‘ä»¬åªéœ€è¦ä¿®æ”¹ä¸€äº›å†…å®¹ï¼š</p><div class="codeBlockContainer_J+bg"><div style="color:#f8f8f2;background-color:#272822" class="codeBlockTitle_oQzk">features/users/usersSlice.js</div><div class="codeBlockContent_csEI js"><div tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar codeBlockWithTitle_ZT05"><div class="codeBlockLines_1zSZ" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#F8F8F2">{</span><span class="token imports"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token imports">  createSlice</span><span class="token imports punctuation" style="color:#F8F8F2">,</span><span class="token imports"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token imports">  createAsyncThunk</span><span class="token imports punctuation" style="color:#F8F8F2">,</span><span class="token imports"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token imports">  createEntityAdapter</span></div><div class="token-line" style="color:#f8f8f2"><span class="token imports"></span><span class="token imports punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;@reduxjs/toolkit&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#F8F8F2">{</span><span class="token imports"> client </span><span class="token imports punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;../../api/client&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> usersAdapter </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">createEntityAdapter</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> initialState </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> usersAdapter</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">getInitialState</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> fetchUsers </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">createAsyncThunk</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;users/fetchUsers&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">async</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> response </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#F92672">await</span><span class="token plain"> client</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">get</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;/fakeApi/users&#x27;</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#F92672">return</span><span class="token plain"> response</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">users</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> usersSlice </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">createSlice</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token literal-property property" style="color:#F92672">name</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;users&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  initialState</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token literal-property property" style="color:#F92672">reducers</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token literal-property property" style="color:#F92672">extraReducers</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">[</span><span class="token plain">fetchUsers</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">fulfilled</span><span class="token punctuation" style="color:#F8F8F2">]</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> usersAdapter</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">setAll</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">default</span><span class="token plain"> usersSlice</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">reducer</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:#F92672">selectAll</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> selectAllUsers</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> </span><span class="token literal-property property" style="color:#F92672">selectById</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> selectUserById </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  usersAdapter</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">getSelectors</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> state</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">users</span><span class="token punctuation" style="color:#F8F8F2">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>æˆ‘ä»¬åœ¨è¿™é‡Œå¤„ç†çš„å”¯ä¸€æ“ä½œæ˜¯ç”¨ä»æœåŠ¡å™¨è·å–çš„æ•°ç»„æ›¿æ¢æ•´ä¸ªç”¨æˆ·åˆ—è¡¨ã€‚ æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>usersAdapter.setAll</code> æ¥å®ç°ã€‚</p><p><code>&lt;AddPostForm&gt;</code> ä»åœ¨å°† <code>state.users</code> ä½œä¸ºæ•°ç»„è¯»å–ï¼Œ<code>&lt;PostAuthor&gt;</code> ä¹Ÿæ˜¯å¦‚æ­¤ã€‚åˆ†åˆ«ä½¿ç”¨ <code>selectAllUsers</code> å’Œ <code>selectUserById</code>æ›´æ–°å®ƒä»¬ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="è½¬æ¢é€šçŸ¥ç‰‡"></a>è½¬æ¢é€šçŸ¥ç‰‡<a class="hash-link" href="#è½¬æ¢é€šçŸ¥ç‰‡" title="Direct link to heading">#</a></h3><p>æœ€åä½†åŒæ ·é‡è¦çš„æ˜¯ï¼Œæˆ‘ä»¬è¿˜å°†æ›´æ–° <code>notificationsSlice</code>ï¼š</p><div class="codeBlockContainer_J+bg"><div style="color:#f8f8f2;background-color:#272822" class="codeBlockTitle_oQzk">features/notifications/notificationsSlice.js</div><div class="codeBlockContent_csEI js"><div tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar codeBlockWithTitle_ZT05"><div class="codeBlockLines_1zSZ" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#F8F8F2">{</span><span class="token imports"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token imports">  createSlice</span><span class="token imports punctuation" style="color:#F8F8F2">,</span><span class="token imports"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token imports">  createAsyncThunk</span><span class="token imports punctuation" style="color:#F8F8F2">,</span><span class="token imports"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token imports">  createEntityAdapter</span></div><div class="token-line" style="color:#f8f8f2"><span class="token imports"></span><span class="token imports punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;@reduxjs/toolkit&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#F8F8F2">{</span><span class="token imports"> client </span><span class="token imports punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;../../api/client&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> notificationsAdapter </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">createEntityAdapter</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token function-variable function" style="color:#E6D874">sortComparer</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">a</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> b</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> b</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">date</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">localeCompare</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">a</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">date</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:#c6cad2">// omit fetchNotifications thunk</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> notificationsSlice </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">createSlice</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token literal-property property" style="color:#F92672">name</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;notifications&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token literal-property property" style="color:#F92672">initialState</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> notificationsAdapter</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">getInitialState</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token literal-property property" style="color:#F92672">reducers</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token function" style="color:#E6D874">allNotificationsRead</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token known-class-name class-name">Object</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">values</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">state</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">entities</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">forEach</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">notification</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">        notification</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">read</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token boolean" style="color:#AE81FF">true</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token literal-property property" style="color:#F92672">extraReducers</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">[</span><span class="token plain">fetchNotifications</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">fulfilled</span><span class="token punctuation" style="color:#F8F8F2">]</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token known-class-name class-name">Object</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">values</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">state</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">entities</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">forEach</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">notification</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token comment" style="color:#c6cad2">// Any notifications we&#x27;ve read are no longer new</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">        notification</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">isNew</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">!</span><span class="token plain">notification</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">read</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">      notificationsAdapter</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">upsertMany</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">state</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> action</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">payload</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> allNotificationsRead </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> notificationsSlice</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">actions</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">default</span><span class="token plain"> notificationsSlice</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">reducer</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:#F92672">selectAll</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> selectAllNotifications </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  notificationsAdapter</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">getSelectors</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> state</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">notifications</span><span class="token punctuation" style="color:#F8F8F2">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>æˆ‘ä»¬å†æ¬¡å¯¼å…¥<code>createEntityAdapter</code> å¹¶è°ƒç”¨å®ƒï¼Œç„¶åè°ƒç”¨ <code>notificationsAdapter.getInitialState()</code> æ¥è®¾ç½®åˆ‡ç‰‡ã€‚</p><p>å…·æœ‰è®½åˆºæ„å‘³çš„æ˜¯ï¼Œæˆ‘ä»¬ç¡®å®æœ‰å‡ ä¸ªåœ°æ–¹éœ€è¦å¾ªç¯æ‰€æœ‰é€šçŸ¥å¯¹è±¡å¹¶æ›´æ–°å®ƒä»¬ã€‚ç”±äºè¿™äº›ä¸å†ä¿å­˜åœ¨æ•°ç»„ä¸­ï¼Œæˆ‘ä»¬å¿…é¡»ä½¿ç”¨ Object.values(state.entities) æ¥è·å–è¿™äº›é€šçŸ¥çš„æ•°ç»„å¹¶å¯¹å…¶è¿›è¡Œå¾ªç¯ã€‚ å¦ä¸€æ–¹é¢ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ <code>notificationsAdapter.upsertMany</code> æ›¿æ¢ä¹‹å‰çš„ fetch æ›´æ–°é€»è¾‘ã€‚</p><p>å°±è¿™æ ·......æˆ‘ä»¬å®Œæˆäº†ï¼</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="ä½ å­¦åˆ°äº†"></a>ä½ å­¦åˆ°äº†<a class="hash-link" href="#ä½ å­¦åˆ°äº†" title="Direct link to heading">#</a></h2><p>æ­å–œï¼Œä½ å·²ç»å®Œæˆäº† Redux Essentials æ•™ç¨‹ï¼ è®©æˆ‘ä»¬çœ‹çœ‹æœ€ç»ˆåº”ç”¨çš„å®é™…æ•ˆæœï¼š</p><iframe class="codesandbox" src="https://codesandbox.io/embed/github/reduxjs/redux-essentials-example-app/tree/checkpoint-4-entitySlices/?fontsize=14&amp;hidenavigation=1&amp;theme=dark&amp;runonclick=1" title="redux-essentials-example-app" allow="geolocation; microphone; camera; midi; vr; accelerometer; gyroscope; payment; ambient-light-sensor; encrypted-media; usb" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin"></iframe><p>ä»¥ä¸‹æ˜¯æˆ‘ä»¬åœ¨æœ¬èŠ‚ä¸­ä»‹ç»çš„å†…å®¹ï¼š</p><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>æ€»ç»“</h5></div><div class="admonition-content"><ul><li><strong>å¯ç”¨äºä¼˜åŒ–æ€§èƒ½çš„è®°å¿†åŒ– selector å‡½æ•°</strong><ul><li>Redux Toolkit é‡æ–°å¯¼å‡ºäº† Reselect ä¸­çš„ <code>createSelector</code> å‡½æ•°ï¼Œè¯¥å‡½æ•°ä¼šç”Ÿæˆè®°å¿†åŒ–çš„ selector</li><li>åªæœ‰å½“è¾“å…¥ selector è¿”å›æ–°çš„å€¼æ—¶ï¼Œè®°å¿† selector æ‰ä¼šé‡æ–°è®¡ç®—ç»“æœ</li><li>è®°å¿†åŒ–å¯ä»¥è·³è¿‡æ˜‚è´µçš„è®¡ç®—ï¼Œå¹¶ç¡®ä¿è¿”å›ç›¸åŒçš„ç»“æœå¼•ç”¨</li></ul></li><li><strong>å¯ä»¥ä½¿ç”¨å¤šç§æ–¹å¼æ¥ä¼˜åŒ–ä½¿ç”¨äº† Redux çš„ React ç»„ä»¶çš„æ¸²æŸ“</strong><ul><li>é¿å…åœ¨ <code>useSelector</code> ä¸­åˆ›å»ºæ–°çš„å¯¹è±¡/æ•°ç»„å¼•ç”¨â€”â€”è¿™å°†å¯¼è‡´ä¸å¿…è¦çš„é‡æ–°æ¸²æŸ“</li><li>å¯ä»¥ä¼ é€’è®°å¿†åŒ–çš„ selector å‡½æ•°ç»™<code>useSelector</code>æ¥ä¼˜åŒ–æ¸²æŸ“</li><li><code>useSelector</code> å¯ä»¥æ¥å—æ¯”è¾ƒå‡½æ•°ï¼Œä¾‹å¦‚ <code>shallowEqual</code>ï¼Œè€Œä¸æ˜¯å¼•ç”¨ç›¸ç­‰</li><li>ç»„ä»¶å¯ä»¥åŒ…è£…åœ¨ <code>React.memo()</code> ä¸­ï¼Œä»…åœ¨å®ƒä»¬çš„ prop å‘ç”Ÿå˜åŒ–æ—¶é‡æ–°æ¸²æŸ“</li><li>åˆ—è¡¨æ¸²æŸ“å¯ä»¥é€šè¿‡è®©åˆ—è¡¨çˆ¶ç»„ä»¶ä»…è¯»å–æ¯é¡¹çš„ ID ç»„æˆçš„æ•°ç»„ã€å°† ID ä¼ é€’ç»™åˆ—è¡¨é¡¹å­é¡¹å¹¶åœ¨å­é¡¹ä¸­æŒ‰ ID æ£€ç´¢é¡¹æ¥å®ç°ä¼˜åŒ–</li></ul></li><li><strong>èŒƒå¼åŒ– state ç»“æ„æ˜¯å­˜å‚¨é¡¹çš„æ¨èæ–¹æ³•</strong><ul><li>â€œèŒƒå¼åŒ–â€æ„å‘³ç€ä¸é‡å¤æ•°æ®ï¼Œå¹¶é€šè¿‡ ID å°†é¡¹ç›®å­˜å‚¨åœ¨æŸ¥æ‰¾è¡¨ä¸­</li><li>èŒƒå¼åŒ– state å½¢å¼é€šå¸¸çœ‹èµ·æ¥åƒ <code>{ids: [], entities: {}}</code></li></ul></li><li><strong>Redux Toolkit çš„ <code>createEntityAdapter</code> API å¸®åŠ©ç®¡ç†åˆ‡ç‰‡ä¸­çš„èŒƒå¼åŒ–æ•°æ®</strong><ul><li>é€šè¿‡ä¼ å…¥ <code>sortComparer</code> é€‰é¡¹ï¼Œå¯ä»¥æŒ‰æ’åºé¡ºåºä¿æŒé¡¹ç›® ID</li><li>adapter å¯¹è±¡åŒ…æ‹¬ï¼š<ul><li><code>adapter.getInitialState</code>ï¼Œå®ƒå¯ä»¥æ¥å—é¢å¤–çš„ state å­—æ®µï¼Œå¦‚åŠ è½½ state</li><li>é¢„å…ˆåˆ›å»ºé€šç”¨ reducerï¼Œä¾‹å¦‚ <code>setAll</code>ã€<code>addMany</code>ã€<code>upsertOne</code> å’Œ <code>removeMany</code></li><li><code>adapter.getSelectors</code>ï¼Œç”Ÿæˆç±»ä¼¼äº <code>selectAll</code> å’Œ <code>selectById</code> çš„ selector</li></ul></li></ul></li></ul></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="ä¸‹ä¸€æ­¥"></a>ä¸‹ä¸€æ­¥<a class="hash-link" href="#ä¸‹ä¸€æ­¥" title="Direct link to heading">#</a></h2><p>æˆ‘ä»¬åœ¨æœ¬æ•™ç¨‹ä¸­ä»‹ç»çš„æ¦‚å¿µåº”è¯¥è¶³ä»¥è®©æ‚¨å¼€å§‹ä½¿ç”¨ React å’Œ Redux æ„å»ºè‡ªå·±çš„åº”ç”¨ç¨‹åºã€‚ç°åœ¨æ˜¯å°è¯•è‡ªå·±è¿›è¡Œé¡¹ç›®ä»¥å·©å›ºè¿™äº›æ¦‚å¿µå¹¶äº†è§£å®ƒä»¬åœ¨å®è·µä¸­å¦‚ä½•å·¥ä½œçš„å¥½æ—¶æœºã€‚å¦‚æœæ‚¨ä¸ç¡®å®šè¦æ„å»ºä»€ä¹ˆæ ·çš„é¡¹ç›®ï¼Œè¯·å‚é˜… <a href="https://github.com/florinpop17/app-ideas" target="_blank" rel="noopener noreferrer">åº”ç”¨é¡¹ç›®åˆ›æ„åˆ—è¡¨</a> ä»¥è·å¾—ä¸€äº›çµæ„Ÿã€‚</p><p>Redux å¾ªåºæ¸è¿›æ•™ç¨‹ä¾§é‡äºâ€œå¦‚ä½•æ­£ç¡®ä½¿ç”¨ Reduxâ€ï¼Œè€Œä¸æ˜¯â€œå®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„â€æˆ–â€œä¸ºä»€ä¹ˆå®ƒä¼šè¿™æ ·å·¥ä½œâ€ã€‚ç‰¹åˆ«æ˜¯ï¼ŒRedux Toolkit æ˜¯ä¸€ç»„æ›´é«˜çº§åˆ«çš„æŠ½è±¡å’Œå®ç”¨ç¨‹åºï¼Œå®ƒæœ‰åŠ©äºç†è§£ RTK ä¸­çš„æŠ½è±¡å®é™…ä¸Šä¸ºæ‚¨åšäº†ä»€ä¹ˆã€‚é€šè¯» <a href="/tutorials/fundamentals/part-1-overview">&quot;Redux åŸºç¡€&quot; æ•™ç¨‹</a> å°†å¸®åŠ©æ‚¨äº†è§£å¦‚ä½•â€œæ‰‹åŠ¨â€ç¼–å†™ Redux ä»£ç ï¼Œä»¥åŠä¸ºä»€ä¹ˆæˆ‘ä»¬æ¨è Redux Toolkit ä½œä¸ºç¼–å†™ Redux é€»è¾‘çš„é»˜è®¤æ–¹å¼ã€‚</p><p><a href="/recipes/recipe-index">Recipes</a> éƒ¨åˆ†åŒ…å«æœ‰å…³è®¸å¤šé‡è¦æ¦‚å¿µçš„ä¿¡æ¯ï¼Œä¾‹å¦‚ <a href="/recipes/structuring-reducers/structuring-reducers">å¦‚ä½•æ„å»º reducer</a> å’Œ <a href="/style-guide/style-guide">æˆ‘ä»¬çš„æ ·å¼æŒ‡å—é¡µé¢</a> åŒ…å«æœ‰å…³æ¨èæ¨¡å¼å’Œæœ€ä½³å®è·µçš„é‡è¦ä¿¡æ¯ã€‚</p><p>å¦‚æœæ‚¨æƒ³äº†è§£æ›´å¤šå…³äº Redux å­˜åœ¨çš„åŸå› ã€å®ƒè¯•å›¾è§£å†³çš„é—®é¢˜ä»¥åŠç”¨é€”ï¼Œè¯·å‚é˜… Redux ç»´æŠ¤è€… Mark Erikson åœ¨ <a href="https://blog.isquaredsoftware.com/2017/05/idiomatic-redux-tao-of-redux-part-1/" target="_blank" rel="noopener noreferrer">The Tao of Redux, Part 1: Implementation and Intent</a> ä¸Šçš„å¸–å­å’Œ<a href="https://blog.isquaredsoftware.com/2017/05/idiomatic-redux-tao-of-redux-part-2/" target="_blank" rel="noopener noreferrer">Redux ä¹‹é“ï¼Œç¬¬ 2 éƒ¨åˆ†ï¼šå®è·µä¸å“²å­¦</a>ã€‚</p><p>å¦‚æœæ‚¨æ­£åœ¨å¯»æ±‚æœ‰å…³ Redux é—®é¢˜çš„å¸®åŠ©ï¼Œè¯·åŠ å…¥ <a href="https://www.reactiflux.com" target="_blank" rel="noopener noreferrer">Discord ä¸Š Reactiflux æœåŠ¡å™¨ä¸­çš„ <code>#redux</code> é¢‘é“</a></p><p><strong>æ„Ÿè°¢æ‚¨é˜…è¯»æœ¬æ•™ç¨‹ï¼Œæˆ‘ä»¬å¸Œæœ›æ‚¨å–œæ¬¢ä½¿ç”¨ Redux æ„å»ºåº”ç”¨ç¨‹åºï¼</strong></p></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/tutorials/essentials/part-5-async-logic"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« ç¬¬äº”èŠ‚ï¼šå¼‚æ­¥é€»è¾‘ä¸æ•°æ®è¯·æ±‚</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/tutorials/fundamentals/part-1-overview"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Redux æ·±å…¥æµ…å‡º, ç¬¬ä¸€èŠ‚ï¼šRedux æ¦‚è§ˆ Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#ç®€ä»‹" class="table-of-contents__link">ç®€ä»‹</a></li><li><a href="#æ·»åŠ ç”¨æˆ·é¡µé¢" class="table-of-contents__link">æ·»åŠ ç”¨æˆ·é¡µé¢</a></li><li><a href="#æ·»åŠ é€šçŸ¥" class="table-of-contents__link">æ·»åŠ é€šçŸ¥</a><ul><li><a href="#é€šçŸ¥åˆ‡ç‰‡" class="table-of-contents__link">é€šçŸ¥åˆ‡ç‰‡</a></li><li><a href="#thunk-å‚æ•°" class="table-of-contents__link">Thunk å‚æ•°</a></li><li><a href="#æ·»åŠ é€šçŸ¥åˆ—è¡¨" class="table-of-contents__link">æ·»åŠ é€šçŸ¥åˆ—è¡¨</a></li><li><a href="#æ˜¾ç¤ºæ–°é€šçŸ¥" class="table-of-contents__link">æ˜¾ç¤ºæ–°é€šçŸ¥</a></li></ul></li><li><a href="#æå‡æ¸²æŸ“æ€§èƒ½" class="table-of-contents__link">æå‡æ¸²æŸ“æ€§èƒ½</a><ul><li><a href="#è°ƒç ”æ¸²æŸ“è¡Œä¸º" class="table-of-contents__link">è°ƒç ”æ¸²æŸ“è¡Œä¸º</a></li><li><a href="#è®°å¿†åŒ–çš„-selector-å‡½æ•°" class="table-of-contents__link">è®°å¿†åŒ–çš„ Selector å‡½æ•°</a></li><li><a href="#è°ƒç ”å¸–å­åˆ—è¡¨" class="table-of-contents__link">è°ƒç ”å¸–å­åˆ—è¡¨</a></li></ul></li><li><a href="#èŒƒå¼åŒ–æ•°æ®" class="table-of-contents__link">èŒƒå¼åŒ–æ•°æ®</a><ul><li><a href="#èŒƒå¼åŒ–-state-ç»“æ„" class="table-of-contents__link">èŒƒå¼åŒ– State ç»“æ„</a></li><li><a href="#ä½¿ç”¨-createentityadapter-ç®¡ç†èŒƒå¼åŒ–-state" class="table-of-contents__link">ä½¿ç”¨&#39; createEntityAdapter &#39;ç®¡ç†èŒƒå¼åŒ– state</a></li><li><a href="#æ›´æ–°å¸–å­åˆ‡ç‰‡" class="table-of-contents__link">æ›´æ–°å¸–å­åˆ‡ç‰‡</a></li><li><a href="#ä¼˜åŒ–å¸–å­åˆ—è¡¨" class="table-of-contents__link">ä¼˜åŒ–å¸–å­åˆ—è¡¨</a></li></ul></li><li><a href="#è½¬æ¢å…¶ä»–åˆ‡ç‰‡" class="table-of-contents__link">è½¬æ¢å…¶ä»–åˆ‡ç‰‡</a><ul><li><a href="#è½¬æ¢ç”¨æˆ·åˆ‡ç‰‡" class="table-of-contents__link">è½¬æ¢ç”¨æˆ·åˆ‡ç‰‡</a></li><li><a href="#è½¬æ¢é€šçŸ¥ç‰‡" class="table-of-contents__link">è½¬æ¢é€šçŸ¥ç‰‡</a></li></ul></li><li><a href="#ä½ å­¦åˆ°äº†" class="table-of-contents__link">ä½ å­¦åˆ°äº†</a></li><li><a href="#ä¸‹ä¸€æ­¥" class="table-of-contents__link">ä¸‹ä¸€æ­¥</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/introduction/getting-started">å…¥é—¨</a></li><li class="footer__item"><a class="footer__link-item" href="/tutorials/essentials/part-1-overview-concepts">æ•™ç¨‹</a></li><li class="footer__item"><a class="footer__link-item" href="/faq">å¸¸è§é—®é¢˜</a></li><li class="footer__item"><a class="footer__link-item" href="/api/api-reference">API æ–‡æ¡£</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">ç¤¾åŒº</h4><ul class="footer__items"><li class="footer__item"><a href="https://discord.gg/0ZcbPKXt5bZ6au5t" target="_blank" rel="noopener noreferrer" class="footer__link-item">Reactiflux Discord</a></li><li class="footer__item"><a href="http://stackoverflow.com/questions/tagged/redux" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow</a></li><li class="footer__item"><a class="footer__link-item" href="/introduction/getting-started#help-and-discussion">Feedback</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">æ›´å¤š</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/camsong/redux-in-chinese" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li><li class="footer__item">
                <a href="https://www.netlify.com">
                  <img src="https://www.netlify.com/img/global/badges/netlify-color-accent.svg" alt="Deploys by Netlify">
                </a>
              </li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://redux.js.org/" target="_blank" rel="noopener noreferrer" class="footerLogoLink_SRtH"><img src="/img/redux.svg" alt="Redux Logo" class="themedImage_TMUO themedImage--light_4Vu1 footer__logo"><img src="/img/redux.svg" alt="Redux Logo" class="themedImage_TMUO themedImage--dark_uzRr footer__logo"></a></div><div class="footer__copyright">Copyright Â© 2015â€“2022 Dan Abramov and Cam Song.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.9044bd3c.js"></script>
<script src="/assets/js/main.983ddc03.js"></script>
</body>
</html>