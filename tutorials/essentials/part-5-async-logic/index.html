<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.0">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Redux ä¸­æ–‡å®˜ç½‘ Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Redux ä¸­æ–‡å®˜ç½‘ Blog Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-66122997-1","auto"),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="search" type="application/opensearchdescription+xml" title="Redux ä¸­æ–‡å®˜ç½‘" href="/opensearch.xml"><title data-react-helmet="true">Redux å¾ªåºæ¸è¿›ï¼Œç¬¬äº”èŠ‚ï¼šå¼‚æ­¥é€»è¾‘ä¸æ•°æ®è¯·æ±‚ | Redux ä¸­æ–‡å®˜ç½‘</title><meta data-react-helmet="true" property="og:url" content="http://cn.redux.js.org/tutorials/essentials/part-5-async-logic"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Redux å¾ªåºæ¸è¿›ï¼Œç¬¬äº”èŠ‚ï¼šå¼‚æ­¥é€»è¾‘ä¸æ•°æ®è¯·æ±‚ | Redux ä¸­æ–‡å®˜ç½‘"><meta data-react-helmet="true" name="description" content="The official Redux Essentials tutorial: learn how async logic works in Redux apps"><meta data-react-helmet="true" property="og:description" content="The official Redux Essentials tutorial: learn how async logic works in Redux apps"><meta data-react-helmet="true" property="og:image" content="http://cn.redux.js.org/img/redux-logo-landscape.png"><meta data-react-helmet="true" name="twitter:image" content="http://cn.redux.js.org/img/redux-logo-landscape.png"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon/favicon.ico"><link data-react-helmet="true" rel="canonical" href="http://cn.redux.js.org/tutorials/essentials/part-5-async-logic"><link data-react-helmet="true" rel="alternate" href="http://cn.redux.js.org/tutorials/essentials/part-5-async-logic" hreflang="en"><link data-react-helmet="true" rel="alternate" href="http://cn.redux.js.org/tutorials/essentials/part-5-async-logic" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.01e0d58b.css">
<link rel="preload" href="/assets/js/runtime~main.58bdc742.js" as="script">
<link rel="preload" href="/assets/js/main.3f741185.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/redux.svg" alt="Redux Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/redux.svg" alt="Redux Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Redux ä¸­æ–‡å®˜ç½‘</strong></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/introduction/getting-started">å…¥é—¨</a><a class="navbar__item navbar__link" href="/tutorials/essentials/part-1-overview-concepts">æ•™ç¨‹</a><a class="navbar__item navbar__link" href="/api/api-reference">API</a><a class="navbar__item navbar__link" href="/faq">å¸¸è§é—®é¢˜</a><a class="navbar__item navbar__link" href="/style-guide/style-guide">æœ€ä½³å®è·µ</a><a href="https://www.github.com/camsong/redux-in-chinese" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">æºç </a><a href="https://github.com/camsong/redux-in-chinese/issues" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">çº é”™</a><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--disabled" role="button" tabindex="-1"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT">ğŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ğŸŒ</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/redux.svg" alt="Redux Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/redux.svg" alt="Redux Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Redux ä¸­æ–‡å®˜ç½‘</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/introduction/getting-started">å…¥é—¨</a></li><li class="menu__list-item"><a class="menu__link" href="/tutorials/essentials/part-1-overview-concepts">æ•™ç¨‹</a></li><li class="menu__list-item"><a class="menu__link" href="/api/api-reference">API</a></li><li class="menu__list-item"><a class="menu__link" href="/faq">å¸¸è§é—®é¢˜</a></li><li class="menu__list-item"><a class="menu__link" href="/style-guide/style-guide">æœ€ä½³å®è·µ</a></li><li class="menu__list-item"><a href="https://www.github.com/camsong/redux-in-chinese" target="_blank" rel="noopener noreferrer" class="menu__link">æºç </a></li><li class="menu__list-item"><a href="https://github.com/camsong/redux-in-chinese/issues" target="_blank" rel="noopener noreferrer" class="menu__link">çº é”™</a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><div class="docSidebarContainer_3Kbt" role="complementary"><div class="sidebar_15mo"><div class="menu menu--responsive thin-scrollbar menu_Bmed"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">ç®€ä»‹</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/introduction/getting-started">å…¥é—¨ Redux</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/introduction/installation">å®‰è£…</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/introduction/core-concepts">æ ¸å¿ƒæ¦‚å¿µ</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/introduction/learning-resources">å­¦ä¹ èµ„æº</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/introduction/ecosystem">ç”Ÿæ€</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/introduction/examples">ç¤ºä¾‹</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">æ•™ç¨‹</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/tutorials/index">æ•™ç¨‹ç›®å½•</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">Redux å¾ªåºæ¸è¿›</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/tutorials/essentials/part-1-overview-concepts">åŸºç¡€æ¦‚å¿µ</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/tutorials/essentials/part-2-app-structure">åº”ç”¨ç»“æ„</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/tutorials/essentials/part-3-data-flow">æ•°æ®æµåŸºç¡€</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/tutorials/essentials/part-4-using-data">ä½¿ç”¨æ•°æ®</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/tutorials/essentials/part-5-async-logic">å¼‚æ­¥é€»è¾‘ä¸æ•°æ®è¯·æ±‚</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/tutorials/essentials/part-6-performance-normalization">æ€§èƒ½ä¸æ•°æ®èŒƒå¼åŒ–</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Redux æ·±å…¥æµ…å‡º</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/tutorials/fundamentals/part-1-overview">Redux Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/tutorials/fundamentals/part-2-concepts-data-flow">Redux Concepts and Data Flow</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/tutorials/fundamentals/part-3-state-actions-reducers">State, Actions, and Reducers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/tutorials/fundamentals/part-4-store">Store</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/tutorials/fundamentals/part-5-ui-react">UI and React</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/tutorials/fundamentals/part-6-async-logic">Async Logic and Data Fetching</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/tutorials/fundamentals/part-7-standard-patterns">Standard Redux Patterns</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/tutorials/fundamentals/part-8-modern-redux">Modern Redux with Redux Toolkit</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">æŠ€å·§</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/recipe-index">æŠ€å·§</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/configuring-your-store">é…ç½® Store</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/usage-with-typescript">Usage with TypeScript</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/migrating-to-redux">è¿ç§»åˆ° Redux</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/using-object-spread-operator">ä½¿ç”¨å¯¹è±¡å±•å¼€è¿ç®—ç¬¦</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/reducing-boilerplate">å‡å°‘æ ·æ¿ä»£ç </a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/server-rendering">æœåŠ¡ç«¯æ¸²æŸ“</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/writing-tests">ç¼–å†™æµ‹è¯•</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/computing-derived-data">è®¡ç®—è¡ç”Ÿæ•°æ®</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/implementing-undo-history">å®ç°æ’¤é”€é‡åš</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/isolating-redux-sub-apps">å­åº”ç”¨éš”ç¦»</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/code-splitting">ä»£ç åˆ†å‰²</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/troubleshooting">Troubleshooting</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">ç»„ç»‡ Reducers</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/structuring-reducers/structuring-reducers">ç»„ç»‡ Reducer</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/structuring-reducers/prerequisite-concepts">Reducer å¿…å¤‡æ¦‚å¿µ</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/structuring-reducers/basic-reducer-structure">Reducer å’Œ State çš„åŸºæœ¬ç»“æ„</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/structuring-reducers/splitting-reducer-logic">æ‹†åˆ† Reducer é€»è¾‘</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/structuring-reducers/refactoring-reducer-example">é‡æ„ Reducerï¼šåŸºäºå‡½æ•°åˆ†è§£ï¼ˆFunctional Decompositionï¼‰å’Œ Reducer ç»„åˆ</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/structuring-reducers/using-combinereducers">`combineReducers` ç”¨æ³•</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/structuring-reducers/beyond-combinereducers">`combineReducers` è¿›é˜¶</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/structuring-reducers/normalizing-state-shape">State èŒƒå¼åŒ–</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/structuring-reducers/updating-normalized-data">ç®¡ç†èŒƒå¼åŒ–æ•°æ®</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/structuring-reducers/reusing-reducer-logic">Reducer é€»è¾‘å¤ç”¨</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/structuring-reducers/immutable-update-patterns">Immutable ä¸å¯å˜æ›´æ–°æ¨¡å¼</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/recipes/structuring-reducers/initializing-state">åˆå§‹åŒ– State</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">æ·±å…¥ç†è§£ Redux</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">åƒ Redux ä¸€æ ·æ€è€ƒ</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/understanding/thinking-in-redux/motivation">åŠ¨æœº</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/understanding/thinking-in-redux/three-principles">ä¸‰å¤§åŸåˆ™</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/understanding/thinking-in-redux/glossary">è¯æ±‡è¡¨</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">å†å²ä¸è®¾è®¡åŸåˆ™</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/understanding/history-and-design/prior-art">å…ˆå‰æŠ€æœ¯</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/understanding/history-and-design/middleware">Middleware ä¸­é—´ä»¶</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">å¸¸è§é—®é¢˜</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/faq">Redux FAQ</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/faq/general">Redux FAQ: General</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/faq/reducers">Redux FAQ: Reducers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/faq/organizing-state">Redux FAQ: Organizing State</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/faq/store-setup">Redux FAQ: Store Setup</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/faq/actions">Redux FAQ: Actions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/faq/immutable-data">Redux FAQ: Immutable Data</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/faq/code-structure">Redux FAQ: Code Structure</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/faq/performance">Redux FAQ: Performance</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/faq/design-decisions">Redux FAQ: Design Decisions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/faq/react-redux">Redux FAQ: React Redux</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/faq/miscellaneous">Redux FAQ: Miscellaneous</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">ç¼–ç è§„èŒƒ</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/style-guide/style-guide">Style Guide: Best Practices</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">API æ–‡æ¡£</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/api/api-reference">API Reference</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/api/createstore">createStore</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/api/store">Store</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/api/combinereducers">combineReducers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/api/applymiddleware">applyMiddleware</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/api/bindactioncreators">bindActionCreators</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/api/compose">compose</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Redux Toolkit</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/redux-toolkit/overview">Redux Toolkit: æ¦‚è§ˆ</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3ufF"><div class="container padding-vert--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><header><h1 class="docTitle_3a4h">ç¬¬äº”èŠ‚ï¼šå¼‚æ­¥é€»è¾‘ä¸æ•°æ®è¯·æ±‚</h1></header><div class="markdown"><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>ä½ å°†å­¦åˆ°</h5></div><div class="admonition-content"><ul><li>å¦‚ä½•ä½¿ç”¨ Redux â€œthunkâ€ ä¸­é—´ä»¶å¤„ç†å¼‚æ­¥é€»è¾‘</li><li>å¤„ç†å¼‚æ­¥è¯·æ±‚çŠ¶æ€çš„å¼€å‘æ¨¡å¼</li><li>å¦‚ä½•ä½¿ç”¨ Redux Toolkit <code>createAsyncThunk</code> API æ¥ç®€åŒ–å¼‚æ­¥è°ƒç”¨</li></ul></div></div><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>å¿…å¤‡èƒ½åŠ›</h5></div><div class="admonition-content"><ul><li>ç†Ÿæ‚‰ä½¿ç”¨ AJAX è¯·æ±‚ä»æœåŠ¡å™¨è·å–å’Œæ›´æ–°æ•°æ®</li></ul></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="ç®€ä»‹"></a>ç®€ä»‹<a class="hash-link" href="#ç®€ä»‹" title="Direct link to heading">#</a></h2><p>åœ¨ <a href="/tutorials/essentials/part-4-using-data">ç¬¬å››èŠ‚ï¼šä½¿ç”¨ Redux æ•°æ®</a> ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°äº†å¦‚ä½•ä½¿ç”¨ React ç»„ä»¶å†…éƒ¨ Redux store ä¸­çš„å¤šæ¡æ•°æ®ï¼Œåœ¨å®ƒä»¬ dispatch ä¹‹å‰è‡ªå®šä¹‰ action å¯¹è±¡çš„å†…å®¹ï¼Œå¹¶åœ¨æˆ‘ä»¬çš„ reducer ä¸­å¤„ç†æ›´å¤æ‚çš„æ›´æ–°é€»è¾‘ã€‚</p><p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å¤„ç†è¿‡çš„æ‰€æœ‰æ•°æ®éƒ½ç›´æ¥å­˜åœ¨äºæˆ‘ä»¬çš„ React å®¢æˆ·ç«¯åº”ç”¨ç¨‹åºä¸­ã€‚ç„¶è€Œï¼Œå¤§å¤šæ•°çœŸå®çš„åº”ç”¨ç¨‹åºéœ€è¦ä½¿ç”¨æ¥è‡ªæœåŠ¡å™¨çš„æ•°æ®ï¼Œé€šè¿‡è°ƒç”¨ HTTP API æ¥è·å–å’Œä¿å­˜é¡¹ç›®ã€‚</p><p>åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†è½¬æ¢æˆ‘ä»¬çš„ç¤¾äº¤åª’ä½“åº”ç”¨ç¨‹åºä»¥ä» API è·å–å¸–å­å’Œç”¨æˆ·æ•°æ®ï¼Œå¹¶é€šè¿‡å°†å®ƒä»¬ä¿å­˜åˆ° API æ¥æ·»åŠ æ–°å¸–å­ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="rest-api-å’Œå®¢æˆ·ç«¯ç¤ºä¾‹"></a>REST API å’Œå®¢æˆ·ç«¯ç¤ºä¾‹<a class="hash-link" href="#rest-api-å’Œå®¢æˆ·ç«¯ç¤ºä¾‹" title="Direct link to heading">#</a></h3><p>ä¸ºäº†ä½¿ç¤ºä¾‹é¡¹ç›®ä¿æŒç‹¬ç«‹ä½†åˆ‡åˆå®é™…ï¼Œåˆå§‹é¡¹ç›®è®¾ç½®å·²ç»ä¸ºæˆ‘ä»¬çš„æ•°æ®åŒ…å«äº†ä¸€ä¸ªä¼ªé€ çš„å†…å­˜ REST APIï¼ˆä½¿ç”¨ <a href="https://miragejs.com/" target="_blank" rel="noopener noreferrer">Mirage.js æ¨¡æ‹Ÿ API å·¥å…·</a> è¿›è¡Œé…ç½®ï¼‰ã€‚API ä½¿ç”¨ <code>/fakeApi</code> ä½œä¸ºç«¯ç‚¹çš„åŸºæœ¬ URLï¼Œå¹¶æ”¯æŒå…¸å‹çš„ <code>GET/POST/PUT/DELETE</code> HTTP æ–¹æ³•ç”¨äº <code>/fakeApi/posts</code>ã€<code>/fakeApi/users</code> å’Œ <code>fakeApi/notifications </code>. å®ƒåœ¨<code>src/api/server.js</code> ä¸­å®šä¹‰ã€‚</p><p>è¯¥é¡¹ç›®è¿˜åŒ…æ‹¬ä¸€ä¸ªå°çš„ HTTP API å®¢æˆ·ç«¯å¯¹è±¡ï¼Œå®ƒå…¬å¼€ <code>client.get()</code> å’Œ <code>client.post()</code> æ–¹æ³•ï¼Œç±»ä¼¼äºåƒ <code>axios</code> è¿™æ ·çš„æµè¡Œ HTTP åº“ã€‚å®ƒåœ¨<code>src/api/client.js</code> ä¸­å®šä¹‰ã€‚</p><p>åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ <code>client</code> å¯¹è±¡å¯¹æˆ‘ä»¬çš„å†…å­˜ä¸­å‡ REST API è¿›è¡Œ HTTP è°ƒç”¨ã€‚</p><p>æ­¤å¤–ï¼Œæ¨¡æ‹ŸæœåŠ¡å™¨å·²è®¾ç½®ä¸ºåœ¨æ¯æ¬¡åŠ è½½é¡µé¢æ—¶é‡å¤ä½¿ç”¨ç›¸åŒçš„éšæœºç§å­ï¼Œä»¥ä¾¿ç”Ÿæˆç›¸åŒçš„å‡ç”¨æˆ·å’Œå‡å¸–å­åˆ—è¡¨ã€‚å¦‚æœæ‚¨æƒ³é‡ç½®å®ƒï¼Œè¯·åˆ é™¤æµè§ˆå™¨æœ¬åœ° store ä¸­çš„ <code>randomTimestampSeed</code> å€¼å¹¶é‡æ–°åŠ è½½é¡µé¢ï¼Œæˆ–è€…æ‚¨å¯ä»¥é€šè¿‡ç¼–è¾‘ <code>src/api/server.js</code> å¹¶å°† <code>useSeededRNG</code> è®¾ç½®ä¸º <code>false</code> æ¥å…³é—­å®ƒ.</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>è¯´æ˜</h5></div><div class="admonition-content"><p>æé†’ä¸€ä¸‹ï¼Œä»£ç ç¤ºä¾‹ä¾§é‡äºæ¯ä¸ªéƒ¨åˆ†çš„å…³é”®æ¦‚å¿µå’Œæ›´æ”¹ã€‚è¯·å‚é˜… CodeSandbox é¡¹ç›®å’Œ <a href="https://github.com/reduxjs/redux-essentials-example-app/tree/tutorial-steps" target="_blank" rel="noopener noreferrer">é¡¹ç›® repo ä¸­çš„<code>tutorial-steps</code> åˆ†æ”¯</a> ä»¥äº†è§£åº”ç”¨ç¨‹åºä¸­çš„å®Œæ•´æ›´æ”¹ã€‚</p></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="thunks-ä¸å¼‚æ­¥é€»è¾‘"></a>Thunks ä¸å¼‚æ­¥é€»è¾‘<a class="hash-link" href="#thunks-ä¸å¼‚æ­¥é€»è¾‘" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="ä½¿ç”¨-middleware-ä¸­é—´ä»¶å¤„ç†å¼‚æ­¥é€»è¾‘"></a>ä½¿ç”¨ Middleware ä¸­é—´ä»¶å¤„ç†å¼‚æ­¥é€»è¾‘<a class="hash-link" href="#ä½¿ç”¨-middleware-ä¸­é—´ä»¶å¤„ç†å¼‚æ­¥é€»è¾‘" title="Direct link to heading">#</a></h3><p>å°±å…¶æœ¬èº«è€Œè¨€ï¼ŒRedux store å¯¹å¼‚æ­¥é€»è¾‘ä¸€æ— æ‰€çŸ¥ã€‚å®ƒåªçŸ¥é“å¦‚ä½•åŒæ­¥ dispatch actionï¼Œé€šè¿‡è°ƒç”¨ root reducer å‡½æ•°æ›´æ–°çŠ¶æ€ï¼Œå¹¶é€šçŸ¥ UI æŸäº›äº‹æƒ…å‘ç”Ÿäº†å˜åŒ–ã€‚ä»»ä½•å¼‚æ­¥éƒ½å¿…é¡»å‘ç”Ÿåœ¨ store ä¹‹å¤–ã€‚</p><p>ä½†æ˜¯ï¼Œå¦‚æœæ‚¨å¸Œæœ›é€šè¿‡è°ƒåº¦æˆ–æ£€æŸ¥å½“å‰ store çŠ¶æ€æ¥ä½¿å¼‚æ­¥é€»è¾‘ä¸ store äº¤äº’ï¼Œè¯¥æ€ä¹ˆåŠï¼Ÿ è¿™å°±æ˜¯ <a href="/tutorials/fundamentals/part-4-store#middleware">Redux ä¸­é—´ä»¶</a> çš„ç”¨æ­¦ä¹‹åœ°ã€‚å®ƒä»¬æ‰©å±•äº† storeï¼Œå¹¶å…è®¸æ‚¨ï¼š</p><ul><li>dispatch action æ—¶æ‰§è¡Œé¢å¤–çš„é€»è¾‘ï¼ˆä¾‹å¦‚æ‰“å° action çš„æ—¥å¿—å’ŒçŠ¶æ€ï¼‰</li><li>æš‚åœã€ä¿®æ”¹ã€å»¶è¿Ÿã€æ›¿æ¢æˆ–åœæ­¢ dispatch çš„ action </li><li>ç¼–å†™å¯ä»¥è®¿é—® <code>dispatch</code> å’Œ <code>getState</code> çš„é¢å¤–ä»£ç </li><li>æ•™ <code>dispatch</code> å¦‚ä½•æ¥å—é™¤æ™®é€š action å¯¹è±¡ä¹‹å¤–çš„å…¶ä»–å€¼ï¼Œä¾‹å¦‚å‡½æ•°å’Œ promiseï¼Œé€šè¿‡æ‹¦æˆªå®ƒä»¬å¹¶ dispatch å®é™… action å¯¹è±¡æ¥ä»£æ›¿</li></ul><p>[ä½¿ç”¨ä¸­é—´ä»¶çš„æœ€å¸¸è§åŸå› æ˜¯å…è®¸ä¸åŒç±»å‹çš„å¼‚æ­¥é€»è¾‘ä¸ store äº¤äº’](/faq/actions#how-can-i-represent-side-effects-such-as -ajax-calls-why-do-we-need-things-like-action-creators-thunks-and-middleware-to-do-async-behavior)ã€‚è¿™å…è®¸æ‚¨ç¼–å†™å¯ä»¥ dispatch action å’Œæ£€æŸ¥ store çŠ¶æ€çš„ä»£ç ï¼ŒåŒæ—¶ä½¿è¯¥é€»è¾‘ä¸æ‚¨çš„ UI åˆ†å¼€ã€‚</p><p>Redux æœ‰å¤šç§å¼‚æ­¥ä¸­é—´ä»¶ï¼Œæ¯ä¸€ç§éƒ½å…è®¸æ‚¨ä½¿ç”¨ä¸åŒçš„è¯­æ³•ç¼–å†™é€»è¾‘ã€‚æœ€å¸¸è§çš„å¼‚æ­¥ä¸­é—´ä»¶æ˜¯ <a href="https://github.com/reduxjs/redux-thunk" target="_blank" rel="noopener noreferrer"><code>redux-thunk</code></a>ï¼Œå®ƒå¯ä»¥è®©ä½ ç¼–å†™å¯èƒ½ç›´æ¥åŒ…å«å¼‚æ­¥é€»è¾‘çš„æ™®é€šå‡½æ•°ã€‚Redux Toolkit çš„ <code>configureStore</code> åŠŸèƒ½<a href="https://redux-toolkit.js.org/api/getDefaultMiddleware#included-default-middleware" target="_blank" rel="noopener noreferrer">é»˜è®¤è‡ªåŠ¨è®¾ç½® thunk ä¸­é—´ä»¶</a>ï¼Œ<a href="/style-guide/style-guide#use-thunks-for-async-logic">æˆ‘ä»¬æ¨èä½¿ç”¨ thunk ä½œä¸º Redux å¼€å‘å¼‚æ­¥é€»è¾‘çš„æ ‡å‡†æ–¹å¼</a>ã€‚</p><p>æ—©äº›æ—¶å€™ï¼Œæˆ‘ä»¬çœ‹åˆ°äº†<a href="/tutorials/essentials/part-1-overview-concepts#redux-application-data-flow">Redux çš„åŒæ­¥æ•°æ®æµæ˜¯ä»€ä¹ˆæ ·å­</a>ã€‚å½“æˆ‘ä»¬å¼•å…¥å¼‚æ­¥é€»è¾‘æ—¶ï¼Œæˆ‘ä»¬æ·»åŠ äº†ä¸€ä¸ªé¢å¤–çš„æ­¥éª¤ï¼Œä¸­é—´ä»¶å¯ä»¥è¿è¡Œåƒ AJAX è¯·æ±‚è¿™æ ·çš„é€»è¾‘ï¼Œç„¶å dispatch actionã€‚è¿™ä½¿å¾—å¼‚æ­¥æ•°æ®æµçœ‹èµ·æ¥åƒè¿™æ ·ï¼š</p><p><img alt="Redux å¼‚æ­¥æ•°æ®æµ" src="/assets/images/ReduxAsyncDataFlowDiagram-d97ff38a0f4da0f327163170ccc13e80.gif"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="thunk-å‡½æ•°"></a>Thunk å‡½æ•°<a class="hash-link" href="#thunk-å‡½æ•°" title="Direct link to heading">#</a></h3><p>å°† thunk ä¸­é—´ä»¶æ·»åŠ åˆ° Redux store åï¼Œå®ƒå…è®¸æ‚¨å°† <em>thunk å‡½æ•°</em> ç›´æ¥ä¼ é€’ç»™ <code>store.dispatch</code>ã€‚è°ƒç”¨ thunk å‡½æ•°æ—¶æ€»æ˜¯å°† <code>(dispatch, getState)</code> ä½œä¸ºå®ƒçš„å‚æ•°ï¼Œä½ å¯ä»¥æ ¹æ®éœ€è¦åœ¨ thunk ä¸­ä½¿ç”¨å®ƒä»¬ã€‚</p><p>Thunks é€šå¸¸è¿˜å¯ä»¥ä½¿ç”¨ action creator å†æ¬¡ dispatch æ™®é€šçš„ actionï¼Œæ¯”å¦‚ <code>dispatch(increment())</code>ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> store </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">configureStore</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> reducer</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> counterReducer </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#E6D874">exampleThunkFunction</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">dispatch</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> getState</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> stateBefore </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">getState</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">log</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token template-string template-punctuation string" style="color:#a6e22e">`</span><span class="token template-string string" style="color:#a6e22e">Counter before: </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#F8F8F2">${</span><span class="token template-string interpolation">stateBefore</span><span class="token template-string interpolation punctuation" style="color:#F8F8F2">.</span><span class="token template-string interpolation">counter</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#F8F8F2">}</span><span class="token template-string template-punctuation string" style="color:#a6e22e">`</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token function" style="color:#E6D874">dispatch</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token function" style="color:#E6D874">increment</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> stateAfter </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">getState</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">log</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token template-string template-punctuation string" style="color:#a6e22e">`</span><span class="token template-string string" style="color:#a6e22e">Counter after: </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#F8F8F2">${</span><span class="token template-string interpolation">stateAfter</span><span class="token template-string interpolation punctuation" style="color:#F8F8F2">.</span><span class="token template-string interpolation">counter</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#F8F8F2">}</span><span class="token template-string template-punctuation string" style="color:#a6e22e">`</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">store</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">dispatch</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">exampleThunkFunction</span><span class="token punctuation" style="color:#F8F8F2">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>ä¸ºäº†ä¸ dispatch æ™®é€š action å¯¹è±¡ä¿æŒä¸€è‡´ï¼Œæˆ‘ä»¬é€šå¸¸å°†å®ƒä»¬å†™ä¸º <em>thunk action creators</em>ï¼Œå®ƒè¿”å› thunk å‡½æ•°ã€‚è¿™äº› action creator å¯ä»¥æ¥å—å¯ä»¥åœ¨ thunk ä¸­ä½¿ç”¨çš„å‚æ•°ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#E6D874">logAndAdd</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token parameter">amount</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#F92672">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">dispatch</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> getState</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> stateBefore </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">getState</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">log</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token template-string template-punctuation string" style="color:#a6e22e">`</span><span class="token template-string string" style="color:#a6e22e">Counter before: </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#F8F8F2">${</span><span class="token template-string interpolation">stateBefore</span><span class="token template-string interpolation punctuation" style="color:#F8F8F2">.</span><span class="token template-string interpolation">counter</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#F8F8F2">}</span><span class="token template-string template-punctuation string" style="color:#a6e22e">`</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token function" style="color:#E6D874">dispatch</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token function" style="color:#E6D874">incrementByAmount</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">amount</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> stateAfter </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">getState</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">log</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token template-string template-punctuation string" style="color:#a6e22e">`</span><span class="token template-string string" style="color:#a6e22e">Counter after: </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#F8F8F2">${</span><span class="token template-string interpolation">stateAfter</span><span class="token template-string interpolation punctuation" style="color:#F8F8F2">.</span><span class="token template-string interpolation">counter</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#F8F8F2">}</span><span class="token template-string template-punctuation string" style="color:#a6e22e">`</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">store</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">dispatch</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token function" style="color:#E6D874">logAndAdd</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token number" style="color:#AE81FF">5</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Thunk é€šå¸¸å†™åœ¨â€œåˆ‡ç‰‡â€æ–‡ä»¶ä¸­ã€‚<code>createSlice</code> æœ¬èº«å¯¹å®šä¹‰ thunk æ²¡æœ‰ä»»ä½•ç‰¹æ®Šæ”¯æŒï¼Œå› æ­¤æ‚¨åº”è¯¥å°†å®ƒä»¬ä½œä¸ºå•ç‹¬çš„å‡½æ•°ç¼–å†™åœ¨åŒä¸€ä¸ªåˆ‡ç‰‡æ–‡ä»¶ä¸­ã€‚è¿™æ ·ï¼Œä»–ä»¬å°±å¯ä»¥è®¿é—®è¯¥åˆ‡ç‰‡çš„æ™®é€š action creatorï¼Œå¹¶ä¸”å¾ˆå®¹æ˜“æ‰¾åˆ° thunk çš„ä½ç½®ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="ç¼–å†™å¼‚æ­¥-thunks"></a>ç¼–å†™å¼‚æ­¥ Thunks<a class="hash-link" href="#ç¼–å†™å¼‚æ­¥-thunks" title="Direct link to heading">#</a></h3><p>Thunk å†…éƒ¨å¯èƒ½æœ‰å¼‚æ­¥é€»è¾‘ï¼Œä¾‹å¦‚ <code>setTimeout</code>ã€<code>Promise</code> å’Œ <code>async/await</code>ã€‚è¿™ä½¿å®ƒä»¬æˆä¸ºå°† AJAX å‘èµ· API è¯·æ±‚çš„å¥½åœ°æ–¹ã€‚</p><p>Redux çš„æ•°æ®è¯·æ±‚é€»è¾‘é€šå¸¸éµå¾ªä»¥ä¸‹å¯é¢„æµ‹çš„æ¨¡å¼ï¼š</p><ul><li>åœ¨è¯·æ±‚ä¹‹å‰ dispatch è¯·æ±‚â€œå¼€å§‹â€ çš„ actionï¼Œä»¥æŒ‡ç¤ºè¯·æ±‚æ­£åœ¨è¿›è¡Œä¸­ã€‚è¿™å¯ç”¨äºè·Ÿè¸ªåŠ è½½çŠ¶æ€ä»¥å…è®¸è·³è¿‡é‡å¤è¯·æ±‚æˆ–åœ¨ UI ä¸­æ˜¾ç¤ºåŠ è½½æŒ‡ç¤ºå™¨ã€‚</li><li>å‘å‡ºå¼‚æ­¥è¯·æ±‚</li><li>æ ¹æ®è¯·æ±‚ç»“æœï¼Œå¼‚æ­¥é€»è¾‘ dispatch åŒ…å«ç»“æœæ•°æ®çš„ â€œæˆåŠŸâ€ action æˆ–åŒ…å«é”™è¯¯è¯¦ç»†ä¿¡æ¯çš„ â€œå¤±è´¥â€ actionã€‚åœ¨è¿™ä¸¤ç§æƒ…å†µä¸‹ï¼Œreducer é€»è¾‘éƒ½ä¼šæ¸…é™¤åŠ è½½çŠ¶æ€ï¼Œå¹¶ä¸”è¦ä¹ˆå±•ç¤ºæˆåŠŸæ¡ˆä¾‹çš„ç»“æœæ•°æ®ï¼Œè¦ä¹ˆä¿å­˜é”™è¯¯å€¼å¹¶åœ¨éœ€è¦çš„åœ°æ–¹å±•ç¤ºã€‚</li></ul><p>è¿™äº›æ­¥éª¤ä¸æ˜¯ <em>å¿…éœ€çš„</em>ï¼Œè€Œæ˜¯å¸¸ç”¨çš„ã€‚ï¼ˆå¦‚æœä½ åªå…³å¿ƒä¸€ä¸ªæˆåŠŸçš„ç»“æœï¼Œä½ å¯ä»¥åœ¨è¯·æ±‚å®Œæˆæ—¶å‘é€ä¸€ä¸ª â€œæˆåŠŸâ€ action ï¼Œå¹¶è·³è¿‡â€œå¼€å§‹â€å’Œâ€œå¤±è´¥â€ action ã€‚ï¼‰</p><p>Redux Toolkit æä¾›äº†ä¸€ä¸ª <code>createAsyncThunk</code> API æ¥å®ç°è¿™äº› action çš„åˆ›å»ºå’Œ dispatchï¼Œæˆ‘ä»¬å¾ˆå¿«å°±ä¼šçœ‹çœ‹å¦‚ä½•ä½¿ç”¨å®ƒã€‚</p><details class="detailed-explanation"><summary><h4>ç»†èŠ‚è¯´æ˜ï¼šDispatching Request Status Actions in Thunks</h4></summary><p>å¦‚æœæˆ‘ä»¬æ‰‹åŠ¨ç¼–å†™ä¸€ä¸ªå…¸å‹çš„ async thunk çš„ä»£ç ï¼Œå®ƒå¯èƒ½çœ‹èµ·æ¥åƒè¿™æ ·ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#E6D874">getRepoDetailsStarted</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  type</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;repoDetails/fetchStarted&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#E6D874">getRepoDetailsSuccess</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token parameter">repoDetails</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  type</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;repoDetails/fetchSucceeded&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  payload</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> repoDetails</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#E6D874">getRepoDetailsFailed</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token parameter">error</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  type</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;repoDetails/fetchFailed&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  error</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#E6D874">fetchIssuesCount</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">org</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> repo</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">async</span><span class="token plain"> </span><span class="token parameter">dispatch</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token function" style="color:#E6D874">dispatch</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token function" style="color:#E6D874">getRepoDetailsStarted</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#F92672">try</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> repoDetails </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#F92672">await</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">getRepoDetails</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">org</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> repo</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token function" style="color:#E6D874">dispatch</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token function" style="color:#E6D874">getRepoDetailsSuccess</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">repoDetails</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#F92672">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token function" style="color:#E6D874">dispatch</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token function" style="color:#E6D874">getRepoDetailsFailed</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">toString</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>ä½†æ˜¯ï¼Œä½¿ç”¨è¿™ç§æ–¹æ³•ç¼–å†™ä»£ç å¾ˆä¹å‘³ã€‚æ¯ä¸ªå•ç‹¬çš„è¯·æ±‚ç±»å‹éƒ½éœ€è¦é‡å¤ç±»ä¼¼çš„å®ç°ï¼š</p><ul><li>éœ€è¦ä¸ºä¸‰ç§ä¸åŒçš„æƒ…å†µå®šä¹‰ç‹¬ç‰¹çš„ action ç±»å‹</li><li>æ¯ç§ action ç±»å‹é€šå¸¸éƒ½æœ‰ç›¸åº”çš„ action creator åŠŸèƒ½</li><li>å¿…é¡»ç¼–å†™ä¸€ä¸ª thunk ä»¥æ­£ç¡®çš„é¡ºåºå‘é€æ­£ç¡®çš„ action</li></ul><p><code>createAsyncThunk</code> å®ç°äº†è¿™å¥—æ¨¡å¼ï¼šé€šè¿‡ç”Ÿæˆ action type å’Œ action creator å¹¶ç”Ÿæˆä¸€ä¸ªè‡ªåŠ¨ dispatch è¿™äº› action çš„ thunkã€‚æ‚¨æä¾›ä¸€ä¸ªå›è°ƒå‡½æ•°æ¥è¿›è¡Œå¼‚æ­¥è°ƒç”¨ï¼Œå¹¶æŠŠç»“æœæ•°æ®è¿”å›æˆ Promiseã€‚</p></details><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="åŠ è½½å¸–å­"></a>åŠ è½½å¸–å­<a class="hash-link" href="#åŠ è½½å¸–å­" title="Direct link to heading">#</a></h2><p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬çš„ <code>postsSlice</code> å·²ç»ä½¿ç”¨äº†ä¸€äº›ç¡¬ç¼–ç çš„æ ·æœ¬æ•°æ®ä½œä¸ºå…¶åˆå§‹çŠ¶æ€ã€‚æˆ‘ä»¬å°†æŠŠå®ƒæ”¹ä¸ºä»ä¸€ä¸ªç©ºçš„å¸–å­æ•°ç»„å¼€å§‹ï¼Œç„¶åä»æœåŠ¡å™¨è·å–ä¸€ä¸ªå¸–å­åˆ—è¡¨ã€‚</p><p>ä¸ºäº†åšåˆ°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å°†ä¸å¾—ä¸æ›´æ”¹ <code>postsSlice</code> ä¸­çš„çŠ¶æ€ç»“æ„ï¼Œä»¥ä¾¿æˆ‘ä»¬å¯ä»¥è·Ÿè¸ª API è¯·æ±‚çš„å½“å‰çŠ¶æ€ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="æå–å¸–å­é€‰æ‹©å™¨"></a>æå–å¸–å­é€‰æ‹©å™¨<a class="hash-link" href="#æå–å¸–å­é€‰æ‹©å™¨" title="Direct link to heading">#</a></h3><p>ç°åœ¨ï¼Œ<code>postsSlice</code> çŠ¶æ€æ˜¯ä¸€ä¸ªå•ä¸€çš„ <code>posts</code> æ•°ç»„ã€‚æˆ‘ä»¬éœ€è¦å°†å…¶æ›´æ”¹ä¸ºå…·æœ‰ <code>posts</code> æ•°ç»„ä»¥åŠåŠ è½½çŠ¶æ€å­—æ®µçš„å¯¹è±¡ã€‚</p><p>åŒæ—¶ï¼Œåƒ <code>&lt;PostsList&gt;</code> è¿™æ ·çš„ UI ç»„ä»¶æ­£åœ¨å°è¯•ä» <code>useSelector</code> é’©å­ä¸­çš„ <code>state.posts</code> ä¸­è¯»å–å¸–å­ï¼Œå‡è®¾è¯¥å­—æ®µæ˜¯ä¸€ä¸ªæ•°ç»„ã€‚æˆ‘ä»¬è¿˜éœ€è¦æ›´æ”¹è¿™äº›ä½ç½®ä»¥åŒ¹é…æ–°æ•°æ®ã€‚</p><p>å¦‚æœæˆ‘ä»¬ä¸å¿…åœ¨æ¯æ¬¡å¯¹ reducer ä¸­çš„æ•°æ®æ ¼å¼è¿›è¡Œæ›´æ”¹æ—¶éƒ½ç»§ç»­é‡å†™æˆ‘ä»¬çš„ç»„ä»¶ï¼Œé‚£å°±å¤ªå¥½äº†ã€‚é¿å…è¿™ç§æƒ…å†µçš„ä¸€ç§æ–¹æ³•æ˜¯åœ¨åˆ‡ç‰‡æ–‡ä»¶ä¸­å®šä¹‰å¯é‡ç”¨çš„ selector å‡½æ•°ï¼Œå¹¶è®©ç»„ä»¶ä½¿ç”¨è¿™äº› selector æ¥æå–å®ƒä»¬éœ€è¦çš„æ•°æ®ï¼Œè€Œä¸æ˜¯åœ¨æ¯ä¸ªç»„ä»¶ä¸­é‡å¤ selector é€»è¾‘ã€‚è¿™æ ·ï¼Œå¦‚æœæˆ‘ä»¬å†æ¬¡æ›´æ”¹çŠ¶æ€ç»“æ„ï¼Œæˆ‘ä»¬åªéœ€è¦æ›´æ–°åˆ‡ç‰‡æ–‡ä»¶ä¸­çš„ä»£ç ã€‚</p><p><code>&lt;PostsList&gt;</code> ç»„ä»¶éœ€è¦è¯»å–æ‰€æœ‰å¸–å­çš„åˆ—è¡¨ï¼Œè€Œ <code>&lt;SinglePostPage&gt;</code> å’Œ <code>&lt;EditPostForm&gt;</code> ç»„ä»¶éœ€è¦é€šè¿‡å…¶ ID æŸ¥æ‰¾å•ä¸ªå¸–å­ã€‚è®©æˆ‘ä»¬ä» <code>postsSlice.js</code> ä¸­å¯¼å‡ºä¸¤ä¸ªå°çš„é€‰æ‹©å™¨å‡½æ•°æ¥æ¶µç›–è¿™äº›æƒ…å†µï¼š</p><div class="codeBlockContainer_K1bP"><div style="color:#f8f8f2;background-color:#272822" class="codeBlockTitle_eoMF">features/posts/postsSlice.js</div><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar codeBlockWithTitle_2JqI"><div class="codeBlockLines_39YC" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> postsSlice </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">createSlice</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token comment" style="color:#c6cad2">/* omit slice code*/</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> postAdded</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> postUpdated</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> reactionAdded </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> postsSlice</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">actions</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">default</span><span class="token plain"> postsSlice</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">reducer</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#E6D874">selectAllPosts</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token parameter">state</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> state</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">posts</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#E6D874">selectPostById</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> postId</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  state</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">posts</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">find</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">post</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> post</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">id</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">===</span><span class="token plain"> postId</span><span class="token punctuation" style="color:#F8F8F2">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>è¯·æ³¨æ„ï¼Œè¿™äº›é€‰æ‹©å™¨å‡½æ•°çš„ <code>state</code> å‚æ•°æ˜¯æ ¹ Redux çŠ¶æ€å¯¹è±¡ï¼Œå°±åƒæˆ‘ä»¬ç›´æ¥åœ¨ <code>useSelector</code> å†…éƒ¨ç¼–å†™çš„å†…è”åŒ¿åé€‰æ‹©å™¨ä¸€æ ·ã€‚</p><p>ç„¶åæˆ‘ä»¬å¯ä»¥åœ¨ç»„ä»¶ä¸­ä½¿ç”¨å®ƒä»¬ï¼š</p><div class="codeBlockContainer_K1bP"><div style="color:#f8f8f2;background-color:#272822" class="codeBlockTitle_eoMF">features/posts/PostsList.js</div><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar codeBlockWithTitle_2JqI"><div class="codeBlockLines_39YC" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#c6cad2">// omit imports</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#F8F8F2">{</span><span class="token imports"> selectAllPosts </span><span class="token imports punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;./postsSlice&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function maybe-class-name" style="color:#E6D874">PostsList</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> posts </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">useSelector</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">selectAllPosts</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token comment" style="color:#c6cad2">// omit component contents</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div style="color:#f8f8f2;background-color:#272822" class="codeBlockTitle_eoMF">features/posts/SinglePostPage.js</div><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar codeBlockWithTitle_2JqI"><div class="codeBlockLines_39YC" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#c6cad2">// omit imports</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#F8F8F2">{</span><span class="token imports"> selectPostById </span><span class="token imports punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;./postsSlice&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function maybe-class-name" style="color:#E6D874">SinglePostPage</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter punctuation" style="color:#F8F8F2">{</span><span class="token parameter"> match </span><span class="token parameter punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> postId </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> match</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">params</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> post </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">useSelector</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">selectPostById</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">state</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> postId</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token comment" style="color:#c6cad2">// omit component logic</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div style="color:#f8f8f2;background-color:#272822" class="codeBlockTitle_eoMF">features/posts/EditPostForm.js</div><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar codeBlockWithTitle_2JqI"><div class="codeBlockLines_39YC" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#c6cad2">// omit imports</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#F8F8F2">{</span><span class="token imports"> postUpdated</span><span class="token imports punctuation" style="color:#F8F8F2">,</span><span class="token imports"> selectPostById </span><span class="token imports punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;./postsSlice&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function maybe-class-name" style="color:#E6D874">EditPostForm</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter punctuation" style="color:#F8F8F2">{</span><span class="token parameter"> match </span><span class="token parameter punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> postId </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> match</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">params</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> post </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">useSelector</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">selectPostById</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">state</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> postId</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token comment" style="color:#c6cad2">// omit component logic</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>é€šè¿‡ç¼–å†™å¯é‡ç”¨çš„é€‰æ‹©å™¨æ¥å°è£…æ•°æ®æŸ¥æ‰¾é€šå¸¸æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ã€‚æ‚¨è¿˜å¯ä»¥åˆ›å»ºæœ‰åŠ©äºæé«˜æ€§èƒ½çš„â€œè®°å¿†åŒ– memoizedâ€ é€‰æ‹©å™¨ï¼Œæˆ‘ä»¬å°†åœ¨æœ¬æ•™ç¨‹çš„åé¢éƒ¨åˆ†è¿›è¡Œä»‹ç»ã€‚</p><p>ä½†æ˜¯ï¼Œå°±åƒä»»ä½•æŠ½è±¡ä¸€æ ·ï¼Œè¿™ä¸æ˜¯ä½  <em>æ‰€æœ‰</em> æ—¶é—´ã€ä»»ä½•åœ°æ–¹éƒ½åº”è¯¥åšçš„äº‹æƒ…ã€‚ç¼–å†™é€‰æ‹©å™¨æ„å‘³ç€éœ€è¦ç†è§£å’Œç»´æŠ¤æ›´å¤šçš„ä»£ç ã€‚<strong>ä¸è¦è§‰å¾—æ‚¨éœ€è¦ä¸ºçŠ¶æ€çš„æ¯ä¸ªå­—æ®µéƒ½ç¼–å†™é€‰æ‹©å™¨</strong>ã€‚å»ºè®®å¼€å§‹æ—¶ä¸ä½¿ç”¨ä»»ä½•é€‰æ‹©å™¨ï¼Œç¨åå½“æ‚¨å‘ç°è‡ªå·±åœ¨åº”ç”¨ç¨‹åºä»£ç çš„è®¸å¤šéƒ¨åˆ†ä¸­æŸ¥æ‰¾ç›¸åŒå€¼æ—¶æ·»åŠ ä¸€äº›é€‰æ‹©å™¨ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="è¯·æ±‚è¿‡ç¨‹ä¸­çš„åŠ è½½çŠ¶æ€"></a>è¯·æ±‚è¿‡ç¨‹ä¸­çš„åŠ è½½çŠ¶æ€<a class="hash-link" href="#è¯·æ±‚è¿‡ç¨‹ä¸­çš„åŠ è½½çŠ¶æ€" title="Direct link to heading">#</a></h3><p>å½“æˆ‘ä»¬è¿›è¡Œ API è¯·æ±‚æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶è¿›åº¦è§†ä¸ºä¸€ä¸ªå°å‹çŠ¶æ€æœºï¼Œå®ƒå¤„äºä¸‹é¢å››ç§å¯èƒ½çš„çŠ¶æ€ä¹‹ä¸€ï¼š</p><ul><li>è¯·æ±‚å°šæœªå¼€å§‹</li><li>è¯·æ±‚æ­£åœ¨è¿›è¡Œä¸­</li><li>è¯·æ±‚æˆåŠŸï¼Œæˆ‘ä»¬ç°åœ¨æœ‰äº†æˆ‘ä»¬éœ€è¦çš„æ•°æ®</li><li>è¯·æ±‚å¤±è´¥ï¼Œå¯èƒ½æœ‰é”™è¯¯ä¿¡æ¯</li></ul><p>æˆ‘ä»¬ <em>å¯ä»¥</em> ä½¿ç”¨ä¸€äº›å¸ƒå°”å€¼æ¥è·Ÿè¸ªè¯¥ä¿¡æ¯ï¼Œä¾‹å¦‚ <code>isLoading: true</code>ï¼Œä½†æœ€å¥½å°†è¿™äº›çŠ¶æ€ä½œä¸ºå•ä¸ªæšä¸¾å€¼ã€‚å¥½çš„æ¨¡å¼æ˜¯ä½¿ç”¨å¦‚ä¸‹æ‰€ç¤ºçš„çŠ¶æ€éƒ¨åˆ†ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly ts"><div tabindex="0" class="prism-code language-ts codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  status</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;idle&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">|</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;loading&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">|</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;succeeded&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">|</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;failed&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  error</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token builtin" style="color:#a6e22e">string</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">|</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">null</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>è¿™äº›å­—æ®µå°†ä¸ store çš„ä»»ä½•å®é™…æ•°æ®ä¸€èµ·å­˜åœ¨ã€‚è¿™äº›ç‰¹å®šçš„å­—ç¬¦ä¸²çŠ¶æ€åç§°ä¸æ˜¯å¿…éœ€çš„ - å¦‚æœæ‚¨æ„¿æ„ï¼Œå¯ä»¥éšæ„ä½¿ç”¨å…¶ä»–åç§°ï¼Œä¾‹å¦‚<code>â€œpendingâ€</code> ä»£æ›¿ <code>â€œloadingâ€</code>ï¼Œæˆ– <code>â€œcompleteâ€</code> ä»£æ›¿ <code>â€œsucceededâ€</code>ã€‚</p><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™äº›ä¿¡æ¯æ¥å†³å®šåœ¨è¯·æ±‚è¿›è¡Œæ—¶åœ¨ UI ä¸­æ˜¾ç¤ºä»€ä¹ˆï¼Œå¹¶åœ¨æˆ‘ä»¬çš„ reducer ä¸­æ·»åŠ é€»è¾‘ä»¥é˜²æ­¢è¯¸å¦‚ä¸¤æ¬¡åŠ è½½æ•°æ®ä¹‹ç±»çš„æƒ…å†µã€‚</p><p>è®©æˆ‘ä»¬æ›´æ–°æˆ‘ä»¬çš„ <code>postsSlice</code> ä»¥ä½¿ç”¨æ­¤æ¨¡å¼æ¥è·Ÿè¸ªâ€œè·å–å¸–å­â€è¯·æ±‚çš„åŠ è½½çŠ¶æ€ã€‚æˆ‘ä»¬å°†æŠŠæˆ‘ä»¬çš„çŠ¶æ€ä»ä¸€ä¸ªå•ç‹¬çš„å¸–å­æ•°ç»„åˆ‡æ¢åˆ°çœ‹èµ·æ¥åƒ <code>{posts, status, error}</code>ã€‚æˆ‘ä»¬è¿˜å°†ä»åˆå§‹çŠ¶æ€ä¸­åˆ é™¤æ—§çš„ç¤ºä¾‹å¸–å­æ¡ç›®ã€‚ä½œä¸ºæ­¤æ›´æ”¹çš„ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å°† <code>state</code> ä½œä¸ºæ•°ç»„çš„ä»»ä½•ä½¿ç”¨æ›´æ”¹ä¸º <code>state.posts</code>ï¼Œå› ä¸ºè¯¥æ•°ç»„ç°åœ¨æ›´æ·±ä¸€å±‚ï¼š</p><div class="codeBlockContainer_K1bP"><div style="color:#f8f8f2;background-color:#272822" class="codeBlockTitle_eoMF">features/posts/postsSlice.js</div><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar codeBlockWithTitle_2JqI"><div class="codeBlockLines_39YC" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#F8F8F2">{</span><span class="token imports"> createSlice</span><span class="token imports punctuation" style="color:#F8F8F2">,</span><span class="token imports"> nanoid </span><span class="token imports punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;@reduxjs/toolkit&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> initialState </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  posts</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">[</span><span class="token punctuation" style="color:#F8F8F2">]</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  status</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;idle&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  error</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#F92672">null</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> postsSlice </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">createSlice</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  name</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;posts&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  initialState</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  reducers</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    postAdded</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token function" style="color:#E6D874">reducer</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">        state</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">posts</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">push</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">action</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">payload</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token function" style="color:#E6D874">prepare</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">title</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> content</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> userId</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token comment" style="color:#c6cad2">// omit prepare logic</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token function" style="color:#E6D874">reactionAdded</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> postId</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> reaction </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> action</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">payload</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> existingPost </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> state</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">posts</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">find</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">post</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> post</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">id</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">===</span><span class="token plain"> postId</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#F92672">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">existingPost</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        existingPost</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">reactions</span><span class="token punctuation" style="color:#F8F8F2">[</span><span class="token plain">reaction</span><span class="token punctuation" style="color:#F8F8F2">]</span><span class="token operator" style="color:#F8F8F2">++</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token function" style="color:#E6D874">postUpdated</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> id</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> title</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> content </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> action</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">payload</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> existingPost </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> state</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">posts</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">find</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">post</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> post</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">id</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">===</span><span class="token plain"> id</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#F92672">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">existingPost</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        existingPost</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">title</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> title</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        existingPost</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">content</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> content</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> postAdded</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> postUpdated</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> reactionAdded </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> postsSlice</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">actions</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">default</span><span class="token plain"> postsSlice</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">reducer</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#E6D874">selectAllPosts</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token parameter">state</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> state</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">posts</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">posts</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#E6D874">selectPostById</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> postId</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  state</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">posts</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">posts</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">find</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">post</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> post</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">id</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">===</span><span class="token plain"> postId</span><span class="token punctuation" style="color:#F8F8F2">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>æ˜¯çš„ï¼Œè¿™ <em>ç¡®å®</em> æ„å‘³ç€æˆ‘ä»¬ç°åœ¨æœ‰ä¸€ä¸ªçœ‹èµ·æ¥åƒ <code>state.posts.posts</code> çš„åµŒå¥—å¯¹è±¡è·¯å¾„ï¼Œè¿™æœ‰ç‚¹é‡å¤å’Œæ„šè ¢:) æˆ‘ä»¬ <em>å¯ä»¥</em> å°†åµŒå¥—æ•°ç»„åç§°æ›´æ”¹ä¸º <code>items</code> æˆ– <code>data</code> æˆ–å…¶ä»–ä¸œè¥¿ å¦‚æœæˆ‘ä»¬æƒ³é¿å…è¿™ç§æƒ…å†µï¼Œä½†æˆ‘ä»¬æš‚æ—¶ä¿æŒåŸæ ·ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="ä½¿ç”¨-createasyncthunk-è¯·æ±‚æ•°æ®"></a>ä½¿ç”¨ <code>createAsyncThunk</code> è¯·æ±‚æ•°æ®<a class="hash-link" href="#ä½¿ç”¨-createasyncthunk-è¯·æ±‚æ•°æ®" title="Direct link to heading">#</a></h3><p>Redux Toolkit çš„ <code>createAsyncThunk</code> API ç”Ÿæˆ thunkï¼Œä¸ºæ‚¨è‡ªåŠ¨ dispatch é‚£äº› &quot;start/success/failure&quot; actionã€‚</p><p>è®©æˆ‘ä»¬ä»æ·»åŠ ä¸€ä¸ª thunk å¼€å§‹ï¼Œè¯¥ thunk å°†è¿›è¡Œ AJAX è°ƒç”¨ä»¥æ£€ç´¢å¸–å­åˆ—è¡¨ã€‚æˆ‘ä»¬å°†ä» <code>src/api</code> æ–‡ä»¶å¤¹ä¸­å¼•å…¥ <code>client</code> å·¥å…·åº“ï¼Œå¹¶ä½¿ç”¨å®ƒå‘ <code>&#x27;/fakeApi/posts&#x27;</code> å‘å‡ºè¯·æ±‚ã€‚</p><div class="codeBlockContainer_K1bP"><div style="color:#f8f8f2;background-color:#272822" class="codeBlockTitle_eoMF">features/posts/postsSlice</div><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar codeBlockWithTitle_2JqI"><div class="codeBlockLines_39YC" style="color:#f8f8f2;background-color:#272822"><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#F8F8F2">{</span><span class="token imports"> createSlice</span><span class="token imports punctuation" style="color:#F8F8F2">,</span><span class="token imports"> nanoid</span><span class="token imports punctuation" style="color:#F8F8F2">,</span><span class="token imports"> createAsyncThunk </span><span class="token imports punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;@reduxjs/toolkit&#x27;</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#F8F8F2">{</span><span class="token imports"> client </span><span class="token imports punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;../../api/client&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> initialState </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  posts</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">[</span><span class="token punctuation" style="color:#F8F8F2">]</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  status</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;idle&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  error</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#F92672">null</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> fetchPosts </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">createAsyncThunk</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;posts/fetchPosts&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">async</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> response </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#F92672">await</span><span class="token plain"> client</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">get</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;/fakeApi/posts&#x27;</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#F92672">return</span><span class="token plain"> response</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">posts</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p><code>createAsyncThunk</code> æ¥æ”¶2ä¸ªå‚æ•°:</p><ul><li>å°†ç”¨ä½œç”Ÿæˆçš„ action ç±»å‹çš„å‰ç¼€çš„å­—ç¬¦ä¸²</li><li>ä¸€ä¸ªâ€œpayload creatorâ€å›è°ƒå‡½æ•°ï¼Œå®ƒåº”è¯¥è¿”å›ä¸€ä¸ªåŒ…å«ä¸€äº›æ•°æ®çš„ <code>Promise</code>ï¼Œæˆ–è€…ä¸€ä¸ªè¢«æ‹’ç»çš„å¸¦æœ‰é”™è¯¯çš„ <code>Promise</code></li></ul><p>Payload creator é€šå¸¸ä¼šè¿›è¡ŒæŸç§ AJAX è°ƒç”¨ï¼Œå¹¶ä¸”å¯ä»¥ç›´æ¥ä» AJAX è°ƒç”¨è¿”å› <code>Promise</code>ï¼Œæˆ–è€…ä» API å“åº”ä¸­æå–ä¸€äº›æ•°æ®å¹¶è¿”å›ã€‚æˆ‘ä»¬é€šå¸¸ä½¿ç”¨ JS <code>async/await</code> è¯­æ³•æ¥ç¼–å†™å®ƒï¼Œè¿™è®©æˆ‘ä»¬å¯ä»¥ç¼–å†™ä½¿ç”¨ <code>Promise</code> çš„å‡½æ•°ï¼ŒåŒæ—¶ä½¿ç”¨æ ‡å‡†çš„ <code>try/catch</code> é€»è¾‘è€Œä¸æ˜¯ <code>somePromise.then()</code> é“¾å¼è°ƒç”¨ã€‚</p><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¼ å…¥ <code>&#x27;posts/fetchPosts&#x27;</code> ä½œä¸º action ç±»å‹çš„å‰ç¼€ã€‚æˆ‘ä»¬çš„ payload åˆ›å»ºå›è°ƒç­‰å¾… API è°ƒç”¨è¿”å›å“åº”ã€‚å“åº”å¯¹è±¡çš„æ ¼å¼ä¸º <code>{posts: []}</code>ï¼Œæˆ‘ä»¬å¸Œæœ›æˆ‘ä»¬ dispatch çš„ Redux action æœ‰ä¸€ä¸ª payloadï¼Œä¹Ÿå°±æ˜¯å¸–å­åˆ—è¡¨çš„æ•°ç»„ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬æå– <code>response.posts</code>ï¼Œå¹¶ä»å›è°ƒä¸­è¿”å›å®ƒã€‚</p><p>å½“è°ƒç”¨ <code>dispatch(fetchPosts())</code> çš„æ—¶å€™ï¼Œ<code>fetchPosts</code> è¿™ä¸ª thunk ä¼šé¦–å…ˆ dispatch ä¸€ä¸ª action ç±»å‹ä¸º<code>&#x27;posts/fetchPosts/pending&#x27;</code>ï¼š</p><p><img alt="`createAsyncThunk`: posts pending action" src="/assets/images/devtools-posts-pending-8885d18adbd31d8269b31caffe463c93.png"></p><p>æˆ‘ä»¬å¯ä»¥åœ¨æˆ‘ä»¬çš„ reducer ä¸­ç›‘å¬è¿™ä¸ª action å¹¶å°†è¯·æ±‚çŠ¶æ€æ ‡è®°ä¸º â€œloading æ­£åœ¨åŠ è½½â€ã€‚</p><p>ä¸€æ—¦ <code>Promise</code> æˆåŠŸï¼Œ<code>fetchPosts</code> thunk ä¼šæ¥å—æˆ‘ä»¬ä»å›è°ƒä¸­è¿”å›çš„ <code>response.posts</code> æ•°ç»„ï¼Œå¹¶ dispatch ä¸€ä¸ª actionï¼Œaction çš„ payload ä¸º posts æ•°ç»„ï¼Œaction çš„ ç±»å‹ä¸º <code>&#x27;posts/fetchPosts/fulfilled&#x27;</code>ã€‚</p><p><img alt="`createAsyncThunk`: posts pending action" src="/assets/images/devtools-posts-fulfilled-99e7e96d6687e5eab5b31649d93c8ccf.png"></p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="åœ¨ç»„ä»¶ä¸­-dispatch-thunk"></a>åœ¨ç»„ä»¶ä¸­ dispatch thunk<a class="hash-link" href="#åœ¨ç»„ä»¶ä¸­-dispatch-thunk" title="Direct link to heading">#</a></h4><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ›´æ–°æˆ‘ä»¬çš„ <code>&lt;PostsList&gt;</code> ç»„ä»¶ï¼Œæ¥ä¸ºæˆ‘ä»¬è‡ªåŠ¨è¯·æ±‚è¿™äº›æ•°æ®ã€‚</p><p>æˆ‘ä»¬å°†æŠŠ <code>fetchPosts</code> thunk å¼•å…¥åˆ°ç»„ä»¶ä¸­ã€‚åƒæˆ‘ä»¬æ‰€æœ‰çš„å…¶ä»– action creator ä¸€æ ·ï¼Œæˆ‘ä»¬å¿…é¡» dispatch å®ƒï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦æ·»åŠ  <code>useDispatch</code> é’©å­ã€‚ç”±äºæˆ‘ä»¬æƒ³åœ¨ <code>&lt;PostsList&gt;</code> æŒ‚è½½æ—¶è·å–è¿™äº›æ•°æ®ï¼Œæˆ‘ä»¬éœ€è¦å¼•å…¥ React <code>useEffect</code> é’©å­ï¼š</p><div class="codeBlockContainer_K1bP"><div style="color:#f8f8f2;background-color:#272822" class="codeBlockTitle_eoMF">features/posts/PostsList.js</div><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar codeBlockWithTitle_2JqI"><div class="codeBlockLines_39YC" style="color:#f8f8f2;background-color:#272822"><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token imports maybe-class-name">React</span><span class="token imports punctuation" style="color:#F8F8F2">,</span><span class="token imports"> </span><span class="token imports punctuation" style="color:#F8F8F2">{</span><span class="token imports"> useEffect </span><span class="token imports punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;react&#x27;</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#F8F8F2">{</span><span class="token imports"> useSelector</span><span class="token imports punctuation" style="color:#F8F8F2">,</span><span class="token imports"> useDispatch </span><span class="token imports punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;react-redux&#x27;</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:#c6cad2">// omit other imports</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#F8F8F2">{</span><span class="token imports"> selectAllPosts</span><span class="token imports punctuation" style="color:#F8F8F2">,</span><span class="token imports"> fetchPosts </span><span class="token imports punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;./postsSlice&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function maybe-class-name" style="color:#E6D874">PostsList</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> dispatch </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">useDispatch</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> posts </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">useSelector</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">selectAllPosts</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> postStatus </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">useSelector</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> state</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">posts</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">status</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token function" style="color:#E6D874">useEffect</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#F92672">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">postStatus </span><span class="token operator" style="color:#F8F8F2">===</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;idle&#x27;</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token function" style="color:#E6D874">dispatch</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token function" style="color:#E6D874">fetchPosts</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">[</span><span class="token plain">postStatus</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> dispatch</span><span class="token punctuation" style="color:#F8F8F2">]</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token comment" style="color:#c6cad2">// omit rendering logic</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>é‡è¦çš„æ˜¯ï¼Œæˆ‘ä»¬åªå°è¯•è·å–ä¸€æ¬¡å¸–å­åˆ—è¡¨ã€‚å¦‚æœæˆ‘ä»¬æ¯æ¬¡åœ¨ <code>&lt;PostsList&gt;</code> ç»„ä»¶æ¸²æŸ“æ—¶éƒ½è¿™æ ·åšï¼Œæˆ–è€…å› ä¸ºæˆ‘ä»¬åœ¨è§†å›¾ä¹‹é—´åˆ‡æ¢è€Œé‡æ–°åˆ›å»ºï¼Œæˆ‘ä»¬æœ€ç»ˆå¯èƒ½ä¼šå¤šæ¬¡è·å–å¸–å­ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>posts.status</code> æšä¸¾æ¥å¸®åŠ©å†³å®šæˆ‘ä»¬æ˜¯å¦éœ€è¦çœŸæ­£å¼€å§‹è·å–ï¼Œæ–¹æ³•æ˜¯å°†å®ƒæ³¨å…¥åˆ°ç»„ä»¶ä¸­ï¼Œå¹¶ä¸”åªæœ‰åœ¨çŠ¶æ€ä¸ºâ€œidle ç©ºé—²â€æ—¶æ‰å¼€å§‹è·å–ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="reducer-ä¸-loading-action"></a>Reducer ä¸ Loading Action<a class="hash-link" href="#reducer-ä¸-loading-action" title="Direct link to heading">#</a></h3><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦åœ¨æˆ‘ä»¬çš„ reducer ä¸­å¤„ç†è¿™ä¸¤ä¸ª actionã€‚è¿™éœ€è¦æ›´æ·±å…¥åœ°äº†è§£æˆ‘ä»¬ä¸€ç›´åœ¨ä½¿ç”¨çš„ <code>createSlice</code> APIã€‚</p><p>æˆ‘ä»¬å·²ç»çœ‹åˆ° <code>createSlice</code> å°†ä¸º <code>reducers</code> å­—æ®µä¸­å®šä¹‰çš„æ¯ä¸ª reducer å‡½æ•°ç”Ÿæˆä¸€ä¸ª action creatorï¼Œå¹¶ä¸”ç”Ÿæˆçš„ action type ä¸­åŒ…å«äº†åˆ‡ç‰‡çš„åç§°ï¼Œä¾‹å¦‚ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token console class-name">console</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">log</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token function" style="color:#E6D874">postUpdated</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> id</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;123&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> title</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;First Post&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> content</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;Some text here&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:#c6cad2">/*</span></div><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#c6cad2">{</span></div><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#c6cad2">  type: &#x27;posts/postUpdated&#x27;,</span></div><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#c6cad2">  payload: {</span></div><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#c6cad2">    id: &#x27;123&#x27;,</span></div><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#c6cad2">    title: &#x27;First Post&#x27;,</span></div><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#c6cad2">    content: &#x27;Some text here&#x27;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#c6cad2">  }</span></div><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#c6cad2">}</span></div><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#c6cad2">*/</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>ä½†æ˜¯ï¼Œæœ‰æ—¶åˆ‡ç‰‡çš„ reducer éœ€è¦å“åº” <em>æ²¡æœ‰</em> å®šä¹‰åˆ°è¯¥åˆ‡ç‰‡çš„ <code>reducers</code> å­—æ®µä¸­çš„ actionã€‚è¿™ä¸ªæ—¶å€™å°±éœ€è¦ä½¿ç”¨ slice ä¸­çš„ <code>extraReducers</code> å­—æ®µã€‚</p><details class="detailed-explanation"><summary><h4>ç»†èŠ‚è¯´æ˜ï¼šAdding Extra Reducers to Slices</h4></summary><p><code>extraReducers</code> å¯¹è±¡ä¸­çš„é”®åº”è¯¥æ˜¯ Redux action ç±»å‹å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ <code>&#x27;counter/increment&#x27;</code>ï¼Œæ‰‹åŠ¨è¾“å…¥å³å¯ã€‚å¦‚æœç±»å‹åç§°åŒ…å« <code>/</code> è¿™æ ·çš„å­—ç¬¦ä¸²ï¼Œä¹Ÿå¿…é¡»å†™å‡ºæ¥ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> postsSlice </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">createSlice</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  name</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;posts&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  initialState</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  reducers</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token comment" style="color:#c6cad2">// slice-specific reducers here</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  extraReducers</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token string" style="color:#a6e22e">&#x27;counter/increment&#x27;</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token comment" style="color:#c6cad2">// æ›´æ–°å¸–å­å†…å®¹åˆ‡ç‰‡çš„ reducer é€»è¾‘</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>æ›´å¥½çš„æ–¹æ³•æ˜¯ï¼Œè°ƒç”¨ <code>actionCreator.toString()</code>ï¼Œå®ƒä¼šè¿”å› Redux Toolkit ç”Ÿæˆçš„ action ç±»å‹çš„å­—ç¬¦ä¸²ã€‚è¿™æ ·å°±å¯ä»¥æŠŠå®ƒä½œä¸º ES6 å¯¹è±¡å­—é¢é‡æ¥ä¼ é€’ï¼Œaction ç±»å‹å­—ç¬¦ä¸²ä½œä¸ºå¯¹è±¡çš„é”®ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#F8F8F2">{</span><span class="token imports"> increment </span><span class="token imports punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;../features/counter/counterSlice&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> object </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">[</span><span class="token plain">increment</span><span class="token punctuation" style="color:#F8F8F2">]</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token console class-name">console</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">log</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">object</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:#c6cad2">// { &quot;counter/increment&quot;: Function}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>æŠŠå®ƒåº”ç”¨åˆ° <code>extraReducers</code> ä¸­å°±æ˜¯ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#F8F8F2">{</span><span class="token imports"> increment </span><span class="token imports punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;../features/counter/counterSlice&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> postsSlice </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">createSlice</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  name</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;posts&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  initialState</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  reducers</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token comment" style="color:#c6cad2">// slice-specific reducers here</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  extraReducers</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">[</span><span class="token plain">increment</span><span class="token punctuation" style="color:#F8F8F2">]</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token comment" style="color:#c6cad2">// normal reducer logic to update the posts slice</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡ä½¿ç”¨ <code>extraReducers</code> çš„ â€œæ„å»ºå™¨å›è°ƒï¼ˆbuilder callbackï¼‰â€ è¯­æ³•æ¥æ·»åŠ é¢å¤–çš„ reducerã€‚å¦‚æœæˆ‘ä»¬ä¸º <code>extraReducers</code> ä¼ é€’ä¸€ä¸ªå‡½æ•°è€Œä¸æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>builder</code> å‚æ•°æ¥æ·»åŠ æ¯ä¸ª caseã€‚<code>builder.addCase()</code> å‡½æ•°æ¥å—ä¸€ä¸ªçº¯å­—ç¬¦ä¸²çš„ action ç±»å‹ï¼Œæˆ–è€…ä¸€ä¸ª Redux Toolkit çš„ action åˆ›å»ºè€…ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#F8F8F2">{</span><span class="token imports"> increment </span><span class="token imports punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;../features/counter/counterSlice&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> postsSlice </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">createSlice</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  name</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;posts&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  initialState</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  reducers</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token comment" style="color:#c6cad2">// slice-specific reducers here</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token function-variable function" style="color:#E6D874">extraReducers</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token parameter">builder</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    builder</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">addCase</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;counter/decrement&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    builder</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">addCase</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">increment</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>å¦‚æœä½ ä½¿ç”¨ TypeScriptï¼Œä½ åº”è¯¥ä½¿ç”¨ <code>extraReducers</code> çš„æ„å»ºå™¨å›è°ƒå½¢å¼ï¼ˆè¿™æ ·å¯ä»¥ä¼ é€’ç±»å‹ï¼‰ã€‚</p></details><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦ç›‘å¬ç”± <code>fetchPosts</code> thunk dispatch çš„â€œpendingâ€å’Œâ€œfulfilledâ€ 2ä¸ª action ç±»å‹ã€‚è¿™äº› action åˆ›å»ºè€…è¢«åŒ…å«åœ¨äº† <code>fetchPosts</code> å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å°†å®ƒä»¬ä¼ é€’ç»™ <code>extraReducers</code> æ¥ç›‘å¬è¿™äº› actionï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> fetchPosts </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">createAsyncThunk</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;posts/fetchPosts&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">async</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> response </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#F92672">await</span><span class="token plain"> client</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">get</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;/fakeApi/posts&#x27;</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#F92672">return</span><span class="token plain"> response</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">posts</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> postsSlice </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">createSlice</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  name</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;posts&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  initialState</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  reducers</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token comment" style="color:#c6cad2">// omit existing reducers here</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  extraReducers</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">[</span><span class="token plain">fetchPosts</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">pending</span><span class="token punctuation" style="color:#F8F8F2">]</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">      state</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">status</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;loading&#x27;</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">[</span><span class="token plain">fetchPosts</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">fulfilled</span><span class="token punctuation" style="color:#F8F8F2">]</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">      state</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">status</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;succeeded&#x27;</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token comment" style="color:#c6cad2">// Add any fetched posts to the array</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">      state</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">posts</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> state</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">posts</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">concat</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">action</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">payload</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">[</span><span class="token plain">fetchPosts</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">rejected</span><span class="token punctuation" style="color:#F8F8F2">]</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">      state</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">status</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;failed&#x27;</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">      state</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">error</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> action</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">error</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">message</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p><code>createAsyncThunk</code> è¿”å›çš„æ‰€æœ‰ 3 ç§ actionï¼Œéƒ½å¯ä»¥é€šè¿‡è¿”å›çš„ <code>Promise</code> æ¥å¤„ç†ã€‚</p><ul><li>å½“è¯·æ±‚å¼€å§‹æ—¶ï¼Œæˆ‘ä»¬å°† <code>status</code> æšä¸¾è®¾ç½®ä¸º <code>&#x27;loading&#x27;</code></li><li>å¦‚æœè¯·æ±‚æˆåŠŸï¼Œæˆ‘ä»¬å°† <code>status</code> æ ‡è®°ä¸º <code>&#x27;succeeded&#x27;</code>ï¼Œå¹¶å°†è·å–çš„å¸–å­æ·»åŠ åˆ° <code>state.posts</code></li><li>å¦‚æœè¯·æ±‚å¤±è´¥ï¼Œæˆ‘ä»¬ä¼šå°† <code>status</code> æ ‡è®°ä¸º <code>&#x27;failed&#x27;</code>ï¼Œå¹¶å°†é”™è¯¯æ¶ˆæ¯ä¿å­˜åˆ° state ä¸­ï¼Œéœ€è¦çš„æ—¶å€™å¯ä»¥æ˜¾ç¤ºå‡ºæ¥</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="æ˜¾ç¤ºåŠ è½½çŠ¶æ€"></a>æ˜¾ç¤ºåŠ è½½çŠ¶æ€<a class="hash-link" href="#æ˜¾ç¤ºåŠ è½½çŠ¶æ€" title="Direct link to heading">#</a></h3><p>æˆ‘ä»¬çš„ <code>&lt;PostsList&gt;</code> ç»„ä»¶å·²ç»åœ¨ç›‘å¬ store ä¸­å…³äºå¸–å­çš„ä»»ä½•æ›´æ–°ï¼Œä¸€æ—¦æ›´æ–°ä¼šè‡ªåŠ¨é‡æ–°æ¸²æŸ“ã€‚å› æ­¤ï¼Œå¦‚æœæˆ‘ä»¬åˆ·æ–°é¡µé¢ï¼Œå°±ä¼šåœ¨å±å¹•ä¸Šçœ‹åˆ°ä¸€ç»„æ¥è‡ªå‡ API çš„éšæœºå¸–å­ï¼š</p><p>æˆ‘ä»¬ä½¿ç”¨çš„å‡ API ä¼šç«‹å³è¿”å›æ•°æ®ã€‚ä½†æ˜¯ï¼ŒçœŸæ­£çš„ API è°ƒç”¨å¯èƒ½éœ€è¦ä¸€äº›æ—¶é—´æ‰èƒ½è¿”å›ã€‚è¿™å°±éœ€è¦åœ¨ UI ä¸­æ˜¾ç¤ºâ€œæ­£åœ¨åŠ è½½...â€çš„æç¤ºï¼Œå‘ŠçŸ¥ç”¨æˆ·ç­‰å¾…æ•°æ®ã€‚</p><p>æˆ‘ä»¬å¯ä»¥æ›´æ–°æˆ‘ä»¬çš„ <code>&lt;PostsList&gt;</code> ä»¥æ ¹æ® <code>state.posts.status</code> æšä¸¾å€¼æ¥æ˜¾ç¤ºä¸åŒçš„ UIï¼šå¦‚æœæˆ‘ä»¬æ­£åœ¨åŠ è½½ï¼Œåˆ™æ˜¾ç¤ºåŠ è½½åŠ¨ç”»ï¼Œå¦‚æœå¤±è´¥åˆ™æ˜¾ç¤ºé”™è¯¯æ¶ˆæ¯ï¼Œå¦‚æœæˆåŠŸå°±å±•ç¤ºå¸–å­æ•°æ®ã€‚æœ€ç»ˆä»£ç å¦‚ä¸‹ï¼š</p><div class="codeBlockContainer_K1bP"><div style="color:#f8f8f2;background-color:#272822" class="codeBlockTitle_eoMF">features/posts/PostsList.js</div><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar codeBlockWithTitle_2JqI"><div class="codeBlockLines_39YC" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function maybe-class-name" style="color:#E6D874">PostsList</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> dispatch </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">useDispatch</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> posts </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">useSelector</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">selectAllPosts</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> postStatus </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">useSelector</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> state</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">posts</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">status</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> error </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">useSelector</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> state</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">posts</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">error</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token function" style="color:#E6D874">useEffect</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#F92672">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">postStatus </span><span class="token operator" style="color:#F8F8F2">===</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;idle&#x27;</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token function" style="color:#E6D874">dispatch</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token function" style="color:#E6D874">fetchPosts</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">[</span><span class="token plain">postStatus</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> dispatch</span><span class="token punctuation" style="color:#F8F8F2">]</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">let</span><span class="token plain"> content</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#F92672">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">postStatus </span><span class="token operator" style="color:#F8F8F2">===</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;loading&#x27;</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    content </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token plain">div className</span><span class="token operator" style="color:#F8F8F2">=</span><span class="token string" style="color:#a6e22e">&quot;loader&quot;</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token maybe-class-name">Loading</span><span class="token spread operator" style="color:#F8F8F2">...</span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token operator" style="color:#F8F8F2">/</span><span class="token plain">div</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#F92672">else</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#F92672">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">postStatus </span><span class="token operator" style="color:#F8F8F2">===</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;succeeded&#x27;</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token comment" style="color:#c6cad2">// Sort posts in reverse chronological order by datetime string</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> orderedPosts </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> posts</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">slice</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">sort</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">a</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> b</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> b</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">date</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">localeCompare</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">a</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">date</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    content </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> orderedPosts</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">map</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">post</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token maybe-class-name">PostExcerpt</span><span class="token plain"> key</span><span class="token operator" style="color:#F8F8F2">=</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain">post</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">id</span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> post</span><span class="token operator" style="color:#F8F8F2">=</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain">post</span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">/</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#F92672">else</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#F92672">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">postStatus </span><span class="token operator" style="color:#F8F8F2">===</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;failed&#x27;</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    content </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token plain">div</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain">error</span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token operator" style="color:#F8F8F2">/</span><span class="token plain">div</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#F92672">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token plain">section className</span><span class="token operator" style="color:#F8F8F2">=</span><span class="token string" style="color:#a6e22e">&quot;posts-list&quot;</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token plain">h2</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token maybe-class-name">Posts</span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token operator" style="color:#F8F8F2">/</span><span class="token plain">h2</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain">content</span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token operator" style="color:#F8F8F2">/</span><span class="token plain">section</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>ä½†æ˜¯ï¼Œå‡ API è°ƒç”¨ä»ç„¶å‡ ä¹ç«‹å³è¿”å›ï¼Œæ‰€ä»¥æˆ‘ä»¬ç°åœ¨å‡ ä¹çœ‹ä¸åˆ°åŠ è½½åŠ è½½åŠ¨ç”»ã€‚å¦‚æœä½ æƒ³å¼ºåˆ¶ä¼ª API è°ƒç”¨èŠ±è´¹æ›´é•¿çš„æ—¶é—´ï¼Œä½ å¯ä»¥æ‰“å¼€<code>api/server.js</code>ï¼Œå¹¶å–æ¶ˆæ³¨é‡Šè¿™ä¸€è¡Œï¼š</p><div class="codeBlockContainer_K1bP"><div style="color:#f8f8f2;background-color:#272822" class="codeBlockTitle_eoMF">api/server.js</div><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar codeBlockWithTitle_2JqI"><div class="codeBlockLines_39YC" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#c6cad2">//this.timing = 2000</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>å–æ¶ˆæ³¨é‡Šè¯¥è¡Œå°†å¼ºåˆ¶å‡ API åœ¨å“åº”å‰ç­‰å¾… 2 ç§’ã€‚å¦‚æœæ‚¨æƒ³çœ‹åˆ°åŠ è½½åŠ¨ç”»ï¼Œè¯·éšæ—¶æ‰“å¼€å’Œå…³é—­å®ƒã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="åŠ è½½ç”¨æˆ·æ•°æ®"></a>åŠ è½½ç”¨æˆ·æ•°æ®<a class="hash-link" href="#åŠ è½½ç”¨æˆ·æ•°æ®" title="Direct link to heading">#</a></h2><p>æˆ‘ä»¬ç°åœ¨æ­£åœ¨è·å–å¹¶æ˜¾ç¤ºæˆ‘ä»¬çš„å¸–å­åˆ—è¡¨ã€‚ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬æŸ¥çœ‹è¿™äº›å¸–å­ï¼Œå°±ä¼šå‘ç°ä¸€ä¸ªé—®é¢˜ï¼šä½œè€…å…¨éƒ¨éƒ½æ˜¯ â€œæœªçŸ¥ä½œè€…â€ï¼š</p><p><img alt="æœªçŸ¥å¸–å­ä½œè€…" src="/assets/images/posts-unknownAuthor-32e58104f76e564adca25dcb95b66d20.png"></p><p>è¿™æ˜¯å› ä¸ºå¸–å­æ¡ç›®æ˜¯ç”±å‡ API æœåŠ¡å™¨éšæœºç”Ÿæˆçš„ï¼Œæ¯æ¬¡æˆ‘ä»¬é‡æ–°åŠ è½½é¡µé¢æ—¶ï¼Œå®ƒä¹Ÿä¼šéšæœºç”Ÿæˆä¸€ç»„å‡ç”¨æˆ·ã€‚æˆ‘ä»¬éœ€è¦æ›´æ–°ç”¨æˆ·åˆ‡ç‰‡çš„ä»£ç ï¼Œä»¥åœ¨åº”ç”¨ç¨‹åºå¯åŠ¨æ—¶è·å–ç”¨æˆ·æ•°æ®ã€‚</p><p>å’Œä¸Šæ¬¡ä¸€æ ·ï¼Œæˆ‘ä»¬å°†åˆ›å»ºå¦ä¸€ä¸ªå¼‚æ­¥ thunk æ¥ä» API è·å–ç”¨æˆ·æ•°æ®ï¼Œç„¶ååœ¨ <code>extraReducers</code> åˆ‡ç‰‡å­—æ®µä¸­å¤„ç† <code>fulfilled</code> actionã€‚æš‚æ—¶å…ˆä¸è€ƒè™‘åŠ è½½çŠ¶æ€ï¼š</p><div class="codeBlockContainer_K1bP"><div style="color:#f8f8f2;background-color:#272822" class="codeBlockTitle_eoMF">features/users/usersSlice.js</div><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar codeBlockWithTitle_2JqI"><div class="codeBlockLines_39YC" style="color:#f8f8f2;background-color:#272822"><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#F8F8F2">{</span><span class="token imports"> createSlice</span><span class="token imports punctuation" style="color:#F8F8F2">,</span><span class="token imports"> createAsyncThunk </span><span class="token imports punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;@reduxjs/toolkit&#x27;</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#F8F8F2">{</span><span class="token imports"> client </span><span class="token imports punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;../../api/client&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> initialState </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">[</span><span class="token punctuation" style="color:#F8F8F2">]</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> fetchUsers </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">createAsyncThunk</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;users/fetchUsers&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">async</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> response </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#F92672">await</span><span class="token plain"> client</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">get</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;/fakeApi/users&#x27;</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#F92672">return</span><span class="token plain"> response</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">users</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> usersSlice </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">createSlice</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  name</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;users&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  initialState</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  reducers</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  extraReducers</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">[</span><span class="token plain">fetchUsers</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">fulfilled</span><span class="token punctuation" style="color:#F8F8F2">]</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#F92672">return</span><span class="token plain"> action</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">payload</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">default</span><span class="token plain"> usersSlice</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">reducer</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>æˆ‘ä»¬åªéœ€è¦è·å–ä¸€æ¬¡ç”¨æˆ·åˆ—è¡¨ï¼Œæˆ‘ä»¬å¸Œæœ›åœ¨åº”ç”¨ç¨‹åºå¯åŠ¨æ—¶å°±å®Œæˆã€‚æˆ‘ä»¬å¯ä»¥åœ¨æˆ‘ä»¬çš„ <code>index.js</code> æ–‡ä»¶ä¸­åšåˆ°è¿™ä¸€ç‚¹ï¼Œå¹¶ç›´æ¥ dispatch  <code>fetchUsers</code> thunkï¼Œå› ä¸ºæˆ‘ä»¬åœ¨é‚£é‡Œæœ‰ <code>store</code>ï¼š</p><div class="codeBlockContainer_K1bP"><div style="color:#f8f8f2;background-color:#272822" class="codeBlockTitle_eoMF">index.js</div><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar codeBlockWithTitle_2JqI"><div class="codeBlockLines_39YC" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#c6cad2">// omit imports</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#F8F8F2">{</span><span class="token imports"> fetchUsers </span><span class="token imports punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;./features/users/usersSlice&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;./api/server&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">store</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">dispatch</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token function" style="color:#E6D874">fetchUsers</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token maybe-class-name">ReactDOM</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">render</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access maybe-class-name">StrictMode</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token maybe-class-name">Provider</span><span class="token plain"> store</span><span class="token operator" style="color:#F8F8F2">=</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain">store</span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token maybe-class-name">App</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">/</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token operator" style="color:#F8F8F2">/</span><span class="token maybe-class-name">Provider</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token operator" style="color:#F8F8F2">/</span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access maybe-class-name">StrictMode</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token dom variable" style="color:#F8F8F2">document</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">getElementById</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;root&#x27;</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>ç°åœ¨ï¼Œæ¯ä¸ªå¸–å­éƒ½åº”è¯¥å†æ¬¡æ˜¾ç¤ºç”¨æˆ·åï¼Œå¹¶ä¸”æˆ‘ä»¬è¿˜åº”è¯¥åœ¨ <code>&lt;AddPostForm&gt;</code> çš„â€œä½œè€…â€ä¸‹æ‹‰åˆ—è¡¨ä¸­æ˜¾ç¤ºç›¸åŒçš„ç”¨æˆ·åˆ—è¡¨ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="æ·»åŠ æ–°å¸–å­"></a>æ·»åŠ æ–°å¸–å­<a class="hash-link" href="#æ·»åŠ æ–°å¸–å­" title="Direct link to heading">#</a></h2><p>æœ¬èŠ‚è¿˜æœ‰ä¸€ä¸ªæ­¥éª¤ã€‚å½“æˆ‘ä»¬ä» <code>&lt;AddPostForm&gt;</code> æ·»åŠ ä¸€ä¸ªæ–°å¸–å­æ—¶ï¼Œè¯¥å¸–å­åªä¼šè¢«æ·»åŠ åˆ°æˆ‘ä»¬åº”ç”¨ç¨‹åºå†…çš„ Redux store ä¸­ã€‚æˆ‘ä»¬éœ€è¦å®é™…è¿›è¡Œ API è°ƒç”¨ï¼Œä»¥åœ¨æˆ‘ä»¬çš„å‡ API æœåŠ¡å™¨ä¸­åˆ›å»ºæ–°çš„å¸–å­æ¡ç›®ï¼Œä»¥ä¾¿â€œä¿å­˜â€å®ƒã€‚ï¼ˆå› ä¸ºè¿™æ˜¯ä¸€ä¸ªè™šå‡çš„ APIï¼Œå¦‚æœæˆ‘ä»¬é‡æ–°åŠ è½½é¡µé¢ï¼Œæ–°å¸–å­å°†ä¸ä¼šæŒä¹…ï¼Œä½†å¦‚æœæˆ‘ä»¬æœ‰ä¸€ä¸ªçœŸæ­£çš„åç«¯æœåŠ¡å™¨ï¼Œä¸‹æ¬¡æˆ‘ä»¬é‡æ–°åŠ è½½æ—¶å®ƒå°†å¯ç”¨ã€‚ï¼‰</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="ä½¿ç”¨-thunk-å‘é€æ•°æ®"></a>ä½¿ç”¨ Thunk å‘é€æ•°æ®<a class="hash-link" href="#ä½¿ç”¨-thunk-å‘é€æ•°æ®" title="Direct link to heading">#</a></h3><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>createAsyncThunk</code> æ¥å¸®åŠ©å‘é€æ•°æ®ï¼Œè€Œä¸ä»…ä»…æ˜¯è·å–æ•°æ®ã€‚æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ª thunkï¼Œå®ƒæ¥å—æ¥è‡ªæˆ‘ä»¬çš„ <code>&lt;AddPostForm&gt;</code> çš„å€¼ä½œä¸ºå‚æ•°ï¼Œå¹¶å¯¹å‡ API è¿›è¡Œ HTTP POST è°ƒç”¨ä»¥ä¿å­˜æ•°æ®ã€‚</p><p>åœ¨æ­¤è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†æ”¹å˜åœ¨ reducer ä¸­ä½¿ç”¨æ–° post å¯¹è±¡çš„æ–¹å¼ã€‚ç›®å‰ï¼Œæˆ‘ä»¬çš„ <code>postsSlice</code> æ­£åœ¨ä¸º <code>postAdded</code> çš„ <code>prepare</code> å›è°ƒä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„å¸–å­å¯¹è±¡ï¼Œå¹¶ä¸ºè¯¥å¸–å­ç”Ÿæˆä¸€ä¸ªæ–°çš„å”¯ä¸€ IDã€‚åœ¨å¤§å¤šæ•°å°†æ•°æ®ä¿å­˜åˆ°æœåŠ¡å™¨çš„åº”ç”¨ç¨‹åºä¸­ï¼ŒæœåŠ¡å™¨ä¼šè´Ÿè´£ç”Ÿæˆå”¯ä¸€ ID å¹¶å¡«å†™ä»»ä½•é¢å¤–çš„å­—æ®µï¼Œå¹¶ä¸”é€šå¸¸ä¼šåœ¨å…¶å“åº”ä¸­è¿”å›å®Œæˆçš„æ•°æ®ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å‘æœåŠ¡å™¨å‘é€ä¸€ä¸ªç±»ä¼¼ <code>{ title, content, user: userId }</code> çš„è¯·æ±‚ä½“ï¼Œç„¶åå°†å®ƒå‘å›çš„å®Œæ•´ post å¯¹è±¡æ·»åŠ åˆ°æˆ‘ä»¬çš„ <code>postsSlice</code> çŠ¶æ€ä¸­ã€‚</p><div class="codeBlockContainer_K1bP"><div style="color:#f8f8f2;background-color:#272822" class="codeBlockTitle_eoMF">features/posts/postsSlice.js</div><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar codeBlockWithTitle_2JqI"><div class="codeBlockLines_39YC" style="color:#f8f8f2;background-color:#272822"><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> addNewPost </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">createAsyncThunk</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token string" style="color:#a6e22e">&#x27;posts/addNewPost&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token comment" style="color:#c6cad2">// The payload creator receives the partial `{title, content, user}` object</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">async</span><span class="token plain"> </span><span class="token parameter">initialPost</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token comment" style="color:#c6cad2">// We send the initial data to the fake API server</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> response </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#F92672">await</span><span class="token plain"> client</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">post</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;/fakeApi/posts&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> post</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> initialPost </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token comment" style="color:#c6cad2">// The response includes the complete post object, including unique ID</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#F92672">return</span><span class="token plain"> response</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">post</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> postsSlice </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">createSlice</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  name</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;posts&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  initialState</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  reducers</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token comment" style="color:#c6cad2">// The existing `postAdded` reducer and prepare callback were deleted</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token function" style="color:#E6D874">reactionAdded</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> </span><span class="token comment" style="color:#c6cad2">// omit logic</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token function" style="color:#E6D874">postUpdated</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token comment" style="color:#c6cad2">// omit logic</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  extraReducers</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token comment" style="color:#c6cad2">// omit posts loading reducers</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">[</span><span class="token plain">addNewPost</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">fulfilled</span><span class="token punctuation" style="color:#F8F8F2">]</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token comment" style="color:#c6cad2">// We can directly add the new post object to our posts array</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">      state</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">posts</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">push</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">action</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">payload</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="æ£€æŸ¥ç»„ä»¶ä¸­çš„-thunk-ç»“æœ"></a>æ£€æŸ¥ç»„ä»¶ä¸­çš„ Thunk ç»“æœ<a class="hash-link" href="#æ£€æŸ¥ç»„ä»¶ä¸­çš„-thunk-ç»“æœ" title="Direct link to heading">#</a></h3><p>æœ€åï¼Œæˆ‘ä»¬å°†æ›´æ–° <code>&lt;AddPostForm&gt;</code> ä»¥ dispatch <code>addNewPost</code> thunk è€Œä¸æ˜¯æ—§çš„ <code>postAdded</code> actionã€‚ç”±äºè¿™æ˜¯å¯¹æœåŠ¡å™¨çš„å¦ä¸€ä¸ª API è°ƒç”¨ï¼Œå› æ­¤éœ€è¦ä¸€äº›æ—¶é—´å¹¶ä¸” <em>å¯èƒ½</em> å¤±è´¥ã€‚<code>addNewPost()</code> thunk ä¼šè‡ªåŠ¨å°†å®ƒçš„ <code>pending/fulfilled/rejected</code>  action dispatch åˆ° store ä¸­ã€‚å¦‚æœæˆ‘ä»¬æ„¿æ„ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç¬¬äºŒä¸ªåŠ è½½æšä¸¾æ¥è·Ÿè¸ª <code>postsSlice</code> ä¸­çš„è¯·æ±‚çŠ¶æ€ï¼Œä½†æ˜¯å¯¹äºè¿™ä¸ªä¾‹å­ï¼Œè®©æˆ‘ä»¬å°†åŠ è½½çŠ¶æ€è·Ÿè¸ªé™åˆ¶åœ¨ç»„ä»¶ä¸Šã€‚</p><p>åœ¨ç­‰å¾…è¯·æ±‚æ—¶å¯ä»¥ç¦ç”¨â€œä¿å­˜å¸–å­â€æŒ‰é’®ï¼Œé‚£ä¹ˆç”¨æˆ·å°±ä¸ä¼šæ„å¤–åœ°å°è¯•ä¿å­˜å¸–å­ä¸¤æ¬¡ï¼Œè¿™æ ·äº¤äº’ä¼šæ›´å‹å¥½ã€‚å¦‚æœè¯·æ±‚å¤±è´¥ï¼Œæˆ‘ä»¬å¯èƒ½è¿˜æƒ³åœ¨è¡¨å•ä¸­æ˜¾ç¤ºé”™è¯¯æ¶ˆæ¯ï¼Œæˆ–è€…åªæ˜¯å°†å…¶è®°å½•åˆ°æ§åˆ¶å°ã€‚</p><p>å¯ä»¥è®©æˆ‘ä»¬çš„ç»„ä»¶é€»è¾‘ç­‰å¾…å¼‚æ­¥ thunk å®Œæˆï¼Œå¹¶åœ¨å®Œæˆåæ£€æŸ¥ç»“æœï¼š</p><div class="codeBlockContainer_K1bP"><div style="color:#f8f8f2;background-color:#272822" class="codeBlockTitle_eoMF">features/posts/AddPostForm.js</div><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar codeBlockWithTitle_2JqI"><div class="codeBlockLines_39YC" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token imports maybe-class-name">React</span><span class="token imports punctuation" style="color:#F8F8F2">,</span><span class="token imports"> </span><span class="token imports punctuation" style="color:#F8F8F2">{</span><span class="token imports"> useState </span><span class="token imports punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;react&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#F8F8F2">{</span><span class="token imports"> useDispatch</span><span class="token imports punctuation" style="color:#F8F8F2">,</span><span class="token imports"> useSelector </span><span class="token imports punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;react-redux&#x27;</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#F8F8F2">{</span><span class="token imports"> unwrapResult </span><span class="token imports punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;@reduxjs/toolkit&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#F8F8F2">{</span><span class="token imports"> addNewPost </span><span class="token imports punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;./postsSlice&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function maybe-class-name" style="color:#E6D874">AddPostForm</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">[</span><span class="token plain">title</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> setTitle</span><span class="token punctuation" style="color:#F8F8F2">]</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">useState</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;&#x27;</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">[</span><span class="token plain">content</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> setContent</span><span class="token punctuation" style="color:#F8F8F2">]</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">useState</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;&#x27;</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">[</span><span class="token plain">userId</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> setUserId</span><span class="token punctuation" style="color:#F8F8F2">]</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">useState</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;&#x27;</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">[</span><span class="token plain">addRequestStatus</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> setAddRequestStatus</span><span class="token punctuation" style="color:#F8F8F2">]</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">useState</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;idle&#x27;</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token comment" style="color:#c6cad2">// omit useSelectors and change handlers</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> canSave </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">[</span><span class="token plain">title</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> content</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> userId</span><span class="token punctuation" style="color:#F8F8F2">]</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">every</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token known-class-name class-name">Boolean</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">&amp;&amp;</span><span class="token plain"> addRequestStatus </span><span class="token operator" style="color:#F8F8F2">===</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;idle&#x27;</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#E6D874">onSavePostClicked</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">async</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#F92672">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">canSave</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#F92672">try</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token function" style="color:#E6D874">setAddRequestStatus</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;pending&#x27;</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> resultAction </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#F92672">await</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">dispatch</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">          </span><span class="token function" style="color:#E6D874">addNewPost</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> title</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> content</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> user</span><span class="token operator" style="color:#F8F8F2">:</span><span class="token plain"> userId </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token function" style="color:#E6D874">unwrapResult</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">resultAction</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token function" style="color:#E6D874">setTitle</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;&#x27;</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token function" style="color:#E6D874">setContent</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;&#x27;</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token function" style="color:#E6D874">setUserId</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;&#x27;</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#F92672">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">error</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;Failed to save the post: &#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> err</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#F92672">finally</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token function" style="color:#E6D874">setAddRequestStatus</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;idle&#x27;</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token comment" style="color:#c6cad2">// omit rendering logic</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>å¯ä»¥ä½¿ç”¨ <code>useState</code> æ·»åŠ ä¸€ä¸ªè¡¨ç¤ºåŠ è½½çŠ¶æ€çš„æšä¸¾çŠ¶æ€ï¼Œç±»ä¼¼äºæˆ‘ä»¬åœ¨ <code>postsSlice</code> ä¸­è·Ÿè¸ªåŠ è½½çŠ¶æ€ä»¥è·å–å¸–å­çš„æ–¹å¼ã€‚è¿™æ ·çš„è¯ï¼Œå°±èƒ½çŸ¥é“è¯·æ±‚æ˜¯å¦åœ¨è¿›è¡Œä¸­ã€‚</p><p>å½“æˆ‘ä»¬è°ƒç”¨ <code>dispatch(addNewPost())</code> æ—¶ï¼Œå¼‚æ­¥ thunk ä» <code>dispatch</code> è¿”å›ä¸€ä¸ª <code>Promise</code>ã€‚æˆ‘ä»¬å¯ä»¥åœ¨è¿™é‡Œ <code>await</code> é‚£ä¸ª promise çŸ¥é“ thunk ä»€ä¹ˆæ—¶å€™å®Œæˆå®ƒçš„è¯·æ±‚ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬è¿˜ä¸çŸ¥é“è¯¥è¯·æ±‚æ˜¯æˆåŠŸè¿˜æ˜¯å¤±è´¥ã€‚</p><p><code>createAsyncThunk</code> åœ¨å†…éƒ¨å¤„ç†äº†æ‰€æœ‰é”™è¯¯ï¼Œå› æ­¤æˆ‘ä»¬åœ¨æ—¥å¿—ä¸­çœ‹ä¸åˆ°ä»»ä½•å…³äºâ€œrejected Promisesâ€çš„æ¶ˆæ¯ã€‚ç„¶åå®ƒè¿”å›å®ƒ dispatch çš„æœ€ç»ˆ actionï¼šå¦‚æœæˆåŠŸåˆ™è¿”å›â€œå·²å®Œæˆâ€ actionï¼Œå¦‚æœå¤±è´¥åˆ™è¿”å›â€œæ‹’ç»â€ actionã€‚Redux Toolkit æœ‰ä¸€ä¸ªåä¸º <code>unwrapResult</code> çš„å·¥å…·å‡½æ•°ï¼Œå®ƒå°†è¿”å›æ¥è‡ª <code>fulfilled</code> action çš„ <code>action.payload</code> æ•°æ®ï¼Œæˆ–è€…å¦‚æœå®ƒæ˜¯ <code>rejected</code>  action åˆ™æŠ›å‡ºé”™è¯¯ã€‚è¿™è®©æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ­£å¸¸çš„ <code>try/catch</code> é€»è¾‘å¤„ç†ç»„ä»¶ä¸­çš„æˆåŠŸå’Œå¤±è´¥ã€‚å› æ­¤ï¼Œå¦‚æœå¸–å­æˆåŠŸåˆ›å»ºï¼Œæˆ‘ä»¬å°†æ¸…é™¤è¾“å…¥å­—æ®µä»¥é‡ç½®è¡¨å•ï¼Œå¦‚æœå¤±è´¥ï¼Œåˆ™å°†é”™è¯¯è®°å½•åˆ°æ§åˆ¶å°ã€‚</p><p>å¦‚æœæ‚¨æƒ³æŸ¥çœ‹ <code>addNewPost</code> API è°ƒç”¨å¤±è´¥æ—¶å¦‚ä½•å¤„ç†ï¼Œè¯·å°è¯•åˆ›å»ºä¸€ä¸ªæ–°å¸–å­ï¼Œå…¶ä¸­â€œå†…å®¹â€å­—æ®µåªæœ‰â€œerrorâ€ä¸€è¯ï¼ˆä¸å«å¼•å·ï¼‰ã€‚æœåŠ¡å™¨å°†çœ‹åˆ°å¹¶å‘é€å›å¤±è´¥çš„å“åº”ï¼Œè¿™æ ·ä½ åº”è¯¥ä¼šçœ‹åˆ°æ§åˆ¶å°è®°å½•ä¸€æ¡æ—¥å¿—ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="ä½ å­¦åˆ°äº†"></a>ä½ å­¦åˆ°äº†<a class="hash-link" href="#ä½ å­¦åˆ°äº†" title="Direct link to heading">#</a></h2><p>å¼‚æ­¥é€»è¾‘å’Œæ•°æ®è·å–å§‹ç»ˆæ˜¯ä¸€ä¸ªå¤æ‚çš„è¯é¢˜ã€‚å¦‚æ‚¨æ‰€è§ï¼ŒRedux Toolkit åŒ…å«ä¸€äº›å·¥å…·æ¥è‡ªåŠ¨åŒ–å…¸å‹çš„ Redux æ•°æ®è·å–æ¨¡å¼ã€‚</p><p>è¿™æ˜¯æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºç°åœ¨ä»é‚£ä¸ªå‡ API è·å–æ•°æ®çš„æ ·å­ï¼š</p><iframe class="codesandbox" src="https://codesandbox.io/embed/github/reduxjs/redux-essentials-example-app/tree/checkpoint-3-postRequests/?fontsize=14&amp;hidenavigation=1&amp;theme=dark&amp;runonclick=1" title="redux-essentials-example-app" allow="geolocation; microphone; camera; midi; vr; accelerometer; gyroscope; payment; ambient-light-sensor; encrypted-media; usb" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin"></iframe><p>æé†’ä¸€ä¸‹ï¼Œè¿™æ˜¯æˆ‘ä»¬åœ¨æœ¬èŠ‚ä¸­ä»‹ç»çš„å†…å®¹ï¼š</p><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>æ€»ç»“</h5></div><div class="admonition-content"><ul><li><strong>å¯ä»¥ç¼–å†™å¯å¤ç”¨çš„â€œselector é€‰æ‹©å™¨â€å‡½æ•°æ¥å°è£…ä» Redux çŠ¶æ€ä¸­è¯»å–æ•°æ®çš„é€»è¾‘</strong><ul><li>é€‰æ‹©å™¨æ˜¯ä¸€ç§å‡½æ•°ï¼Œå®ƒæ¥æ”¶ Redux <code>state</code> ä½œä¸ºå‚æ•°ï¼Œå¹¶è¿”å›ä¸€äº›æ•°æ®</li></ul></li><li><strong>Redux ä½¿ç”¨å«åšâ€œä¸­é—´ä»¶â€è¿™æ ·çš„æ’ä»¶æ¨¡å¼æ¥å¼€å‘å¼‚æ­¥é€»è¾‘</strong><ul><li>å®˜æ–¹çš„å¤„ç†å¼‚æ­¥ä¸­é—´ä»¶å« <code>redux-thunk</code>ï¼ŒåŒ…å«åœ¨ Redux Toolkit ä¸­</li><li>Thunk å‡½æ•°æ¥æ”¶ <code>dispatch</code> å’Œ<code>getState</code> ä½œä¸ºå‚æ•°ï¼Œå¹¶ä¸”å¯ä»¥åœ¨å¼‚æ­¥é€»è¾‘ä¸­ä½¿ç”¨å®ƒä»¬</li></ul></li><li><strong>æ‚¨å¯ä»¥ dispatch å…¶ä»– action æ¥å¸®åŠ©è·Ÿè¸ª API è°ƒç”¨çš„åŠ è½½çŠ¶æ€</strong><ul><li>å…¸å‹çš„æ¨¡å¼æ˜¯åœ¨è°ƒç”¨ä¹‹å‰ dispatch ä¸€ä¸ª &quot;pending&quot; çš„ actionï¼Œç„¶åæ˜¯åŒ…å«æ•°æ®çš„ â€œsucdessâ€ æˆ–åŒ…å«é”™è¯¯çš„ â€œfailureâ€ action </li><li>åŠ è½½çŠ¶æ€é€šå¸¸åº”è¯¥ä½¿ç”¨æšä¸¾ç±»å‹ï¼Œå¦‚ <code>&#x27;idle&#x27; | &#x27;loading&#x27; | &#x27;succeeded&#x27; | &#x27;failed&#x27;</code></li></ul></li><li><strong>Redux Toolkit æœ‰ä¸€ä¸ª <code>createAsyncThunk</code> API å¯ä»¥ä¸ºä½  dispatch è¿™äº› action </strong><ul><li><code>createAsyncThunk</code> æ¥å—ä¸€ä¸ª â€œpayload creatorâ€ å›è°ƒå‡½æ•°ï¼Œå®ƒåº”è¯¥è¿”å›ä¸€ä¸ª <code>Promise</code>ï¼Œå¹¶è‡ªåŠ¨ç”Ÿæˆ <code>pending/fulfilled/rejected</code> action ç±»å‹</li><li>åƒ <code>fetchPosts</code> è¿™æ ·ç”Ÿæˆçš„ action creator æ ¹æ®ä½ è¿”å›çš„ <code>Promise</code> dispatch è¿™äº› action </li><li>å¯ä»¥ä½¿ç”¨ <code>extraReducers</code> å­—æ®µåœ¨ <code>createSlice</code> ä¸­ç›‘å¬è¿™äº› actionï¼Œå¹¶æ ¹æ®è¿™äº› action æ›´æ–° reducer ä¸­çš„çŠ¶æ€ã€‚</li><li>action creator å¯ç”¨äºè‡ªåŠ¨å¡«å…… <code>extraReducers</code> å¯¹è±¡çš„é”®ï¼Œä»¥ä¾¿åˆ‡ç‰‡çŸ¥é“è¦ç›‘å¬çš„ actionã€‚</li></ul></li></ul></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="ä¸‹ä¸€æ­¥"></a>ä¸‹ä¸€æ­¥<a class="hash-link" href="#ä¸‹ä¸€æ­¥" title="Direct link to heading">#</a></h2><p>æˆ‘ä»¬è¿˜æœ‰ä¸€ç»„ä¸»é¢˜è¦æ¶µç›–åœ¨æœ¬æ•™ç¨‹ä¸­ã€‚åœ¨ <a href="/tutorials/essentials/part-6-performance-normalization">ç¬¬å…­èŠ‚ï¼šæ€§èƒ½å’Œè§„èŒƒåŒ–æ•°æ®</a> ä¸­ï¼Œæˆ‘ä»¬å°†äº†è§£ Redux çš„ä½¿ç”¨å¦‚ä½•å½±å“ React æ€§èƒ½ï¼Œä»¥åŠæˆ‘ä»¬ä¼˜åŒ–åº”ç”¨ä»¥æé«˜æ€§èƒ½çš„ä¸€äº›æ–¹æ³•ã€‚</p></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/tutorials/essentials/part-4-using-data"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« ç¬¬å››èŠ‚ï¼šä½¿ç”¨æ•°æ®</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/tutorials/essentials/part-6-performance-normalization"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">ç¬¬å…­èŠ‚ï¼šæ€§èƒ½ä¸æ•°æ®èŒƒå¼åŒ– Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#ç®€ä»‹" class="table-of-contents__link">ç®€ä»‹</a><ul><li><a href="#rest-api-å’Œå®¢æˆ·ç«¯ç¤ºä¾‹" class="table-of-contents__link">REST API å’Œå®¢æˆ·ç«¯ç¤ºä¾‹</a></li></ul></li><li><a href="#thunks-ä¸å¼‚æ­¥é€»è¾‘" class="table-of-contents__link">Thunks ä¸å¼‚æ­¥é€»è¾‘</a><ul><li><a href="#ä½¿ç”¨-middleware-ä¸­é—´ä»¶å¤„ç†å¼‚æ­¥é€»è¾‘" class="table-of-contents__link">ä½¿ç”¨ Middleware ä¸­é—´ä»¶å¤„ç†å¼‚æ­¥é€»è¾‘</a></li><li><a href="#thunk-å‡½æ•°" class="table-of-contents__link">Thunk å‡½æ•°</a></li><li><a href="#ç¼–å†™å¼‚æ­¥-thunks" class="table-of-contents__link">ç¼–å†™å¼‚æ­¥ Thunks</a></li></ul></li><li><a href="#åŠ è½½å¸–å­" class="table-of-contents__link">åŠ è½½å¸–å­</a><ul><li><a href="#æå–å¸–å­é€‰æ‹©å™¨" class="table-of-contents__link">æå–å¸–å­é€‰æ‹©å™¨</a></li><li><a href="#è¯·æ±‚è¿‡ç¨‹ä¸­çš„åŠ è½½çŠ¶æ€" class="table-of-contents__link">è¯·æ±‚è¿‡ç¨‹ä¸­çš„åŠ è½½çŠ¶æ€</a></li><li><a href="#ä½¿ç”¨-createasyncthunk-è¯·æ±‚æ•°æ®" class="table-of-contents__link">ä½¿ç”¨ <code>createAsyncThunk</code> è¯·æ±‚æ•°æ®</a></li><li><a href="#reducer-ä¸-loading-action" class="table-of-contents__link">Reducer ä¸ Loading Action</a></li><li><a href="#æ˜¾ç¤ºåŠ è½½çŠ¶æ€" class="table-of-contents__link">æ˜¾ç¤ºåŠ è½½çŠ¶æ€</a></li></ul></li><li><a href="#åŠ è½½ç”¨æˆ·æ•°æ®" class="table-of-contents__link">åŠ è½½ç”¨æˆ·æ•°æ®</a></li><li><a href="#æ·»åŠ æ–°å¸–å­" class="table-of-contents__link">æ·»åŠ æ–°å¸–å­</a><ul><li><a href="#ä½¿ç”¨-thunk-å‘é€æ•°æ®" class="table-of-contents__link">ä½¿ç”¨ Thunk å‘é€æ•°æ®</a></li><li><a href="#æ£€æŸ¥ç»„ä»¶ä¸­çš„-thunk-ç»“æœ" class="table-of-contents__link">æ£€æŸ¥ç»„ä»¶ä¸­çš„ Thunk ç»“æœ</a></li></ul></li><li><a href="#ä½ å­¦åˆ°äº†" class="table-of-contents__link">ä½ å­¦åˆ°äº†</a></li><li><a href="#ä¸‹ä¸€æ­¥" class="table-of-contents__link">ä¸‹ä¸€æ­¥</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/introduction/getting-started">å…¥é—¨</a></li><li class="footer__item"><a class="footer__link-item" href="/tutorials/essentials/part-1-overview-concepts">æ•™ç¨‹</a></li><li class="footer__item"><a class="footer__link-item" href="/faq">å¸¸è§é—®é¢˜</a></li><li class="footer__item"><a class="footer__link-item" href="/api/api-reference">API æ–‡æ¡£</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">ç¤¾åŒº</h4><ul class="footer__items"><li class="footer__item"><a href="https://discord.gg/0ZcbPKXt5bZ6au5t" target="_blank" rel="noopener noreferrer" class="footer__link-item">Reactiflux Discord</a></li><li class="footer__item"><a href="http://stackoverflow.com/questions/tagged/redux" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow</a></li><li class="footer__item"><a class="footer__link-item" href="/introduction/getting-started#help-and-discussion">Feedback</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">æ›´å¤š</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/camsong/redux-in-chinese" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li><li class="footer__item">
                <a href="https://www.netlify.com">
                  <img src="https://www.netlify.com/img/global/badges/netlify-color-accent.svg" alt="Deploys by Netlify">
                </a>
              </li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://redux.js.org/" target="_blank" rel="noopener noreferrer" class="footerLogoLink_MyFc"><img src="/img/redux.svg" alt="Redux Logo" class="themedImage_1VuW themedImage--light_3UqQ footer__logo"><img src="/img/redux.svg" alt="Redux Logo" class="themedImage_1VuW themedImage--dark_hz6m footer__logo"></a></div><div class="footer__copyright">Copyright Â© 2015â€“2021 Dan Abramov and Cam Song.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.58bdc742.js"></script>
<script src="/assets/js/main.3f741185.js"></script>
</body>
</html>