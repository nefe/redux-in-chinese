(self.webpackChunk=self.webpackChunk||[]).push([[7728],{3905:function(e,t,a){"use strict";a.d(t,{Zo:function(){return d},kt:function(){return h}});var n=a(7294);function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,n,i=function(e,t){if(null==e)return{};var a,n,i={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(i[a]=e[a]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}var l=n.createContext({}),c=function(e){var t=n.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},d=function(e){var t=c(e.components);return n.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},p=n.forwardRef((function(e,t){var a=e.components,i=e.mdxType,r=e.originalType,l=e.parentName,d=s(e,["components","mdxType","originalType","parentName"]),p=c(a),h=i,m=p["".concat(l,".").concat(h)]||p[h]||u[h]||r;return a?n.createElement(m,o(o({ref:t},d),{},{components:a})):n.createElement(m,o({ref:t},d))}));function h(e,t){var a=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=a.length,o=new Array(r);o[0]=p;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:i,o[1]=s;for(var c=2;c<r;c++)o[c]=a[c];return n.createElement.apply(null,o)}return n.createElement.apply(null,a)}p.displayName="MDXCreateElement"},5778:function(e,t,a){"use strict";a.d(t,{s:function(){return i}});var n=a(7294),i=function(e){var t=e.children,a=e.title,i=void 0===a?"Detailed Explanation":a;return n.createElement("details",{className:"detailed-explanation"},n.createElement("summary",null,n.createElement("h4",null,i)),t)}},1720:function(e,t,a){"use strict";a.r(t),a.d(t,{frontMatter:function(){return s},metadata:function(){return l},toc:function(){return c},default:function(){return u}});var n=a(2122),i=a(9756),r=(a(7294),a(3905)),o=a(5778),s={id:"part-2-concepts-data-flow",title:"Redux Fundamentals, Part 2: Concepts and Data Flow",sidebar_label:"Redux Concepts and Data Flow",hide_title:!1,description:"The official Redux Fundamentals tutorial: learn key Redux terms and how data flows in a Redux app"},l={unversionedId:"tutorials/fundamentals/part-2-concepts-data-flow",id:"tutorials/fundamentals/part-2-concepts-data-flow",isDocsHomePage:!1,title:"Redux Fundamentals, Part 2: Concepts and Data Flow",description:"The official Redux Fundamentals tutorial: learn key Redux terms and how data flows in a Redux app",source:"@site/../docs/tutorials/fundamentals/part-2-concepts-data-flow.md",sourceDirName:"tutorials/fundamentals",slug:"/tutorials/fundamentals/part-2-concepts-data-flow",permalink:"/tutorials/fundamentals/part-2-concepts-data-flow",version:"current",sidebar_label:"Redux Concepts and Data Flow",frontMatter:{id:"part-2-concepts-data-flow",title:"Redux Fundamentals, Part 2: Concepts and Data Flow",sidebar_label:"Redux Concepts and Data Flow",hide_title:!1,description:"The official Redux Fundamentals tutorial: learn key Redux terms and how data flows in a Redux app"},sidebar:"docs",previous:{title:"Redux Fundamentals, Part 1: Redux Overview",permalink:"/tutorials/fundamentals/part-1-overview"},next:{title:"Redux Fundamentals, Part 3: State, Actions, and Reducers",permalink:"/tutorials/fundamentals/part-3-state-actions-reducers"}},c=[{value:"\u7b80\u4ecb",id:"\u7b80\u4ecb",children:[]},{value:"Background Concepts",id:"background-concepts",children:[{value:"State Management",id:"state-management",children:[]},{value:"Immutability",id:"immutability",children:[]}]},{value:"Redux Terminology",id:"redux-terminology",children:[{value:"Actions",id:"actions",children:[]},{value:"Reducers",id:"reducers",children:[]},{value:"Store",id:"store",children:[]},{value:"Dispatch",id:"dispatch",children:[]},{value:"Selectors",id:"selectors",children:[]}]},{value:"Core Concepts and Principles",id:"core-concepts-and-principles",children:[{value:"Single Source of Truth",id:"single-source-of-truth",children:[]},{value:"State is Read-Only",id:"state-is-read-only",children:[]},{value:"Changes are Made with Pure Reducer Functions",id:"changes-are-made-with-pure-reducer-functions",children:[]}]},{value:"Redux Application Data Flow",id:"redux-application-data-flow",children:[]},{value:"\u4f60\u5b66\u5230\u4e86",id:"\u4f60\u5b66\u5230\u4e86",children:[]},{value:"\u4e0b\u4e00\u6b65",id:"\u4e0b\u4e00\u6b65",children:[]}],d={toc:c};function u(e){var t=e.components,s=(0,i.Z)(e,["components"]);return(0,r.kt)("wrapper",(0,n.Z)({},d,s,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"\u4f60\u5c06\u5b66\u5230")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("ul",{parentName:"div"},(0,r.kt)("li",{parentName:"ul"},"Key terms and concepts for using Redux"),(0,r.kt)("li",{parentName:"ul"},"How data flows through a Redux app")))),(0,r.kt)("h2",{id:"\u7b80\u4ecb"},"\u7b80\u4ecb"),(0,r.kt)("p",null,"In ",(0,r.kt)("a",{parentName:"p",href:"/tutorials/fundamentals/part-1-overview"},"Part 1: Redux Overview"),", we talked about what Redux is, why you might want to use it, and listed the other Redux libraries that are typically used with the Redux core. We also saw a small example of what a working Redux app looks like and the pieces that make up the app. Finally, we briefly mentioned some of the terms and concepts used with Redux."),(0,r.kt)("p",null,"In this section, we'll look at those terms and concepts in more detail, and talk more about how data flows\nthrough a Redux application."),(0,r.kt)("h2",{id:"background-concepts"},"Background Concepts"),(0,r.kt)("p",null,"Before we dive into some actual code, let's talk about some of the terms and concepts you'll need to know to use Redux."),(0,r.kt)("h3",{id:"state-management"},"State Management"),(0,r.kt)("p",null,"Let's start by looking at a small React counter component. It tracks a number in component state, and increments the number when a button is clicked:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},"function Counter() {\n  // State: a counter value\n  const [counter, setCounter] = useState(0)\n\n  // Action: code that causes an update to the state when something happens\n  const increment = () => {\n    setCounter(prevCounter => prevCounter + 1)\n  }\n\n  // View: the UI definition\n  return (\n    <div>\n      Value: {counter} <button onClick={increment}>Increment</button>\n    </div>\n  )\n}\n")),(0,r.kt)("p",null,"It is a self-contained app with the following parts:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"The ",(0,r.kt)("strong",{parentName:"li"},"state"),", the source of truth that drives our app;"),(0,r.kt)("li",{parentName:"ul"},"The ",(0,r.kt)("strong",{parentName:"li"},"view"),", a declarative description of the UI based on the current state"),(0,r.kt)("li",{parentName:"ul"},"The ",(0,r.kt)("strong",{parentName:"li"},"actions"),", the events that occur in the app based on user input, and trigger updates in the state")),(0,r.kt)("p",null,"This is a small example of ",(0,r.kt)("strong",{parentName:"p"},'"one-way data flow"'),":"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"State describes the condition of the app at a specific point in time"),(0,r.kt)("li",{parentName:"ul"},"The UI is rendered based on that state"),(0,r.kt)("li",{parentName:"ul"},"When something happens (such as a user clicking a button), the state is updated based on what occurred"),(0,r.kt)("li",{parentName:"ul"},"The UI re-renders based on the new state")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"One-way data flow",src:a(639).Z})),(0,r.kt)("p",null,"However, the simplicity can break down when we have ",(0,r.kt)("strong",{parentName:"p"},"multiple components that need to share and use the same state"),", especially if those components are located in different parts of the application. Sometimes this can be solved by ",(0,r.kt)("a",{parentName:"p",href:"https://reactjs.org/docs/lifting-state-up.html"},'"lifting state up"')," to parent components, but that doesn't always help."),(0,r.kt)("p",null,'One way to solve this is to extract the shared state from the components, and put it into a centralized location outside the component tree. With this, our component tree becomes a big "view", and any component can access the state or trigger actions, no matter where they are in the tree!'),(0,r.kt)("p",null,"By defining and separating the concepts involved in state management and enforcing rules that maintain independence between views and states, we give our code more structure and maintainability."),(0,r.kt)("p",null,"This is the basic idea behind Redux: a single centralized place to contain the global state in your application, and specific patterns to follow when updating that state to make the code predictable."),(0,r.kt)("h3",{id:"immutability"},"Immutability"),(0,r.kt)("p",null,'"Mutable" means "changeable". If something is "immutable", it can never be changed.'),(0,r.kt)("p",null,"JavaScript objects and arrays are all mutable by default. If I create an object, I can change the contents of its fields. If I create an array, I can change the contents as well:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const obj = { a: 1, b: 2 }\n// still the same object outside, but the contents have changed\nobj.b = 3\n\nconst arr = ['a', 'b']\n// In the same way, we can change the contents of this array\narr.push('c')\narr[1] = 'd'\n")),(0,r.kt)("p",null,"This is called ",(0,r.kt)("em",{parentName:"p"},"mutating")," the object or array. It's the same object or array reference in memory, but now the contents inside the object have changed."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"In order to update values immutably, your code must make ",(0,r.kt)("em",{parentName:"strong"},"copies")," of existing objects/arrays, and then modify the copies"),"."),(0,r.kt)("p",null,"We can do this by hand using JavaScript's array / object spread operators, as well as array methods that return new copies of the array instead of mutating the original array:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const obj = {\n  a: {\n    // To safely update obj.a.c, we have to copy each piece\n    c: 3\n  },\n  b: 2\n}\n\nconst obj2 = {\n  // copy obj\n  ...obj,\n  // overwrite a\n  a: {\n    // copy obj.a\n    ...obj.a,\n    // overwrite c\n    c: 42\n  }\n}\n\nconst arr = ['a', 'b']\n// Create a new copy of arr, with \"c\" appended to the end\nconst arr2 = arr.concat('c')\n\n// or, we can make a copy of the original array:\nconst arr3 = arr.slice()\n// and mutate the copy:\narr3.push('c')\n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Redux expects that all state updates are done immutably"),". We'll look at where and how this is important a bit later, as well as some easier ways to write immutable update logic."),(0,r.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"\u60f3\u4e86\u89e3\u66f4\u591a\uff1f")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"For more info on how immutability works in JavaScript, see:"),(0,r.kt)("ul",{parentName:"div"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://daveceddia.com/javascript-references/"},"A Visual Guide to References in JavaScript")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://daveceddia.com/react-redux-immutability-guide/"},"Immutability in React and Redux: The Complete Guide"))))),(0,r.kt)("h2",{id:"redux-terminology"},"Redux Terminology"),(0,r.kt)("p",null,"There's some important Redux terms that you'll need to be familiar with before we continue:"),(0,r.kt)("h3",{id:"actions"},"Actions"),(0,r.kt)("p",null,"An ",(0,r.kt)("strong",{parentName:"p"},"action")," is a plain JavaScript object that has a ",(0,r.kt)("inlineCode",{parentName:"p"},"type")," field. ",(0,r.kt)("strong",{parentName:"p"},"You can think of an action as an event that describes something that happened in the application"),"."),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"type")," field should be a string that gives this action a descriptive name, like ",(0,r.kt)("inlineCode",{parentName:"p"},'"todos/todoAdded"'),". We usually write that type string like ",(0,r.kt)("inlineCode",{parentName:"p"},'"domain/eventName"'),", where the first part is the feature or category that this action belongs to, and the second part is the specific thing that happened."),(0,r.kt)("p",null,"An action object can have other fields with additional information about what happened. By convention, we put that information in a field called ",(0,r.kt)("inlineCode",{parentName:"p"},"payload"),"."),(0,r.kt)("p",null,"A typical action object might look like this:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const addTodoAction = {\n  type: 'todos/todoAdded',\n  payload: 'Buy milk'\n}\n")),(0,r.kt)("h3",{id:"reducers"},"Reducers"),(0,r.kt)("p",null,"A ",(0,r.kt)("strong",{parentName:"p"},"reducer")," is a function that receives the current ",(0,r.kt)("inlineCode",{parentName:"p"},"state")," and an ",(0,r.kt)("inlineCode",{parentName:"p"},"action")," object, decides how to update the state if necessary, and returns the new state: ",(0,r.kt)("inlineCode",{parentName:"p"},"(state, action) => newState"),". ",(0,r.kt)("strong",{parentName:"p"},"You can think of a reducer as an event listener which handles events based on the received action (event) type.")),(0,r.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},'"Reducer" functions get their name because they\'re similar to the kind of callback function you pass to the ',(0,r.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/reduce"},(0,r.kt)("inlineCode",{parentName:"a"},"Array.reduce()"))," method."))),(0,r.kt)("p",null,"Reducers must ",(0,r.kt)("em",{parentName:"p"},"always")," follow some specific rules:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"They should only calculate the new state value based on the ",(0,r.kt)("inlineCode",{parentName:"li"},"state")," and ",(0,r.kt)("inlineCode",{parentName:"li"},"action")," arguments"),(0,r.kt)("li",{parentName:"ul"},"They are not allowed to modify the existing ",(0,r.kt)("inlineCode",{parentName:"li"},"state"),". Instead, they must make ",(0,r.kt)("em",{parentName:"li"},"immutable updates"),", by copying the existing ",(0,r.kt)("inlineCode",{parentName:"li"},"state")," and making changes to the copied values."),(0,r.kt)("li",{parentName:"ul"},'They must not do any asynchronous logic, calculate random values, or cause other "side effects"')),(0,r.kt)("p",null,"We'll talk more about the rules of reducers later, including why they're important and how to follow them correctly."),(0,r.kt)("p",null,"The logic inside reducer functions typically follows the same series of steps:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Check to see if the reducer cares about this action",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"If so, make a copy of the state, update the copy with new values, and return it"))),(0,r.kt)("li",{parentName:"ul"},"Otherwise, return the existing state unchanged")),(0,r.kt)("p",null,"Here's a small example of a reducer, showing the steps that each reducer should follow:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const initialState = { value: 0 }\n\nfunction counterReducer(state = initialState, action) {\n  // Check to see if the reducer cares about this action\n  if (action.type === 'counter/incremented') {\n    // If so, make a copy of `state`\n    return {\n      ...state,\n      // and update the copy with the new value\n      value: state.value + 1\n    }\n  }\n  // otherwise return the existing state unchanged\n  return state\n}\n")),(0,r.kt)("p",null,"Reducers can use any kind of logic inside to decide what the new state should be: ",(0,r.kt)("inlineCode",{parentName:"p"},"if/else"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"switch"),", loops, and so on."),(0,r.kt)(o.s,{title:"Detailed Explanation: Why Are They Called 'Reducers?'",mdxType:"DetailedExplanation"},(0,r.kt)("p",null,"The ",(0,r.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/reduce"},(0,r.kt)("inlineCode",{parentName:"a"},"Array.reduce()")),' method lets you take an array of values, process each item in the array one at a time, and return a single final result. You can think of it as "reducing the array down to one value".'),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"Array.reduce()")," takes a callback function as an argument, which will be called one time for each item in the array. It takes two arguments:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"previousResult"),", the value that your callback returned last time"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"currentItem"),", the current item in the array")),(0,r.kt)("p",null,"The first time that the callback runs, there isn't a ",(0,r.kt)("inlineCode",{parentName:"p"},"previousResult")," available, so we need to also pass in an initial value that will be used as the first ",(0,r.kt)("inlineCode",{parentName:"p"},"previousResult"),"."),(0,r.kt)("p",null,"If we wanted to add together an array of numbers to find out what the total is, we could write a reduce callback that looks like this:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const numbers = [2, 5, 8]\n\nconst addNumbers = (previousResult, currentItem) => {\n  console.log({ previousResult, currentItem })\n  return previousResult + currentItem\n}\n\nconst initialValue = 0\n\nconst total = numbers.reduce(addNumbers, initialValue)\n// {previousResult: 0, currentItem: 2}\n// {previousResult: 2, currentItem: 5}\n// {previousResult: 7, currentItem: 8}\n\nconsole.log(total)\n// 15\n")),(0,r.kt)("p",null,"Notice that this ",(0,r.kt)("inlineCode",{parentName:"p"},"addNumbers"),' "reduce callback" function doesn\'t need to keep track of anything itself. It takes the ',(0,r.kt)("inlineCode",{parentName:"p"},"previousResult")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"currentItem")," arguments, does something with them, and returns a new result value."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},'A Redux reducer function is exactly the same idea as this "reduce callback" function!'),' It takes a "previous result" (the ',(0,r.kt)("inlineCode",{parentName:"p"},"state"),'), and the "current item" (the ',(0,r.kt)("inlineCode",{parentName:"p"},"action")," object), decides a new state value based on those arguments, and returns that new state."),(0,r.kt)("p",null,"If we were to create an array of Redux actions, call ",(0,r.kt)("inlineCode",{parentName:"p"},"reduce()"),", and pass in a reducer function, we'd get a final result the same way:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const actions = [\n  { type: 'counter/incremented' },\n  { type: 'counter/incremented' },\n  { type: 'counter/incremented' }\n]\n\nconst initialState = { value: 0 }\n\nconst finalResult = actions.reduce(counterReducer, initialState)\nconsole.log(finalResult)\n// {value: 3}\n")),(0,r.kt)("p",null,"We can say that ",(0,r.kt)("strong",{parentName:"p"},"Redux reducers reduce a set of actions (over time) into a single state"),". The difference is that with ",(0,r.kt)("inlineCode",{parentName:"p"},"Array.reduce()")," it happens all at once, and with Redux, it happens over the lifetime of your running app.")),(0,r.kt)("h3",{id:"store"},"Store"),(0,r.kt)("p",null,"The current Redux application state lives in an object called the ",(0,r.kt)("strong",{parentName:"p"},"store")," ."),(0,r.kt)("p",null,"The store is created by passing in a reducer, and has a method called ",(0,r.kt)("inlineCode",{parentName:"p"},"getState")," that returns the current state value:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"import { configureStore } from '@reduxjs/toolkit'\n\nconst store = configureStore({ reducer: counterReducer })\n\nconsole.log(store.getState())\n// {value: 0}\n")),(0,r.kt)("h3",{id:"dispatch"},"Dispatch"),(0,r.kt)("p",null,"The Redux store has a method called ",(0,r.kt)("inlineCode",{parentName:"p"},"dispatch"),". ",(0,r.kt)("strong",{parentName:"p"},"The only way to update the state is to call ",(0,r.kt)("inlineCode",{parentName:"strong"},"store.dispatch()")," and pass in an action object"),". The store will run its reducer function and save the new state value inside, and we can call ",(0,r.kt)("inlineCode",{parentName:"p"},"getState()")," to retrieve the updated value:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"store.dispatch({ type: 'counter/incremented' })\n\nconsole.log(store.getState())\n// {value: 1}\n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},'You can think of dispatching actions as "triggering an event"')," in the application. Something happened, and we want the store to know about it. Reducers act like event listeners, and when they hear an action they are interested in, they update the state in response."),(0,r.kt)("h3",{id:"selectors"},"Selectors"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Selectors")," are functions that know how to extract specific pieces of information from a store state value. As an application grows bigger, this can help avoid repeating logic as different parts of the app need to read the same data:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const selectCounterValue = state => state.value\n\nconst currentValue = selectCounterValue(store.getState())\nconsole.log(currentValue)\n// 2\n")),(0,r.kt)("h2",{id:"core-concepts-and-principles"},"Core Concepts and Principles"),(0,r.kt)("p",null,"Overall, we can summarize the intent behind Redux's design in three core concepts:"),(0,r.kt)("h3",{id:"single-source-of-truth"},"Single Source of Truth"),(0,r.kt)("p",null,"The ",(0,r.kt)("strong",{parentName:"p"},"global state")," of your application is stored as an object inside a single ",(0,r.kt)("strong",{parentName:"p"},"store"),". Any given piece of data should only exist in one location, rather than being duplicated in many places."),(0,r.kt)("p",null,"This makes it easier to debug and inspect your app's state as things change, as well as centralizing logic that needs to interact with the entire application."),(0,r.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"This does ",(0,r.kt)("em",{parentName:"p"},"not")," mean that ",(0,r.kt)("em",{parentName:"p"},"every")," piece of state in your app must go into the Redux store! You should decide whether a piece of state belongs in Redux or your UI components, based on where it's needed."))),(0,r.kt)("h3",{id:"state-is-read-only"},"State is Read-Only"),(0,r.kt)("p",null,"The only way to change the state is to dispatch an ",(0,r.kt)("strong",{parentName:"p"},"action"),", an object that describes what happened."),(0,r.kt)("p",null,"This way, the UI won't accidentally overwrite data, and it's easier to trace why a state update happened. Since actions are plain JS objects, they can be logged, serialized, stored, and later replayed for debugging or testing purposes."),(0,r.kt)("h3",{id:"changes-are-made-with-pure-reducer-functions"},"Changes are Made with Pure Reducer Functions"),(0,r.kt)("p",null,"To specify how the state tree is updated based on actions, you write ",(0,r.kt)("strong",{parentName:"p"},"reducer")," functions. Reducers are pure functions that take the previous state and an action, and return the next state. Like any other functions, you can split reducers into smaller functions to help do the work, or write reusable reducers for common tasks."),(0,r.kt)("h2",{id:"redux-application-data-flow"},"Redux Application Data Flow"),(0,r.kt)("p",null,'Earlier, we talked about "one-way data flow", which describes this sequence of steps to update the app:'),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"State describes the condition of the app at a specific point in time"),(0,r.kt)("li",{parentName:"ul"},"The UI is rendered based on that state"),(0,r.kt)("li",{parentName:"ul"},"When something happens (such as a user clicking a button), the state is updated based on what occurred"),(0,r.kt)("li",{parentName:"ul"},"The UI re-renders based on the new state")),(0,r.kt)("p",null,"For Redux specifically, we can break these steps into more detail:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Initial setup:",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"A Redux store is created using a root reducer function"),(0,r.kt)("li",{parentName:"ul"},"The store calls the root reducer once, and saves the return value as its initial ",(0,r.kt)("inlineCode",{parentName:"li"},"state")),(0,r.kt)("li",{parentName:"ul"},"When the UI is first rendered, UI components access the current state of the Redux store, and use that data to decide what to render. They also subscribe to any future store updates so they can know if the state has changed."))),(0,r.kt)("li",{parentName:"ul"},"Updates:",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Something happens in the app, such as a user clicking a button"),(0,r.kt)("li",{parentName:"ul"},"The app code dispatches an action to the Redux store, like ",(0,r.kt)("inlineCode",{parentName:"li"},"dispatch({type: 'counter/incremented'})")),(0,r.kt)("li",{parentName:"ul"},"The store runs the reducer function again with the previous ",(0,r.kt)("inlineCode",{parentName:"li"},"state")," and the current ",(0,r.kt)("inlineCode",{parentName:"li"},"action"),", and saves the return value as the new ",(0,r.kt)("inlineCode",{parentName:"li"},"state")),(0,r.kt)("li",{parentName:"ul"},"The store notifies all parts of the UI that are subscribed that the store has been updated"),(0,r.kt)("li",{parentName:"ul"},"Each UI component that needs data from the store checks to see if the parts of the state they need have changed."),(0,r.kt)("li",{parentName:"ul"},"Each component that sees its data has changed forces a re-render with the new data, so it can update what's shown on the screen")))),(0,r.kt)("p",null,"Here's what that data flow looks like visually:"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Redux data flow diagram",src:a(7360).Z})),(0,r.kt)("h2",{id:"\u4f60\u5b66\u5230\u4e86"},"\u4f60\u5b66\u5230\u4e86"),(0,r.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"\u603b\u7ed3")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("ul",{parentName:"div"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Redux's intent can be summarized in three principles"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Global app state is kept in a single store"),(0,r.kt)("li",{parentName:"ul"},"The store state is read-only to the rest of the app"),(0,r.kt)("li",{parentName:"ul"},"Reducer functions are used to update the state in response to actions"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},'Redux uses a "one-way data flow" app structure'),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"State describes the condition of the app at a point in time, and UI renders based on that state"),(0,r.kt)("li",{parentName:"ul"},"When something happens in the app:",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"The UI dispatches an action"),(0,r.kt)("li",{parentName:"ul"},"The store runs the reducers, and the state is updated based on what occurred"),(0,r.kt)("li",{parentName:"ul"},"The store notifies the UI that the state has changed"))),(0,r.kt)("li",{parentName:"ul"},"The UI re-renders based on the new state")))))),(0,r.kt)("h2",{id:"\u4e0b\u4e00\u6b65"},"\u4e0b\u4e00\u6b65"),(0,r.kt)("p",null,"You should now be familiar with the key concepts and terms that describe the different parts of a Redux app."),(0,r.kt)("p",null,"Now, let's see how those pieces work together as we start building a new Redux application in ",(0,r.kt)("a",{parentName:"p",href:"./part-3-state-actions-reducers"},"Part 3: State, Actions, and Reducers"),"."))}u.isMDXComponent=!0},7360:function(e,t,a){"use strict";t.Z=a.p+"assets/images/ReduxDataFlowDiagram-49fa8c3968371d9ef6f2a1486bd40a26.gif"},639:function(e,t,a){"use strict";t.Z=a.p+"assets/images/one-way-data-flow-04fe46332c1ccb3497ecb04b94e55b97.png"}}]);